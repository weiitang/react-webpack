{"version":3,"file":"luckyexcel.esm.js","sources":["../src/common/constant.ts","../src/common/method.ts","../src/ToLuckySheet/ReadXml.ts","../src/ToLuckySheet/LuckyBase.ts","../src/ToLuckySheet/LuckyCell.ts","../src/ToLuckySheet/LuckySheet.ts","../src/common/emf.ts","../src/ToLuckySheet/LuckyImage.ts","../src/ToLuckySheet/LuckyFile.ts","../src/toExcel/Workcell.ts","../src/toExcel/BorderInfo.ts","../src/toExcel/Worksheet.ts","../src/toExcel/ExcelFile.ts","../src/HandleZip.ts","../src/toExceljs/constant.ts","../src/toExceljs/Workcell.ts","../src/toExceljs/BorderInfo.ts","../src/toExceljs/Worksheet.ts","../src/toExceljs/ExcelFile.ts","../src/main.ts"],"sourcesContent":["import {stringToNum, IattributeList, numTostring, stringToBoolean, IDataVerificationMap, IDataVerificationType2Map} from \"../ICommon\";\n\nexport const columeHeader_word:string[] = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nexport const columeHeader_word_index:stringToNum = { 'A': 0, 'B': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'H': 7, 'I': 8, 'J': 9, 'K': 10, 'L': 11, 'M': 12, 'N': 13, 'O': 14, 'P': 15, 'Q': 16, 'R': 17, 'S': 18, 'T': 19, 'U': 20, 'V': 21, 'W': 22, 'X': 23, 'Y': 24, 'Z': 25 };\n\nexport const coreFile = \"docProps/core.xml\";\nexport const appFile = \"docProps/app.xml\";\nexport const contentTypesFile = \"[Content_Types].xml\";\nexport const workBookFile = \"xl/workbook.xml\";\nexport const calcChainFile = \"xl/calcChain.xml\";\nexport const stylesFile = \"xl/styles.xml\";\nexport const sharedStringsFile = \"xl/sharedStrings.xml\";\nexport const worksheetFilePath = \"xl/worksheets/\";\nexport const theme1File = \"xl/theme/theme1.xml\";\nexport const workbookRels= \"xl/_rels/workbook.xml.rels\";\n\nexport const ErrorValueMap: stringToNum = {\n    '#NULL!': 0x00,\n    '#DIV/0!': 0x07,\n    '#VALUE!': 0x0F,\n    '#REF!': 0x17,\n    '#NAME?': 0x1D,\n    '#NUM!': 0x24,\n    '#N/A':\t0x2A,\n    '#GETTING_DATA': 0x2B,\n    '#SPILL!': 0x0F,\n    '#CONNECT!': 0x0F,\n    '#BLOCKED!': 0x0F\n}\n\n\n//Excel Built-In cell type\nexport const ST_CellType:IattributeList ={\n    \"Boolean\":\"b\",\n    \"Date\":\"d\",\n    \"Error\":\"e\",\n    \"InlineString\":\"inlineStr\",\n    \"Number\":\"n\",\n    \"SharedString\":\"s\",\n    \"String\":\"str\",\n}\n\n//Excel Built-In cell style\nexport const BuiltInCellStyles:IattributeList = {\n    \"0\":\"Normal\",\n\n}\n\n\nexport let numFmtDefault:IattributeList = {\n    \"0\":'General',\n    \"1\": '0',\n    \"2\": '0.00',\n    \"3\": '#,##0',\n    \"4\": '#,##0.00',\n    \"9\":'0%',\n    \"10\": '0.00%',\n    \"11\": '0.00E+00',\n    \"12\": '# ?/?',\n    \"13\": '# ??/??',\n    \"14\": 'm/d/yy',\n    \"15\": 'd-mmm-yy',\n    \"16\": 'd-mmm',\n    \"17\": 'mmm-yy',\n    \"18\": 'h:mm AM/PM',\n    \"19\": 'h:mm:ss AM/PM',\n    \"20\": 'h:mm',\n    \"21\": 'h:mm:ss',\n    \"22\": 'm/d/yy h:mm',\n    \"37\": '#,##0 ;(#,##0)',\n    \"38\": '#,##0 ;[Red](#,##0)',\n    \"39\": '#,##0.00;(#,##0.00)',\n    \"40\": '#,##0.00;[Red](#,##0.00)',\n    \"45\": 'mm:ss',\n    \"46\": '[h]:mm:ss',\n    \"47\": 'mmss.0',\n    \"48\": '##0.0E+0',\n    \"49\": '@'\n}\n\nexport const indexedColors:IattributeList = {\n    \"0\":'00000000',\n    \"1\":'00FFFFFF',\n    \"2\":'00FF0000',\n    \"3\":'0000FF00',\n    \"4\":'000000FF',\n    \"5\":'00FFFF00',\n    \"6\":'00FF00FF',\n    \"7\":'0000FFFF',\n    \"8\":'00000000',\n    \"9\":'00FFFFFF',\n    \"10\":'00FF0000',\n    \"11\":'0000FF00',\n    \"12\":'000000FF',\n    \"13\":'00FFFF00',\n    \"14\":'00FF00FF',\n    \"15\":'0000FFFF',\n    \"16\":'00800000',\n    \"17\":'00008000',\n    \"18\":'00000080',\n    \"19\":'00808000',\n    \"20\":'00800080',\n    \"21\":'00008080',\n    \"22\":'00C0C0C0',\n    \"23\":'00808080',\n    \"24\":'009999FF',\n    \"25\":'00993366',\n    \"26\":'00FFFFCC',\n    \"27\":'00CCFFFF',\n    \"28\":'00660066',\n    \"29\":'00FF8080',\n    \"30\":'000066CC',\n    \"31\":'00CCCCFF',\n    \"32\":'00000080',\n    \"33\":'00FF00FF',\n    \"34\":'00FFFF00',\n    \"35\":'0000FFFF',\n    \"36\":'00800080',\n    \"37\":'00800000',\n    \"38\":'00008080',\n    \"39\":'000000FF',\n    \"40\":'0000CCFF',\n    \"41\":'00CCFFFF',\n    \"42\":'00CCFFCC',\n    \"43\":'00FFFF99',\n    \"44\":'0099CCFF',\n    \"45\":'00FF99CC',\n    \"46\":'00CC99FF',\n    \"47\":'00FFCC99',\n    \"48\":'003366FF',\n    \"49\":'0033CCCC',\n    \"50\":'0099CC00',\n    \"51\":'00FFCC00',\n    \"52\":'00FF9900',\n    \"53\":'00FF6600',\n    \"54\":'00666699',\n    \"55\":'00969696',\n    \"56\":'00003366',\n    \"57\":'00339966',\n    \"58\":'00003300',\n    \"59\":'00333300',\n    \"60\":'00993300',\n    \"61\":'00993366',\n    \"62\":'00333399',\n    \"63\":'00333333',\n    \"64\":null,//system Foreground n/a\n    \"65\":null,//system Background n/a\n}\n\nexport const OEM_CHARSET:IattributeList = {\n    \"0\": \"ANSI_CHARSET\",\n    \"1\": \"DEFAULT_CHARSET\",\n    \"2\": \"SYMBOL_CHARSET\",\n    \"77\": \"MAC_CHARSET\",\n    \"128\": \"SHIFTJIS_CHARSET\",\n    \"129\": \"HANGUL_CHARSET\",\n    \"130\": \"JOHAB_CHARSET\",\n    \"134\": \"GB2312_CHARSET\",\n    \"136\": \"CHINESEBIG5_CHARSET\",\n    \"161\": \"GREEK_CHARSET\",\n    \"162\": \"TURKISH_CHARSET\",\n    \"163\": \"VIETNAMESE_CHARSET\",\n    \"177\": \"HEBREW_CHARSET\",\n    \"178\": \"ARABIC_CHARSET\",\n    \"186\": \"BALTIC_CHARSET\",\n    \"204\": \"RUSSIAN_CHARSET\",\n    \"222\": \"THAI_CHARSET\",\n    \"238\": \"EASTEUROPE_CHARSET\",\n    \"255\": \"OEM_CHARSET\",\n}\n\n\nexport const borderTypes:stringToNum = {\n    \"none\":0,\n    \"thin\":1, \n    \"hair\":2, \n    \"dotted\":3, \n    \"dashed\":4, \n    \"dashDot\":5, \n    \"dashDotDot\":6, \n    \"double\":7, \n    \"medium\":8, \n    \"mediumDashed\":9, \n    \"mediumDashDot\":10, \n    \"mediumDashDotDot\":11, \n    \"slantDashDot\":12, \n    \"thick\":13\n}\n\n// 对齐文档 BORDER_STYLE https://github.com/gitbrent/xlsx-js-style#border_style-string-properties\nexport const excelBorderStyles: IattributeList = {\n    '1': 'thin',\n    '2': 'hair',\n    '3': 'dotted',\n    '4': 'dashed',\n    '5': 'dashDot',\n    '6': 'dashDotDot',\n    '8': 'medium',\n    '9': 'mediumDashed',\n    '10': 'mediumDashDot',\n    '11': 'mediumDashDotDot',\n    '12': 'slantDashDot',\n    '13': 'thick',\n}\n\nexport const excelBorderPositions: IattributeList = {\n    t: \"top\",\n    b: \"bottom\",\n    l: \"left\",\n    r: \"right\",\n}\n\nexport const verticalMap: IattributeList = {\n    '0': 'center',\n    '1': 'top',\n    '2': 'bottom',\n}\n\nexport const horizontalMap: IattributeList = {\n    '0': 'center',\n    '1': 'left',\n    '2': 'right',\n}\n\nexport const wrapTextMap: stringToBoolean = {\n    '0': false,\n    '1': false,\n    '2': true,\n}\n\nexport const textRotationMap: stringToNum = {\n    '0': 0,\n    '1': 45,\n    '2': 135,\n    '3': 255,\n    '4': 90,\n    '5': 180,\n}\n\n\nexport let numFmtDefaultMap: IattributeList = {\n    \"yyyy/m/d;@\": \"yyyy/MM/dd\",\n    \"yyyy&quot;年&quot;m&quot;月&quot;d&quot;日&quot;;@\":\n      \"yyyy&quot;年&quot;MM&quot;月&quot;dd&quot;日&quot;\",\n    \"[$-409]yyyy/m/d\\\\ h:mm\\\\ AM/PM;@\": \"yyyy/MM/dd hh:mm AM/PM\",\n};\n\nexport const fontFamilys:IattributeList = {\n    \"0\":\"defualt\",\n    \"1\":\"Roman\",\n    \"2\":\"Swiss\",\n    \"3\":\"Modern\",\n    \"4\":\"Script\",\n    \"5\":\"Decorative\"\n}\n\nexport const DATA_VERIFICATION_MAP: IDataVerificationMap = {\n    list: \"dropdown\",\n    whole: \"number_integer\",\n    decimal: \"number_decimal\",\n    custom: \"text_content\",\n    textLength: \"text_length\",\n    date: \"date\",\n    \"unknown1\": \"number\", // no match yet\n    \"unknown2\": \"checkbox\", // no match yet\n    \"unknown3\": \"validity\", // no match yet\n};\n\nexport const COMMON_TYPE2: string[] = [\n    \"number\",\n    \"number_integer\",\n    \"number_decimal\",\n    \"text_length\",\n];\n\nexport const DATA_VERIFICATION_TYPE2_MAP: IDataVerificationType2Map = {\n    common: {\n      between: \"bw\",\n      notBetween: \"nb\",\n      equal: \"eq\",\n      notEqualTo: \"ne\",\n      moreThanThe: \"gt\",\n      lessThan: \"lt\",\n      greaterOrEqualTo: \"gte\",\n      lessThanOrEqualTo: \"lte\",\n    },\n    text_content: {\n      include: \"include\",\n      exclude: \"exclude\",\n      equal: \"equal\",\n    },\n    date: {\n      between: \"bw\",\n      notBetween: \"nb\",\n      equal: \"eq\",\n      notEqualTo: \"ne\",\n      earlierThan: \"bf\",\n      noEarlierThan: \"nbf\",\n      laterThan: \"af\",\n      noLaterThan: \"naf\",\n    },\n    validity: {\n      card: \"card\",\n      phone: \"phone\",\n    },\n};\n\nexport { IattributeList };\n","import { columeHeader_word, columeHeader_word_index } from \"./constant\";\nimport { IluckySheetSelection } from \"../ToLuckySheet/ILuck\";\nimport { IattributeList, stringToNum} from \"../ICommon\";\n\n\nexport function getRangetxt(range:IluckySheetSelection, sheettxt:string) {\n\n    let row0 = range[\"row\"][0], row1 = range[\"row\"][1];\n    let column0 = range[\"column\"][0], column1 = range[\"column\"][1];\n\n    if (row0 == null && row1 == null) {\n        return sheettxt + chatatABC(column0) + \":\" + chatatABC(column1);\n    }\n    else if (column0 == null && column1 == null) {\n        return sheettxt + (row0 + 1) + \":\" + (row1 + 1);\n    }\n    else {\n        if (column0 == column1 && row0 == row1) {\n            return sheettxt + chatatABC(column0) + (row0 + 1);\n        }\n        else {\n            return sheettxt + chatatABC(column0) + (row0 + 1) + \":\" + chatatABC(column1) + (row1 + 1);\n        }\n    }\n}\n\n\nexport function getcellrange (txt:string, sheets:IattributeList={}, sheetId:string=\"1\") {\n    let val = txt.split(\"!\");\n\n    let sheettxt = \"\",\n        rangetxt = \"\",\n        sheetIndex = -1;\n\n    if (val.length > 1) {\n        sheettxt = val[0];\n        rangetxt = val[1];\n        \n        let si = sheets[sheettxt];\n        if(si==null){\n            sheetIndex = parseInt(sheetId);\n        }\n        else{\n            sheetIndex = parseInt(si);\n        }\n    } \n    else {\n        sheetIndex = parseInt(sheetId);\n        rangetxt = val[0];\n    }\n    \n    if (rangetxt.indexOf(\":\") == -1) {\n        let row = parseInt(rangetxt.replace(/[^0-9]/g, \"\")) - 1;\n        let col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, \"\"));\n\n        if (!isNaN(row) && !isNaN(col)) {\n            return {\n                \"row\": [row, row],\n                \"column\": [col, col],\n                \"sheetIndex\": sheetIndex\n            };\n        }\n        else {\n            return null;\n        }\n    } \n    else {\n        let rangetxtArray:string[] = rangetxt.split(\":\");\n        let row = [],col = [];\n        row[0] = parseInt(rangetxtArray[0].replace(/[^0-9]/g, \"\")) - 1;\n        row[1] = parseInt(rangetxtArray[1].replace(/[^0-9]/g, \"\")) - 1;\n        // if (isNaN(row[0])) {\n        //     row[0] = 0;\n        // }\n        // if (isNaN(row[1])) {\n        //     row[1] = sheetdata.length - 1;\n        // }\n        if (row[0] > row[1]) {\n            return null;\n        }\n        col[0] = ABCatNum(rangetxtArray[0].replace(/[^A-Za-z]/g, \"\"));\n        col[1] = ABCatNum(rangetxtArray[1].replace(/[^A-Za-z]/g, \"\"));\n        // if (isNaN(col[0])) {\n        //     col[0] = 0;\n        // }\n        // if (isNaN(col[1])) {\n        //     col[1] = sheetdata[0].length - 1;\n        // }\n        if (col[0] > col[1]) {\n            return null;\n        }\n\n        return {\n            \"row\": row,\n            \"column\": col,\n            \"sheetIndex\": sheetIndex\n        };\n    }\n}\n\n//列下标  字母转数字\nfunction ABCatNum(abc:string) {\n    abc = abc.toUpperCase();\n\n    let abc_len = abc.length;\n    if (abc_len == 0) {\n        return NaN;\n    }\n\n    let abc_array = abc.split(\"\");\n    let wordlen = columeHeader_word.length;\n    let ret = 0;\n\n    for (let i = abc_len - 1; i >= 0; i--) {\n        if (i == abc_len - 1) {\n            ret += columeHeader_word_index[abc_array[i]];\n        }\n        else {\n            ret += Math.pow(wordlen, abc_len - i - 1) * (columeHeader_word_index[abc_array[i]] + 1);\n        }\n    }\n\n    return ret;\n}\n\n//列下标  数字转字母\nexport function chatatABC(index:number) {\n    let wordlen = columeHeader_word.length;\n\n    if (index < wordlen) {\n        return columeHeader_word[index];\n    }\n    else {\n        let last = 0, pre = 0, ret = \"\";\n        let i = 1, n = 0;\n\n        while (index >= (wordlen / (wordlen - 1)) * (Math.pow(wordlen, i++) - 1)) {\n            n = i;\n        }\n\n        let index_ab = index - (wordlen / (wordlen - 1)) * (Math.pow(wordlen, n - 1) - 1);//970\n        last = index_ab + 1;\n\n        for (let x = n; x > 0; x--) {\n            let last1 = last, x1 = x;//-702=268, 3\n\n            if (x == 1) {\n                last1 = last1 % wordlen;\n\n                if (last1 == 0) {\n                    last1 = 26;\n                }\n\n                return ret + columeHeader_word[last1 - 1];\n            }\n\n            last1 = Math.ceil(last1 / Math.pow(wordlen, x - 1));\n            //last1 = last1 % wordlen;\n            ret += columeHeader_word[last1 - 1];\n\n            if (x > 1) {\n                last = last - (last1 - 1) * wordlen;\n            }\n        }\n    }\n}\n\n/** \n * @return ratio, default 0.75 1in = 2.54cm = 25.4mm = 72pt = 6pc,  pt = 1/72 In, px = 1/dpi In\n*/\nexport function getptToPxRatioByDPI():number{\n    return 72/96;\n}\n\n/** \n * @emus EMUs, Excel drawing unit\n * @return pixel\n*/\nexport function getPxByEMUs(emus:number){\n    if(emus==null){\n        return 0;\n    }\n    let inch = emus/914400;\n    let pt = inch*72;\n    let px = pt / getptToPxRatioByDPI();\n    return px;\n}\n\n/** \n * @dom xml attribute object\n * @attr attribute name\n * @d if attribute is null, return default value \n * @return attribute value\n*/\nexport function getXmlAttibute(dom:IattributeList, attr:string, d:string){\n    let value = dom[attr];\n    value = value==null?d:value;\n    return value;\n}\n\n/** \n * @columnWidth Excel column width\n * @return pixel column width\n*/\nexport function getColumnWidthPixel(columnWidth:number){\n    let pix = Math.round((columnWidth-0.83) * 8 + 5);\n    return pix;\n}\n\n/** \n * @rowHeight Excel row height\n * @return pixel row height\n*/\nexport function getRowHeightPixel(rowHeight:number){\n    let pix = Math.round(rowHeight/getptToPxRatioByDPI());\n    return pix;\n}\n\nexport function LightenDarkenColor(sixColor:string, tint:number){\n    let hex:string = sixColor.substring(sixColor.length-6,sixColor.length);\n    let rgbArray:number[] = hexToRgbArray(\"#\"+hex);\n    let hslArray = rgbToHsl(rgbArray[0], rgbArray[1],rgbArray[2]);\n    if(tint>0){\n        hslArray[2] = hslArray[2] * (1.0-tint) + tint;\n    }\n    else if(tint<0){\n        hslArray[2] = hslArray[2] * (1.0 + tint)\n    }\n    else{\n        return \"#\"+hex;\n    }\n\n    let newRgbArray = hslToRgb(hslArray[0],hslArray[1],hslArray[2]);\n\n    return rgbToHex(\"RGB(\" + newRgbArray.join(\",\") + \")\");\n}\n\n\nexport function rgbToHex(rgb:string){\n    //十六进制颜色值的正则表达式\n    var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\n    // 如果是rgb颜色表示\n    if (/^(rgb|RGB)/.test(rgb)) {\n        var aColor = rgb.replace(/(?:\\(|\\)|rgb|RGB)*/g, \"\").split(\",\");\n        var strHex = \"#\";\n        for (var i=0; i<aColor.length; i++) {\n            var hex = Number(aColor[i]).toString(16);\n            if (hex.length < 2) {\n                hex = '0' + hex;    \n            }\n            strHex += hex;\n        }\n        if (strHex.length !== 7) {\n            strHex = rgb;    \n        }\n        return strHex;\n    } else if (reg.test(rgb)) {\n        var aNum = rgb.replace(/#/,\"\").split(\"\");\n        if (aNum.length === 6) {\n            return rgb;    \n        } else if(aNum.length === 3) {\n            var numHex = \"#\";\n            for (var i=0; i<aNum.length; i+=1) {\n                numHex += (aNum[i] + aNum[i]);\n            }\n            return numHex;\n        }\n    }\n    return rgb;\n}\n\nfunction hexToRgb(hex:string){\n    var sColor = hex.toLowerCase();\n    //十六进制颜色值的正则表达式\n    var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\n    // 如果是16进制颜色\n    if (sColor && reg.test(sColor)) {\n        if (sColor.length === 4) {\n            var sColorNew = \"#\";\n            for (var i=1; i<4; i+=1) {\n                sColorNew += sColor.slice(i, i+1).concat(sColor.slice(i, i+1));    \n            }\n            sColor = sColorNew;\n        }\n        //处理六位的颜色值\n        var sColorChange = [];\n        for (var i=1; i<7; i+=2) {\n            sColorChange.push(parseInt(\"0x\"+sColor.slice(i, i+2)));    \n        }\n        return \"RGB(\" + sColorChange.join(\",\") + \")\";\n    }\n    return sColor;\n}\n\nfunction hexToRgbArray(hex:string){\n    var sColor = hex.toLowerCase();\n    //十六进制颜色值的正则表达式\n    var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\n    // 如果是16进制颜色\n    if (sColor && reg.test(sColor)) {\n        if (sColor.length === 4) {\n            var sColorNew = \"#\";\n            for (var i=1; i<4; i+=1) {\n                sColorNew += sColor.slice(i, i+1).concat(sColor.slice(i, i+1));    \n            }\n            sColor = sColorNew;\n        }\n        //处理六位的颜色值\n        var sColorChange:number[] = [];\n        for (var i=1; i<7; i+=2) {\n            sColorChange.push(parseInt(\"0x\"+sColor.slice(i, i+2)));    \n        }\n        return  sColorChange;\n    }\n    return null;\n}\n\n/**\n * HSL颜色值转换为RGB. \n * 换算公式改编自 http://en.wikipedia.org/wiki/HSL_color_space.\n * h, s, 和 l 设定在 [0, 1] 之间\n * 返回的 r, g, 和 b 在 [0, 255]之间\n *\n * @param   Number  h       色相\n * @param   Number  s       饱和度\n * @param   Number  l       亮度\n * @return  Array           RGB色值数值\n */\nfunction hslToRgb(h:number, s:number, l:number) {\n    var r, g, b;\n\n    if(s == 0) {\n        r = g = b = l; // achromatic\n    } else {\n        var hue2rgb = function hue2rgb(p:number, q:number, t:number) {\n            if(t < 0) t += 1;\n            if(t > 1) t -= 1;\n            if(t < 1/6) return p + (q - p) * 6 * t;\n            if(t < 1/2) return q;\n            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n            return p;\n        }\n\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1/3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1/3);\n    }\n\n    return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n}\n\n\n/**\n * RGB 颜色值转换为 HSL.\n * 转换公式参考自 http://en.wikipedia.org/wiki/HSL_color_space.\n * r, g, 和 b 需要在 [0, 255] 范围内\n * 返回的 h, s, 和 l 在 [0, 1] 之间\n *\n * @param   Number  r       红色色值\n * @param   Number  g       绿色色值\n * @param   Number  b       蓝色色值\n * @return  Array           HSL各值数组\n */\nfunction rgbToHsl(r:number, g:number, b:number) {\n    r /= 255, g /= 255, b /= 255;\n    var max = Math.max(r, g, b), min = Math.min(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if (max == min){ \n        h = s = 0; // achromatic\n    } else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch(max) {\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n            case g: h = (b - r) / d + 2; break;\n            case b: h = (r - g) / d + 4; break;\n        }\n        h /= 6;\n    }\n\n    return [h, s, l];\n}\n \nexport function generateRandomIndex(prefix:string):string {\n    if(prefix == null){\n        prefix = \"Sheet\";\n    }\n\n    let userAgent = window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g, \"\").split(\"\");\n\n    let mid = \"\";\n\n    for(let i = 0; i < 5; i++){\n        mid += userAgent[Math.round(Math.random() * (userAgent.length - 1))];\n    }\n\n    let time = new Date().getTime();\n\n    return prefix + \"_\" + mid + \"_\" + time;\n}\n\n\nexport function escapeCharacter(str:string){\n    if(str==null || str.length==0){\n        return str;\n    }\n\n    return str.replace(/&amp;/g, \"&\").replace(/&quot;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&nbsp;/g, ' ').replace(/&apos;/g, \"'\").replace(/&iexcl;/g, \"¡\").replace(/&cent;/g, \"¢\").replace(/&pound;/g, \"£\").replace(/&curren;/g, \"¤\").replace(/&yen;/g, \"¥\").replace(/&brvbar;/g, \"¦\").replace(/&sect;/g, \"§\").replace(/&uml;/g, \"¨\").replace(/&copy;/g, \"©\").replace(/&ordf;/g, \"ª\").replace(/&laquo;/g, \"«\").replace(/&not;/g, \"¬\").replace(/&shy;/g, \"­\").replace(/&reg;/g, \"®\").replace(/&macr;/g, \"¯\").replace(/&deg;/g, \"°\").replace(/&plusmn;/g, \"±\").replace(/&sup2;/g, \"²\").replace(/&sup3;/g, \"³\").replace(/&acute;/g, \"´\").replace(/&micro;/g, \"µ\").replace(/&para;/g, \"¶\").replace(/&middot;/g, \"·\").replace(/&cedil;/g, \"¸\").replace(/&sup1;/g, \"¹\").replace(/&ordm;/g, \"º\").replace(/&raquo;/g, \"»\").replace(/&frac14;/g, \"¼\").replace(/&frac12;/g, \"½\").replace(/&frac34;/g, \"¾\").replace(/&iquest;/g, \"¿\").replace(/&times;/g, \"×\").replace(/&divide;/g, \"÷\").replace(/&Agrave;/g, \"À\").replace(/&Aacute;/g, \"Á\").replace(/&Acirc;/g, \"Â\").replace(/&Atilde;/g, \"Ã\").replace(/&Auml;/g, \"Ä\").replace(/&Aring;/g, \"Å\").replace(/&AElig;/g, \"Æ\").replace(/&Ccedil;/g, \"Ç\").replace(/&Egrave;/g, \"È\").replace(/&Eacute;/g, \"É\").replace(/&Ecirc;/g, \"Ê\").replace(/&Euml;/g, \"Ë\").replace(/&Igrave;/g, \"Ì\").replace(/&Iacute;/g, \"Í\").replace(/&Icirc;/g, \"Î\").replace(/&Iuml;/g, \"Ï\").replace(/&ETH;/g, \"Ð\").replace(/&Ntilde;/g, \"Ñ\").replace(/&Ograve;/g, \"Ò\").replace(/&Oacute;/g, \"Ó\").replace(/&Ocirc;/g, \"Ô\").replace(/&Otilde;/g, \"Õ\").replace(/&Ouml;/g, \"Ö\").replace(/&Oslash;/g, \"Ø\").replace(/&Ugrave;/g, \"Ù\").replace(/&Uacute;/g, \"Ú\").replace(/&Ucirc;/g, \"Û\").replace(/&Uuml;/g, \"Ü\").replace(/&Yacute;/g, \"Ý\").replace(/&THORN;/g, \"Þ\").replace(/&szlig;/g, \"ß\").replace(/&agrave;/g, \"à\").replace(/&aacute;/g, \"á\").replace(/&acirc;/g, \"â\").replace(/&atilde;/g, \"ã\").replace(/&auml;/g, \"ä\").replace(/&aring;/g, \"å\").replace(/&aelig;/g, \"æ\").replace(/&ccedil;/g, \"ç\").replace(/&egrave;/g, \"è\").replace(/&eacute;/g, \"é\").replace(/&ecirc;/g, \"ê\").replace(/&euml;/g, \"ë\").replace(/&igrave;/g, \"ì\").replace(/&iacute;/g, \"í\").replace(/&icirc;/g, \"î\").replace(/&iuml;/g, \"ï\").replace(/&eth;/g, \"ð\").replace(/&ntilde;/g, \"ñ\").replace(/&ograve;/g, \"ò\").replace(/&oacute;/g, \"ó\").replace(/&ocirc;/g, \"ô\").replace(/&otilde;/g, \"õ\").replace(/&ouml;/g, \"ö\").replace(/&oslash;/g, \"ø\").replace(/&ugrave;/g, \"ù\").replace(/&uacute;/g, \"ú\").replace(/&ucirc;/g, \"û\").replace(/&uuml;/g, \"ü\").replace(/&yacute;/g, \"ý\").replace(/&thorn;/g, \"þ\").replace(/&yuml;/g, \"ÿ\");\n\n}\n\n\nexport class fromulaRef {\n\n    static operator = '==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^'\n    static error = {\n        v: \"#VALUE!\",    //错误的参数或运算符\n        n: \"#NAME?\",     //公式名称错误\n        na: \"#N/A\",      //函数或公式中没有可用数值\n        r: \"#REF!\",      //删除了由其他公式引用的单元格\n        d: \"#DIV/0!\",    //除数是0或空单元格\n        nm: \"#NUM!\",     //当公式或函数中某个数字有问题时\n        nl: \"#NULL!\",    //交叉运算符（空格）使用不正确\n        sp: \"#SPILL!\"    //数组范围有其它值\n    }\n\n    static operatorjson:stringToNum = null\n\n    static trim(str:string) {  \n        if(str == null){  \n            str = \"\";  \n        }  \n        return str.replace(/(^\\s*)|(\\s*$)/g, \"\");  \n    }\n\n    static functionCopy(txt:string, mode:string, step:number) {\n        let _this = this;\n\n        if (_this.operatorjson == null) {\n            let arr = _this.operator.split(\"|\"),\n                op:stringToNum = {};\n\n            for (let i = 0; i < arr.length; i++) {\n                op[arr[i].toString()] = 1;\n            }\n\n            _this.operatorjson = op;\n        }\n\n        if (mode == null) {\n            mode = \"down\";\n        }\n\n        if (step == null) {\n            step = 1;\n        }\n\n        if (txt.substr(0, 1) == \"=\") {\n            txt = txt.substr(1);\n        }\n\n        let funcstack = txt.split(\"\");\n        let i = 0,\n            str = \"\",\n            function_str = \"\",\n            ispassby = true;\n        \n        let matchConfig = {\n            \"bracket\": 0,\n            \"comma\": 0,\n            \"squote\": 0,\n            \"dquote\": 0\n        };\n\n        while (i < funcstack.length) {\n            let s = funcstack[i];\n\n            if (s == \"(\" && matchConfig.dquote == 0) {\n                matchConfig.bracket += 1;\n\n                if (str.length > 0) {\n                    function_str += str + \"(\";\n                } \n                else {\n                    function_str += \"(\";\n                }\n\n                str = \"\";\n            } \n            else if (s == \")\" && matchConfig.dquote == 0) {\n                matchConfig.bracket -= 1;\n                function_str += _this.functionCopy(str, mode, step) + \")\";\n                str = \"\";\n            }\n            else if (s == '\"' && matchConfig.squote == 0) {\n                if (matchConfig.dquote > 0) {\n                    function_str += str + '\"';\n                    matchConfig.dquote -= 1;\n                    str = \"\";\n                } \n                else {\n                    matchConfig.dquote += 1;\n                    str += '\"';\n                }\n            } \n            else if (s == ',' && matchConfig.dquote == 0) {\n                function_str += _this.functionCopy(str, mode, step) + ',';\n                str = \"\";\n            } \n            else if (s == '&' && matchConfig.dquote == 0) {\n                if (str.length > 0) {\n                    function_str += _this.functionCopy(str, mode, step) + \"&\";\n                    str = \"\";\n                } \n                else {\n                    function_str += \"&\";\n                }\n            } \n            else if (s in _this.operatorjson && matchConfig.dquote == 0) {\n                let s_next = \"\";\n\n                if ((i + 1) < funcstack.length) {\n                    s_next = funcstack[i + 1];\n                }\n\n                let p = i - 1, \n                    s_pre = null;\n\n                if(p >= 0){\n                    do {\n                        s_pre = funcstack[p--];\n                    }\n                    while (p>=0 && s_pre ==\" \")\n                }\n\n                if ((s + s_next) in _this.operatorjson) {\n                    if (str.length > 0) {\n                        function_str += _this.functionCopy(str, mode, step) + s + s_next;\n                        str = \"\";\n                    } \n                    else {\n                        function_str += s + s_next;\n                    }\n\n                    i++;\n                }\n                else if(!(/[^0-9]/.test(s_next)) && s==\"-\" && (s_pre==\"(\" || s_pre == null || s_pre == \",\" || s_pre == \" \" || s_pre in _this.operatorjson ) ){\n                    str += s;\n                }\n                else {\n                    if (str.length > 0) {\n                        function_str += _this.functionCopy(str, mode, step) + s;\n                        str = \"\";\n                    } \n                    else {\n                        function_str += s;\n                    }\n                }\n            } \n            else {\n                str += s;\n            }\n\n            if (i == funcstack.length - 1) {\n                if (_this.iscelldata(_this.trim(str))) {\n                    if (mode == \"down\") {\n                        function_str += _this.downparam(_this.trim(str), step);\n                    } \n                    else if (mode == \"up\") {\n                        function_str += _this.upparam(_this.trim(str), step);\n                    } \n                    else if (mode == \"left\") {\n                        function_str += _this.leftparam(_this.trim(str), step);\n                    } \n                    else if (mode == \"right\") {\n                        function_str += _this.rightparam(_this.trim(str), step);\n                    }\n                } \n                else {\n                    function_str += _this.trim(str);\n                }\n            }\n            \n            i++;\n        }\n\n        return function_str;\n    }\n\n\n    static downparam(txt:string, step:number) {\n        return this.updateparam(\"d\", txt, step);\n    }\n\n    static upparam(txt:string, step:number) {\n        return this.updateparam(\"u\", txt, step);\n    }\n\n    static leftparam(txt:string, step:number) {\n        return this.updateparam(\"l\", txt, step);\n    }\n\n    static rightparam (txt:string, step:number) {\n        return this.updateparam(\"r\", txt, step);\n    }\n\n\n    static updateparam (orient:string, txt:string, step:number) {\n        let _this = this;\n        let val = txt.split(\"!\"),\n            rangetxt, prefix = \"\";\n        \n        if (val.length > 1) {\n            rangetxt = val[1];\n            prefix = val[0] + \"!\";\n        } \n        else {\n            rangetxt = val[0];\n        }\n\n        if (rangetxt.indexOf(\":\") == -1) {\n            let row = parseInt(rangetxt.replace(/[^0-9]/g, \"\"));\n            let col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, \"\"));\n            let freezonFuc = _this.isfreezonFuc(rangetxt);\n            let $row = freezonFuc[0] ? \"$\" : \"\",\n                $col = freezonFuc[1] ? \"$\" : \"\";\n            \n            if (orient == \"u\" && !freezonFuc[0]) {\n                row -= step;\n            } \n            else if (orient == \"r\" && !freezonFuc[1]) {\n                col += step;\n            } \n            else if (orient == \"l\" && !freezonFuc[1]) {\n                col -= step;\n            } \n            else if (!freezonFuc[0]) {\n                row += step;\n            }\n\n            if(row < 0 || col < 0){\n                return _this.error.r;\n            }\n            \n            if (!isNaN(row) && !isNaN(col)) {\n                return prefix + $col + chatatABC(col) + $row + (row);\n            } \n            else if (!isNaN(row)) {\n                return prefix + $row + (row);\n            } \n            else if (!isNaN(col)) {\n                return prefix + $col + chatatABC(col);\n            } \n            else {\n                return txt;\n            }\n        } \n        else {\n            rangetxt = rangetxt.split(\":\");\n            let row = [],\n                col = [];\n\n            row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, \"\"));\n            row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, \"\"));\n            if (row[0] > row[1]) {\n                return txt;\n            }\n            \n            col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, \"\"));\n            col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, \"\"));\n            if (col[0] > col[1]) {\n                return txt;\n            }\n\n            let freezonFuc0 = _this.isfreezonFuc(rangetxt[0]);\n            let freezonFuc1 = _this.isfreezonFuc(rangetxt[1]);\n            let $row0 = freezonFuc0[0] ? \"$\" : \"\",\n                $col0 = freezonFuc0[1] ? \"$\" : \"\";\n            let $row1 = freezonFuc1[0] ? \"$\" : \"\",\n                $col1 = freezonFuc1[1] ? \"$\" : \"\";\n            \n            if (orient == \"u\") {\n                if (!freezonFuc0[0]) {\n                    row[0] -= step;\n                }\n\n                if (!freezonFuc1[0]) {\n                    row[1] -= step;\n                }\n            } \n            else if (orient == \"r\") {\n                if (!freezonFuc0[1]) {\n                    col[0] += step;\n                }\n\n                if (!freezonFuc1[1]) {\n                    col[1] += step;\n                }\n            } \n            else if (orient == \"l\") {\n                if (!freezonFuc0[1]) {\n                    col[0] -= step;\n                }\n\n                if (!freezonFuc1[1]) {\n                    col[1] -= step;\n                }\n            } \n            else {\n                if (!freezonFuc0[0]) {\n                    row[0] += step;\n                }\n\n                if (!freezonFuc1[0]) {\n                    row[1] += step;\n                }\n            }\n\n            if(row[0] < 0 || col[0] < 0){\n                return _this.error.r;\n            }\n\n            if (isNaN(col[0]) && isNaN(col[1])) {\n                return prefix + $row0 + (row[0]) + \":\" + $row1 + (row[1]);\n            } \n            else if (isNaN(row[0]) && isNaN(row[1])) {\n                return prefix + $col0 + chatatABC(col[0]) + \":\" + $col1 + chatatABC(col[1]);\n            } \n            else {\n                return prefix + $col0 + chatatABC(col[0]) + $row0 + (row[0]) + \":\" + $col1 + chatatABC(col[1]) + $row1 + (row[1]);\n            }\n        }\n    }\n\n\n    static iscelldata(txt:string) { //判断是否为单元格格式\n        let val = txt.split(\"!\"),\n            rangetxt;\n\n        if (val.length > 1) {\n            rangetxt = val[1];\n        } \n        else {\n            rangetxt = val[0];\n        }\n\n        let reg_cell = /^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g; //增加正则判断单元格为字母+数字的格式：如 A1:B3\n        let reg_cellRange = /^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g; //增加正则判断单元格为字母+数字或字母的格式：如 A1:B3，A:A\n        \n        if (rangetxt.indexOf(\":\") == -1) {\n            let row = parseInt(rangetxt.replace(/[^0-9]/g, \"\")) - 1;\n            let col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, \"\"));\n            \n            if (!isNaN(row) && !isNaN(col) && rangetxt.toString().match(reg_cell)) {\n                return true;\n            } \n            else if (!isNaN(row)) {\n                return false;\n            } \n            else if (!isNaN(col)) {\n                return false;\n            } \n            else {\n                return false;\n            }\n        } \n        else {\n            reg_cellRange = /^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g;\n\n            rangetxt = rangetxt.split(\":\");\n\n            let row = [],col = [];\n            row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, \"\")) - 1;\n            row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, \"\")) - 1;\n            if (row[0] > row[1]) {\n                return false;\n            }\n\n            col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, \"\"));\n            col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, \"\"));\n            if (col[0] > col[1]) {\n                return false;\n            }\n\n            if(rangetxt[0].toString().match(reg_cellRange) && rangetxt[1].toString().match(reg_cellRange)){\n                return true;\n            }\n            else{\n                return false;\n            }\n        }\n    }\n\n    static isfreezonFuc(txt:string) {\n        let row = txt.replace(/[^0-9]/g, \"\");\n        let col = txt.replace(/[^A-Za-z]/g, \"\");\n        let row$ = txt.substr(txt.indexOf(row) - 1, 1);\n        let col$ = txt.substr(txt.indexOf(col) - 1, 1);\n        let ret = [false, false];\n\n        if (row$ == \"$\") {\n            ret[0] = true;\n        }\n        if (col$ == \"$\") {\n            ret[1] = true;\n        }\n\n        return ret;\n    }\n\n}\n\n\n\nexport function isChinese(temp:string):boolean\n{ \n    var re = /[^\\u4e00-\\u9fa5]/; \n    var reg = /[\\u3002|\\uff1f|\\uff01|\\uff0c|\\u3001|\\uff1b|\\uff1a|\\u201c|\\u201d|\\u2018|\\u2019|\\uff08|\\uff09|\\u300a|\\u300b|\\u3008|\\u3009|\\u3010|\\u3011|\\u300e|\\u300f|\\u300c|\\u300d|\\ufe43|\\ufe44|\\u3014|\\u3015|\\u2026|\\u2014|\\uff5e|\\ufe4f|\\uffe5]/;\n    if(reg.test(temp)) return true; \n    if(re.test(temp)) return false; \n\treturn true; \n}\n \nexport function isJapanese(temp:string):boolean\n{ \n\tvar re = /[^\\u0800-\\u4e00]/; \n\tif(re.test(temp)) return false; \n\treturn true; \n}\n \nexport function isKoera(chr:any):boolean {\n\t\n\tif(((chr > 0x3130 && chr < 0x318F) || \n\t    (chr >= 0xAC00 && chr <= 0xD7A3))) \n\t{\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isContainMultiType(str:string):boolean {\n\t\n    let isUnicode = false;\n    if(escape(str).indexOf(\"%u\")>-1){\n        isUnicode = true;\n    }\n\n    let isNot = false;\n    let reg = /[0-9a-z]/gi; \n    if(reg.test(str)){\n        isNot = true;\n    }\n\n    let reEnSign = /[\\x00-\\xff]+/g;\n    if(reEnSign.test(str)){\n        isNot = true;\n    }\n\n    if(isUnicode && isNot){\n        return true;\n    }\n\n    return false;\n\n}\n\n\n\n\n\n\n\n\nexport function getBinaryContent (path:any, options:any) {\n    let promise, resolve:any, reject:any;\n    let callback:any;\n\n    if (!options) {\n        options = {};\n    }\n\n    // taken from jQuery\n    let createStandardXHR = function () {\n        try {\n            return new window.XMLHttpRequest();\n        } catch( e ) {}\n    }\n\n    let createActiveXHR = function () {\n        try {\n            return new window.ActiveXObject(\"Microsoft.XMLHTTP\");\n        } catch( e ) {}\n    }\n\n    // Create the request object\n    var createXHR = (typeof window !== \"undefined\" && window.ActiveXObject) ?\n        /* Microsoft failed to properly\n        * implement the XMLHttpRequest in IE7 (can't request local files),\n        * so we use the ActiveXObject when it is available\n        * Additionally XMLHttpRequest can be disabled in IE7/IE8 so\n        * we need a fallback.\n        */\n        function() {\n        return createStandardXHR() || createActiveXHR();\n    } :\n        // For all other browsers, use the standard XMLHttpRequest object\n        createStandardXHR;\n\n    // backward compatible callback\n    if (typeof options === \"function\") {\n        callback = options;\n        options = {};\n    } else if (typeof options.callback === 'function') {\n        // callback inside options object\n        callback = options.callback;\n    }\n\n    resolve = function (data:any) { callback(null, data); };\n    reject = function (err:any) { callback(err, null); };\n\n    try {\n        var xhr = createXHR();\n\n        xhr.open('GET', path, true);\n\n        // recent browsers\n        if (\"responseType\" in xhr) {\n            xhr.responseType = \"arraybuffer\";\n        }\n\n        // older browser\n        if(xhr.overrideMimeType) {\n            xhr.overrideMimeType(\"text/plain; charset=x-user-defined\");\n        }\n\n        xhr.onreadystatechange = function (event:Event) {\n            // use `xhr` and not `this`... thanks IE\n            if (xhr.readyState === 4) {\n                if (xhr.status === 200 || xhr.status === 0) {\n                    try {\n                        resolve(function (xhr:XMLHttpRequest) {\n                            // for xhr.responseText, the 0xFF mask is applied by JSZip\n                            return xhr.response || xhr.responseText;\n                        }(xhr));\n                    } catch(err) {\n                        reject(new Error(err));\n                    }\n                } else {\n                    reject(new Error(\"Ajax error for \" + path + \" : \" + this.status + \" \" + this.statusText));\n                }\n            }\n        };\n\n        if(options.progress) {\n            xhr.onprogress = function(e:any) {\n                options.progress({\n                    path: path,\n                    originalEvent: e,\n                    percent: e.loaded / e.total * 100,\n                    loaded: e.loaded,\n                    total: e.total\n                });\n            };\n        }\n\n        xhr.send();\n\n    } catch (e) {\n        reject(new Error(e), null);\n    }\n\n    // returns a promise or undefined depending on whether a callback was\n    // provided\n    return promise;\n}\n\n/**\n * multi sequence conversion\n * example:\n *  1、E14 -> 13_4\n *  2、E14 J14 O14 T14 Y14 AD14 AI14 AN14 AS14 AX14 ->\n *     ['13_4', '13_9','13_14', '13_19', '13_24', '13_3', '13_8',  '13_13', '13_18', '13_23']\n *  3、E46:E47 -> ['45_4',  '46_4']\n *\n * @param {string} sqref - before sequence\n * @returns {string[]}\n */\nexport function getMultiSequenceToNum(sqref: string): string[] {\n  if (!sqref || sqref?.length <= 0) return [];\n  sqref = sqref.toUpperCase();\n  let sqrefRawArr = sqref.split(\" \");\n  let sqrefArr = sqrefRawArr.filter((e) => e && e.trim());\n  let sqrefLastArr = getSqrefRawArrFormat(sqrefArr);\n\n  let resArr: string[] = [];\n  for (let i = 0; i < sqrefLastArr.length; i++) {\n    let _res = getSingleSequenceToNum(sqrefLastArr[i]);\n    if (_res) resArr.push(_res);\n  }\n  return resArr;\n}\n\n/**\n * get region sequence\n * example:\n *  1、[A1:C2'] -> ['A1', 'A2', 'B1', 'B2', 'C1', 'C2']\n *\n * @param {string[]} arr - formats arr\n * @returns {string[]} - after arr\n */\nexport function getRegionSequence(arr: string[]): string[] {\n  let formatArr: string[] = [];\n  \n  const regEn = new RegExp(/[A-Z]+|[0-9]+/g);\n  const startArr = arr[0]?.match(regEn);\n  const lastArr = arr[1]?.match(regEn);\n  const columnMax = Math.max(...[ABCatNum(startArr[0]), ABCatNum(lastArr[0])]);\n  const columnMin = Math.min(...[ABCatNum(startArr[0]), ABCatNum(lastArr[0])]);\n  const rowMax = Math.max(...[parseInt(startArr[1]), parseInt(lastArr[1])]);\n  const rowMin = Math.min(...[parseInt(startArr[1]), parseInt(lastArr[1])]);\n  \n  for (let i = columnMin; i <= columnMax; i++) {\n    for (let j = rowMin; j <= rowMax; j++) {\n      formatArr.push(`${chatatABC(i)}${j}`);\n    }\n  }\n\n  return formatArr;\n}\n\n/**\n * unified processing of conversion formats\n * example:\n *  1、['E38', 'A1:C2'] -> ['E38', 'A1', 'A2', 'B1', 'B2', 'C1', 'C2']\n *\n * @param {string[]} arr - formats arr\n * @returns {string[]} - after arr\n */\nexport function getSqrefRawArrFormat(arr: string[]): string[] {\n  arr?.map((el) => {\n    if (el.includes(\":\")) {\n      let tempArr: string[] = el.split(\":\");\n      if (tempArr?.length === 2) {\n        arr = arr.concat(getRegionSequence(tempArr));\n        arr.splice(arr.indexOf(el), 1);\n      }\n    }\n  });\n\n  const resultArr = arr.filter(\n    (value, index, array) => array.indexOf(value) === index\n  );\n\n  return resultArr;\n}\n\n/**\n * single sequence to number\n * example:\n *  1、A1 -> 0_0\n *  2、ES14 -> 13_4\n *\n * @param {string} sqref - before sequence\n * @returns {string} - after sequence\n */\nexport function getSingleSequenceToNum(sqref: string): string {\n  let sqrefArray = sqref.match(/[A-Z]+|[0-9]+/g);\n  let sqrefLen = sqrefArray.length;\n  let regEn = new RegExp(\"^[A-Z]+$\");\n  let ret = \"\";\n  for (let i = sqrefLen - 1; i >= 0; i--) {\n    let cur = sqrefArray[i];\n    if (regEn.test(cur)) {\n      ret += ABCatNum(cur) + \"_\";\n    } else {\n      ret += parseInt(cur) - 1 + \"_\";\n    }\n  }\n  return ret.substring(0, ret.length - 1);\n}\n\n/**\n * R1C1 to Sequence\n * example: sheet2!R1C1 => sheet!A1\n *\n * @param {string} value - R1C1 value\n * @returns\n */\nexport function getTransR1C1ToSequence(value: string): string {\n  if (!value && value?.length <= 0) return \"\";\n\n  const len = value.length;\n  const index = value.lastIndexOf(\"!\");\n  const valueArr = [value.slice(0, index), value.slice(index + 1, len)];\n  const repStr = valueArr[1] || \"\";\n  const indexR = repStr.indexOf(\"R\");\n  const indexC = repStr.indexOf(\"C\");\n  \n  const row = Number(repStr.slice(indexR + 1, indexC));\n  const column = chatatABC(Number(repStr.slice(indexC + 1, repStr?.length)) - 1);\n\n  return `${valueArr[0]}!${column}${row}`;\n}\n\n/**\n * strip x14 format data\n *\n * @param {string} value\n * @returns {Object} - { formula, sqref }\n */\nexport function getPeelOffX14(value: string): {  [key: string]: any} {\n  if (!value || value?.length <= 0) return {};\n\n  // formula\n  const formulaReg = new RegExp(\"</x14:formula[^]>\", \"g\");\n  const lastIndex = value.match(formulaReg)?.length;\n  const lastValue = `</x14:formula${lastIndex}>`;\n  const lastValueEnd = value.indexOf(lastValue);\n  let formulaValue = value.substring(0, lastValueEnd + lastValue.length);\n  formulaValue = formulaValue\n    .replace(/<xm:f>/g, \"\")\n    .replace(/<\\/xm:f>/g, \"\")\n    .replace(/x14:/g, \"\")\n    .replace(/\\/x14:/g, \"\");\n  const formula = formulaValue;\n  \n  // sqref\n  const xmSqrefLen = \"<xm:sqref>\".length;\n  const sqrefStart = value.indexOf(\"<xm:sqref>\");\n  const sqrefEnd = value.indexOf(\"</xm:sqref>\");\n  const sqref = value.substring(sqrefStart + xmSqrefLen, sqrefEnd);\n\n  return {\n    formula,\n    sqref,\n  };\n}\n\n\n/**\n * get the value in the formula\n *\n * @param {string} value - extracted value\n * @returns {string[]}\n */\nexport function getMultiFormulaValue(value: string): string[] {\n  if (!value || value?.length <= 0) return [];\n  \n  const lenReg = new RegExp(\"formula\", \"g\");\n  const len = (value.match(lenReg)?.length || 0) / 2;\n  \n  if (len === 0) return [];\n  \n  let retArr: any = [];\n  for (let i = 1; i <= len; i++) {\n    const startLen = `<formula${i}>`?.length;\n    const start = value.indexOf(`<formula${i}>`);\n    const end = value.indexOf(`</formula${i}>`);\n    const _value = value.substring(start + startLen, end);\n    retArr.push(escapeCharacter(_value.replace(/&quot;|^\\\"|\\\"$/g, \"\")));\n  }\n  return retArr;\n}\n\n/**\n * 检查某一单元格是否在指定区域内\n * @param {Number} r 单元格所在行\n * @param {Number} c 单元格所在列\n * @param {Array} specifiedRange 指定区域 \n */\nexport function checkCellWithinSpecifiedRange(r: number, c: number, specifiedRange: {row: number[], column: number[]}[]) {\n    let within = false\n    if (!specifiedRange || specifiedRange.length === 0) {\n        return false\n    }\n    for(let item of specifiedRange){\n        let r1 = item.row[0], r2 = item.row[1];\n        let c1 = item.column[0], c2 = item.column[1];\n\n        if(r>=r1 && r<=r2 && c>=c1 && c<=c2){\n            within = true;\n            break;\n        }\n    }\n    return within\n}\nexport interface CellAddress {\n\t/** Column number */\n\tc: number | string;\n\t/** Row number */\n\tr: number | string;\n}\n\nexport interface Range {\n\t/** Starting cell */\n\ts: CellAddress;\n\t/** Ending cell */\n\te: CellAddress;\n}\n\nexport function decodeCell(cstr: string) {\n\tvar R = 0, C = 0;\n\tfor(var i = 0; i < cstr.length; ++i) {\n\t\tvar cc = cstr.charCodeAt(i);\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r:R - 1 };\n}\n\nexport function encodeCell(cell: CellAddress): string {\n    if (typeof cell.c === 'string') {\n        cell.c = parseInt(cell.c)\n    }\n    if (typeof cell.r === 'string') {\n        cell.r = parseInt(cell.r)\n    }\n\tvar col = cell.c + 1;\n\tvar s=\"\";\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\n\nexport function decodeRange(range: string):Range {\n\tvar idx = range.indexOf(\":\");\n\tif(idx == -1) return { s: decodeCell(range), e: decodeCell(range) };\n\treturn { s: decodeCell(range.slice(0, idx)), e: decodeCell(range.slice(idx + 1)) };\n}\n\nexport function encodeRange(cs: CellAddress, ce: CellAddress):string {\n    let s,e\n\tif(typeof cs !== 'string') {\n        s = encodeCell(cs)\n    }\n\tif(typeof ce !== 'string') {\n        e = encodeCell(ce);\n    }\n\treturn s == e ? s : s + \":\" + e;\n}","import {IuploadfileList, IattributeList, stringToNum} from \"../ICommon\";\nimport {indexedColors}  from \"../common/constant\";\nimport {LightenDarkenColor}  from \"../common/method\";\n\n\nclass xmloperation {\n    /**\n    * @param tag Search xml tag name , div,title etc.\n    * @param file Xml string\n    * @return Xml element string \n    */\n    protected getElementsByOneTag(tag:string, file:string):string[]{\n        //<a:[^/>: ]+?>.*?</a:[^/>: ]+?>\n        let readTagReg;\n        if(tag.indexOf(\"|\")>-1){\n            let tags = tag.split(\"|\"), tagsRegTxt=\"\";\n            for(let i=0;i<tags.length;i++){\n                let t = tags[i];\n                tagsRegTxt += \"|<\"+ t +\" [^>]+?[^/]>[\\\\s\\\\S]*?</\"+ t +\">|<\"+ t +\" [^>]+?/>|<\"+ t +\">[\\\\s\\\\S]*?</\"+ t +\">|<\"+ t +\"/>\";\n            }\n            tagsRegTxt = tagsRegTxt.substr(1, tagsRegTxt.length);\n            readTagReg = new RegExp(tagsRegTxt, \"g\");\n        }\n        else{\n            readTagReg = new RegExp(\"<\"+ tag +\" [^>]+?[^/]>[\\\\s\\\\S]*?</\"+ tag +\">|<\"+ tag +\" [^>]+?/>|<\"+ tag +\">[\\\\s\\\\S]*?</\"+ tag +\">|<\"+ tag +\"/>\", \"g\");\n        }\n        \n        let ret = file.match(readTagReg);\n        if(ret==null){\n            return [];\n        }\n        else{\n            return ret;\n        }\n    }\n}\n\nexport class ReadXml extends xmloperation{\n    originFile:IuploadfileList\n    constructor(files:IuploadfileList){\n        super();\n        this.originFile = files;\n    }\n    /**\n    * @param path Search xml tag group , div,title etc.\n    * @param fileName One of uploadfileList, uploadfileList is file group, {key:value}\n    * @return Xml element calss\n    */\n    getElementsByTagName(path:string, fileName:string): Element[]{\n        \n        let file = this.getFileByName(fileName);\n        let pathArr = path.split(\"/\"), ret:string[] | string;\n        for(let key in pathArr){\n            let path = pathArr[key];\n            if(ret==undefined){\n                ret = this.getElementsByOneTag(path,file);\n            }\n            else{\n                if(ret instanceof Array){\n                    let items:string[]=[];\n                    for(let key in ret){\n                        let item = ret[key];\n                        items = items.concat(this.getElementsByOneTag(path,item));\n                    }\n                    ret = items;\n                }\n                else{\n                    ret = this.getElementsByOneTag(path,ret);\n                }\n            }\n        }\n\n        let elements:Element[] = [];\n\n        for(let i=0;i<ret.length;i++){\n            let ele = new Element(ret[i]);\n            elements.push(ele);\n        }\n\n        return elements;\n    }\n\n    /**\n    * @param name One of uploadfileList's name, search for file by this parameter\n    * @retrun Select a file from uploadfileList\n    */\n    private getFileByName(name:string):string{\n        for(let fileKey in this.originFile){\n            if(fileKey.indexOf(name)>-1){\n                return this.originFile[fileKey];\n            }\n        }\n        return \"\";\n    }\n\n    \n}\n\nexport class Element extends xmloperation {\n    elementString:string\n    attributeList:IattributeList\n    value:string\n    container:string\n    constructor(str:string){\n        super();\n        this.elementString = str;\n        this.setValue();\n        const readAttrReg = new RegExp('[a-zA-Z0-9_:]*?=\".*?\"', \"g\");\n        let attrList = this.container.match(readAttrReg);\n        this.attributeList = {};\n        if(attrList!=null){\n            for(let key in attrList){\n                let attrFull = attrList[key];\n                // let al= attrFull.split(\"=\");\n                if(attrFull.length==0){\n                    continue;\n                }\n                let attrKey = attrFull.substr(0, attrFull.indexOf('='));\n                let attrValue = attrFull.substr(attrFull.indexOf('=') + 1);\n                if(attrKey==null || attrValue==null ||attrKey.length==0 || attrValue.length==0){\n                    continue;\n                }\n                this.attributeList[attrKey] = attrValue.substr(1, attrValue.length-2);\n            }\n        }\n    }\n\n    /**\n    * @param name Get attribute by key in element\n    * @return Single attribute\n    */\n    get(name:string):string|number|boolean{\n        return this.attributeList[name];\n    }\n\n    /**\n    * @param tag Get elements by tag in elementString\n    * @return Element group\n    */\n    getInnerElements(tag:string):Element[]{\n        let ret = this.getElementsByOneTag(tag,this.elementString);\n        let elements:Element[] = [];\n\n        for(let i=0;i<ret.length;i++){\n            let ele = new Element(ret[i]);\n            elements.push(ele);\n        }\n\n        if(elements.length==0){\n            return null;\n        }\n        return elements;\n    }\n\n    /**\n    * @desc get xml dom value and container, <container>value</container>\n    */\n    private setValue(){\n        let str = this.elementString;\n        if(str.substr(str.length-2, 2)==\"/>\"){\n            this.value = \"\";\n            this.container = str;\n        }\n        else{\n            let firstTag = this.getFirstTag();\n            const firstTagReg = new RegExp(\"(<\"+ firstTag +\" [^>]+?[^/]>)([\\\\s\\\\S]*?)</\"+ firstTag +\">|(<\"+ firstTag +\">)([\\\\s\\\\S]*?)</\"+ firstTag +\">\", \"g\");\n            let result = firstTagReg.exec(str);\n            if (result != null) {\n                if(result[1]!=null){\n                    this.container = result[1];\n                    this.value = result[2];\n                }\n                else{\n                    this.container = result[3];\n                    this.value = result[4];\n                }\n            }\n        }\n    }\n\n    /**\n    * @desc get xml dom first tag, <a><b></b></a>, get a\n    */\n    private getFirstTag(){\n        let str = this.elementString;\n        let firstTag = str.substr(0, str.indexOf(' '));\n        if(firstTag==\"\" || firstTag.indexOf(\">\")>-1){\n            firstTag = str.substr(0, str.indexOf('>'));\n        }\n        firstTag = firstTag.substr(1,firstTag.length);\n        return firstTag;\n    }\n}\n\n\nexport interface IStyleCollections {\n    [index:string]:Element[] | IattributeList\n}\n\nfunction combineIndexedColor(indexedColorsInner:Element[], indexedColors:IattributeList):IattributeList{\n    let ret:IattributeList = {};\n    if(indexedColorsInner==null || indexedColorsInner.length==0){\n        return indexedColors;\n    }\n    for(let key in indexedColors){\n        let value = indexedColors[key], kn = parseInt(key);\n        let inner = indexedColorsInner[kn];\n        if(inner==null){\n            ret[key] = value;\n        }\n        else{\n            let rgb = inner.attributeList.rgb;\n            ret[key] = rgb;\n        }\n    }\n\n    return ret;\n}\n\n//clrScheme:Element[]\nexport function getColor(color:Element, styles:IStyleCollections , type:string=\"g\"){\n    let attrList = color.attributeList;\n    let clrScheme = styles[\"clrScheme\"] as Element[];\n    let indexedColorsInner = styles[\"indexedColors\"] as Element[];\n    let mruColorsInner = styles[\"mruColors\"];\n    let indexedColorsList = combineIndexedColor(indexedColorsInner, indexedColors);\n    let indexed = attrList.indexed, rgb = attrList.rgb, theme = attrList.theme, tint = attrList.tint;\n    let bg;\n    if(indexed!=null){\n        let indexedNum = parseInt(indexed);\n        bg = indexedColorsList[indexedNum];\n        if(bg!=null){\n            bg = bg.substring(bg.length-6, bg.length);\n            bg = \"#\"+bg;\n        }\n    }\n    else if(rgb!=null){\n        rgb = rgb.substring(rgb.length-6, rgb.length);\n        bg = \"#\"+rgb;\n    }\n    else if(theme!=null){\n        let themeNum = parseInt(theme);\n        if(themeNum==0){\n            themeNum = 1;\n        }\n        else if(themeNum==1){\n            themeNum = 0;\n        }\n        else if(themeNum==2){\n            themeNum = 3;\n        }\n        else if(themeNum==3){\n            themeNum = 2;\n        }\n        let clrSchemeElement = clrScheme[themeNum];\n        if(clrSchemeElement!=null){\n            let clrs = clrSchemeElement.getInnerElements(\"a:sysClr|a:srgbClr\");\n            if(clrs!=null){\n                let clr = clrs[0];\n                let clrAttrList = clr.attributeList;\n                // console.log(clr.container, );\n                if(clr.container.indexOf(\"sysClr\")>-1){\n                    // if(type==\"g\" && clrAttrList.val==\"windowText\"){\n                    //     bg = null;\n                    // }\n                    // else if((type==\"t\" || type==\"b\") && clrAttrList.val==\"window\"){\n                    //     bg = null;\n                    // }                    \n                    // else \n                    if(clrAttrList.lastClr!=null){\n                        bg = \"#\" + clrAttrList.lastClr;\n                    }\n                    else if(clrAttrList.val!=null){\n                        bg = \"#\" + clrAttrList.val;\n                    }\n\n                }\n                else if(clr.container.indexOf(\"srgbClr\")>-1){\n                    // console.log(clrAttrList.val);\n                    bg = \"#\" + clrAttrList.val;\n                }\n            }\n        }\n        \n    }\n    \n    if(tint!=null){\n        let tintNum = parseFloat(tint);\n        if(bg!=null){\n            bg = LightenDarkenColor(bg, tintNum);\n        }\n    }\n\n    return bg;\n}\n\n\n/** \n * @dom xml attribute object\n * @attr attribute name\n * @d if attribute is null, return default value \n * @return attribute value\n*/\nexport function getlineStringAttr(frpr:Element, attr:string):string{\n    let attrEle = frpr.getInnerElements(attr), value;\n\n    if(attrEle!=null && attrEle.length>0){\n        if(attr==\"b\" || attr==\"i\" || attr==\"strike\"){\n            value = \"1\";\n        }\n        else if(attr==\"u\"){\n            let v = attrEle[0].attributeList.val;\n            if(v==\"double\"){\n                value =  \"2\";\n            }\n            else if(v==\"singleAccounting\"){\n                value =  \"3\";\n            }\n            else if(v==\"doubleAccounting\"){\n                value =  \"4\";\n            }\n            else{\n                value = \"1\";\n            }\n        }\n        else if(attr==\"vertAlign\"){\n            let v = attrEle[0].attributeList.val;\n            if(v==\"subscript\"){\n                value = \"1\";\n            }\n            else if(v==\"superscript\"){\n                value = \"2\";\n            }\n        }\n        else{\n            value = attrEle[0].attributeList.val;\n        }\n        \n    }\n\n    return value;\n}","import { ILuckyFile, ILuckyFileInfo,IluckySheet,IluckySheetCelldata,IluckySheetConfig,IluckySheetCelldataValue,IluckySheetCelldataValueMerge,ILuckySheetCellFormat,IluckySheetConfigMerges,IluckySheetConfigMerge,IMapluckySheetborderInfoCellForImp,IluckySheetborderInfoCellValue,IluckySheetborderInfoCellValueStyle,IluckySheetborderInfoCellForImp,IluckySheetRowAndColumnLen,IluckySheetRowAndColumnHidden,IluckySheetSelection,IluckysheetFrozen,IluckySheetChart,IluckySheetPivotTable,IluckysheetConditionFormat,IluckysheetCalcChain,ILuckyInlineString,IluckyImage,IluckyImageBorder,IluckyImageCrop,IluckyImageDefault,IluckyImages, IluckysheetHyperlink, IluckysheetDataVerification} from \"./ILuck\";\n\n\n\nexport class LuckyFileBase implements ILuckyFile {\n    info:ILuckyFileInfo\n    sheets:IluckySheet[]\n}\n\nexport class LuckySheetBase implements IluckySheet{\n    name:string\n    color:string\n    config:IluckySheetConfig\n    index:string\n    status:string\n    order:string\n    row:number\n    column:number\n    luckysheet_select_save:IluckySheetSelection[]\n    scrollLeft:number\n    scrollTop:number\n    zoomRatio:number\n    showGridLines:string\n    defaultColWidth:number\n    defaultRowHeight:number\n\n    celldata:IluckySheetCelldata[]\n    chart:IluckySheetChart[]\n\n    isPivotTable:boolean\n    pivotTable:IluckySheetPivotTable\n\n    luckysheet_conditionformat_save:IluckysheetConditionFormat[]\n    freezen:IluckysheetFrozen\n\n    calcChain:IluckysheetCalcChain[]\n\n    images:IluckyImages\n    \n    dataVerification: IluckysheetDataVerification;\n    hyperlink: IluckysheetHyperlink\n    hide: number;\n    \n}\n\nexport class LuckyFileInfo implements ILuckyFileInfo{\n    name:string\n    creator:string\n    lastmodifiedby:string\n    createdTime:string\n    modifiedTime:string\n    company:string\n    appversion:string\n}\n\nexport class LuckySheetCelldataBase implements IluckySheetCelldata{\n    r:number\n    c:number\n    v:IluckySheetCelldataValue | string | null\n}\n\nexport class LuckySheetCelldataValue implements IluckySheetCelldataValue{\n    ct: LuckySheetCellFormat | undefined //celltype,Cell value format: text, time, etc. numfmts\n    bg: string | undefined//background,#fff000,\tfill\n    ff: string | undefined//fontfamily, fonts\n    fc: string | undefined//fontcolor fonts\n    bl: number | undefined//Bold, fonts\n    it: number | undefined//italic, fonts\n    fs: number | undefined//font size, fonts\n    cl: number | undefined//strike, 0 Regular, 1 strikes, fonts\n    un: number | undefined//underline, 0 Regular, 1 underlines, fonts\n    vt: number | undefined//Vertical alignment, 0 middle, 1 up, 2 down, alignment\n    ht: number | undefined//Horizontal alignment,0 center, 1 left, 2 right, alignment\n    mc: IluckySheetCelldataValueMerge | undefined //Merge Cells, mergeCells\n    tr: number | undefined //Text rotation,0: 0、3 Vertical text alignment\n    tb: number | undefined //Text wrap,0 truncation, 1 overflow, 2 word wrap, alignment\n    v: string | undefined //Original value, v\n    m: string | undefined //Display value, v\n    f: string | undefined //formula, f\n    rt:number | undefined //text rotation angle 0-180 alignment\n    qp:number | undefined //quotePrefix, show number as string\n    ti:number | undefined //text indent\n}\n\n\nexport class LuckySheetCellFormat implements ILuckySheetCellFormat {\n    fa:string\n    t:string\n    s:LuckyInlineString[] | undefined\n}\n\nexport class LuckyInlineString implements ILuckyInlineString {\n    ff:string | undefined //font family\n    fc:string | undefined//font color\n    fs:number | undefined//font size\n    cl:number | undefined//strike\n    un:number | undefined//underline\n    bl:number | undefined//blod\n    it:number | undefined//italic\n    va:number | undefined//1sub and 2super and 0none\n    v:string | undefined\n}\n\nexport class LuckyConfig implements IluckySheetConfig{\n    merge:IluckySheetConfigMerges\n    borderInfo:IluckySheetborderInfoCellForImp[]\n    // _borderInfo: IMapluckySheetborderInfoCellForImp\n    rowlen:IluckySheetRowAndColumnLen\n    columnlen:IluckySheetRowAndColumnLen\n    rowhidden:IluckySheetRowAndColumnHidden\n    colhidden:IluckySheetRowAndColumnHidden\n\n    customHeight:IluckySheetRowAndColumnHidden\n    customWidth:IluckySheetRowAndColumnHidden\n}\n\nexport class LuckySheetborderInfoCellForImp implements IluckySheetborderInfoCellForImp{\n    rangeType:string\n    // cells:string[]\n    value:IluckySheetborderInfoCellValue\n}\n\nexport class LuckySheetborderInfoCellValue implements IluckySheetborderInfoCellValue{\n    row_index: number\n    col_index: number\n    l: IluckySheetborderInfoCellValueStyle\n    r: IluckySheetborderInfoCellValueStyle\n    t: IluckySheetborderInfoCellValueStyle\n    b: IluckySheetborderInfoCellValueStyle\n}\n\nexport class LuckySheetborderInfoCellValueStyle implements IluckySheetborderInfoCellValueStyle{\n    \"style\": number\n    \"color\": string\n}\n\nexport class LuckySheetConfigMerge implements IluckySheetConfigMerge{\n    r: number\n    c: number\n    rs: number\n    cs: number\n}\n\nexport class LuckysheetCalcChain implements IluckysheetCalcChain{\n    r:number\n    c:number\n    index:string | undefined\n}\n\n\nexport class LuckyImageBase implements IluckyImage{\n    border: IluckyImageBorder\n    crop: IluckyImageCrop\n    default: IluckyImageDefault\n\n    fixedLeft: number\n    fixedTop: number\n    isFixedPos: Boolean\n    originHeight: number\n    originWidth: number\n    src: string\n    type: string\n}","import { IluckySheetborderInfoCellForImp,IluckySheetCelldataValue,IluckySheetCelldataValueMerge,ILuckySheetCellFormat } from \"./ILuck\";\nimport { ReadXml, Element, IStyleCollections,getColor,getlineStringAttr } from \"./ReadXml\";\nimport {getXmlAttibute, getColumnWidthPixel, getRowHeightPixel,getcellrange, escapeCharacter, isChinese, isJapanese, isKoera,isContainMultiType} from \"../common/method\";\nimport { ST_CellType, indexedColors, OEM_CHARSET,borderTypes,fontFamilys } from \"../common/constant\"\nimport { IattributeList, stringToNum } from \"../ICommon\";\nimport { LuckySheetborderInfoCellValueStyle,LuckySheetborderInfoCellForImp,LuckySheetborderInfoCellValue,LuckySheetCelldataBase,LuckySheetCelldataValue,LuckySheetCellFormat,LuckyInlineString } from \"./LuckyBase\";\n\nexport class LuckySheetCelldata extends LuckySheetCelldataBase{\n    _borderObject:IluckySheetborderInfoCellForImp\n    _fomulaRef:string\n    _formulaSi:string\n    _formulaType:string\n\n    private sheetFile:string\n    private readXml:ReadXml\n    private cell:Element\n    private styles:IStyleCollections\n    private sharedStrings:Element[]\n    private mergeCells:Element[]\n\n    constructor(cell:Element, styles:IStyleCollections, sharedStrings:Element[], mergeCells:Element[], sheetFile:string, ReadXml:ReadXml){\n        //Private\n        super();\n        this.cell = cell;\n        this.sheetFile = sheetFile;\n        this.styles = styles;\n        this.sharedStrings = sharedStrings;\n        this.readXml = ReadXml;\n        this.mergeCells = mergeCells;\n\n        let attrList = cell.attributeList;\n        let r = attrList.r, s = attrList.s, t = attrList.t;\n        let range = getcellrange(r);\n\n        this.r = range.row[0];\n        this.c = range.column[0];\n        this.v = this.generateValue(s, t);\n\n    }\n\n    /**\n    * @param s Style index ,start 1\n    * @param t Cell type, Optional value is ST_CellType, it's found at constat.ts\n    */\n    private generateValue(s:string, t:string){\n        let v = this.cell.getInnerElements(\"v\");\n        let f = this.cell.getInnerElements(\"f\");\n\n        if(v==null){\n            v = this.cell.getInnerElements(\"t\");\n        }\n\n        let cellXfs = this.styles[\"cellXfs\"] as Element[];\n        let cellStyleXfs = this.styles[\"cellStyleXfs\"] as Element[];\n        let cellStyles = this.styles[\"cellStyles\"] as Element[];\n        let fonts = this.styles[\"fonts\"] as Element[];\n        let fills = this.styles[\"fills\"] as Element[];\n        let borders = this.styles[\"borders\"] as Element[];\n        let numfmts = this.styles[\"numfmts\"] as IattributeList;\n        let clrScheme = this.styles[\"clrScheme\"] as Element[];\n\n        let sharedStrings = this.sharedStrings;\n        let cellValue = new LuckySheetCelldataValue();\n\n        if(f!=null){\n            let formula = f[0], attrList = formula.attributeList;\n            let t = attrList.t, ref = attrList.ref, si = attrList.si;\n            let formulaValue =f[0].value;\n            if(t==\"shared\"){\n                this._fomulaRef = ref;\n                this._formulaType = t;\n                this._formulaSi = si;\n            }\n            // console.log(ref, t, si);\n            if(ref!=null || (formulaValue!=null && formulaValue.length>0)){\n                formulaValue = escapeCharacter(formulaValue);\n                cellValue.f = \"=\" + formulaValue;\n            }\n\n        }\n\n        let familyFont = null;\n        let quotePrefix;\n        if(s!=null){\n            let sNum = parseInt(s);\n            let cellXf = cellXfs[sNum];\n            let xfId = cellXf.attributeList.xfId;\n\n            let numFmtId,fontId,fillId,borderId;\n            let horizontal,vertical, wrapText, textRotation, shrinkToFit, indent,applyProtection;\n\n            if(xfId!=null){\n                let cellStyleXf = cellStyleXfs[parseInt(xfId)];\n                let attrList = cellStyleXf.attributeList;\n\n                let applyNumberFormat = attrList.applyNumberFormat;\n                let applyFont = attrList.applyFont;\n                let applyFill = attrList.applyFill;\n                let applyBorder = attrList.applyBorder;\n                let applyAlignment = attrList.applyAlignment;\n                // let applyProtection = attrList.applyProtection;\n\n                applyProtection = attrList.applyProtection;\n                quotePrefix = attrList.quotePrefix;\n\n                if(applyNumberFormat!=\"0\" && attrList.numFmtId!=null){\n                    // if(attrList.numFmtId!=\"0\"){\n                        numFmtId = attrList.numFmtId;\n                    // }\n                }\n                if(applyFont!=\"0\" && attrList.fontId!=null){\n                    fontId = attrList.fontId;\n                }\n                if(applyFill!=\"0\" && attrList.fillId!=null){\n                    fillId = attrList.fillId;\n                }\n                if(applyBorder!=\"0\" && attrList.borderId!=null){\n                    borderId = attrList.borderId;\n                }\n                if(applyAlignment!=null && applyAlignment!=\"0\"){\n                    let alignment = cellStyleXf.getInnerElements(\"alignment\");\n                    if(alignment!=null){\n                        let attrList = alignment[0].attributeList;\n                        if(attrList.horizontal!=null){\n                            horizontal = attrList.horizontal;\n                        }\n                        if(attrList.vertical!=null){\n                            vertical = attrList.vertical;\n                        }\n                        if(attrList.wrapText!=null){\n                            wrapText = attrList.wrapText;\n                        }\n                        if(attrList.textRotation!=null){\n                            textRotation = attrList.textRotation;\n                        }\n                        if(attrList.shrinkToFit!=null){\n                            shrinkToFit = attrList.shrinkToFit;\n                        }\n                        if(attrList.indent!=null){\n                            indent = attrList.indent;\n                        }\n                    }\n                }\n            }\n\n            let applyNumberFormat = cellXf.attributeList.applyNumberFormat;\n            let applyFont = cellXf.attributeList.applyFont;\n            let applyFill = cellXf.attributeList.applyFill;\n            let applyBorder = cellXf.attributeList.applyBorder;\n            let applyAlignment = cellXf.attributeList.applyAlignment;\n\n            if(cellXf.attributeList.applyProtection!=null){\n                applyProtection = cellXf.attributeList.applyProtection;\n            }\n\n            if(cellXf.attributeList.quotePrefix!=null){\n                quotePrefix = cellXf.attributeList.quotePrefix;\n            }\n\n            if(applyNumberFormat!=\"0\" && cellXf.attributeList.numFmtId!=null){\n                numFmtId = cellXf.attributeList.numFmtId;\n            }\n            if(applyFont!=\"0\"){\n                fontId = cellXf.attributeList.fontId;\n            }\n            if(applyFill!=\"0\"){\n                fillId = cellXf.attributeList.fillId;\n            }\n            if(applyBorder!=\"0\"){\n                borderId =cellXf.attributeList.borderId;\n            }\n            if(applyAlignment!=\"0\"){\n                let alignment = cellXf.getInnerElements(\"alignment\");\n                if(alignment!=null && alignment.length>0){\n                    let attrList = alignment[0].attributeList;\n                    if(attrList.horizontal!=null){\n                        horizontal = attrList.horizontal;\n                    }\n                    if(attrList.vertical!=null){\n                        vertical = attrList.vertical;\n                    }\n                    if(attrList.wrapText!=null){\n                        wrapText = attrList.wrapText;\n                    }\n                    if(attrList.textRotation!=null){\n                        textRotation = attrList.textRotation;\n                    }\n                    if(attrList.shrinkToFit!=null){\n                        shrinkToFit = attrList.shrinkToFit;\n                    }\n                    if(attrList.indent!=null){\n                        indent = attrList.indent;\n                    }\n                }\n            }\n\n\n\n            if(numFmtId!=undefined){\n                let numf = numfmts[parseInt(numFmtId)];\n                let cellFormat = new LuckySheetCellFormat();\n                cellFormat.fa = escapeCharacter(numf);\n                // console.log(numf, numFmtId, this.v);\n                cellFormat.t = t || 'n';\n                cellValue.ct = cellFormat;\n            }\n\n            if(fillId!=undefined){\n                let fillIdNum = parseInt(fillId);\n                let fill  = fills[fillIdNum];\n                // console.log(cellValue.v);\n                let bg = this.getBackgroundByFill(fill, clrScheme);\n                if(bg!=null){\n                    cellValue.bg = bg;\n                }\n            }\n\n\n            if(fontId!=undefined){\n                let fontIdNum = parseInt(fontId);\n                let font = fonts[fontIdNum];\n                if(font!=null){\n                    let sz = font.getInnerElements(\"sz\");//font size\n                    let colors = font.getInnerElements(\"color\");//font color\n                    let family = font.getInnerElements(\"name\");//font family\n                    let familyOverrides = font.getInnerElements(\"family\");//font family will be overrided by name\n                    let charset = font.getInnerElements(\"charset\");//font charset\n                    let bolds = font.getInnerElements(\"b\");//font bold\n                    let italics = font.getInnerElements(\"i\");//font italic\n                    let strikes = font.getInnerElements(\"strike\");//font italic\n                    let underlines = font.getInnerElements(\"u\");//font italic\n\n                    if(sz!=null && sz.length>0){\n                        let fs = sz[0].attributeList.val;\n                        if(fs!=null){\n                            cellValue.fs = parseInt(fs);\n                        }\n\n                    }\n\n                    if(colors!=null && colors.length>0){\n                        let color = colors[0];\n                        let fc = getColor(color, this.styles, \"t\");\n                        if(fc!=null){\n                            cellValue.fc = fc;\n                        }\n                    }\n\n\n                    if(familyOverrides!=null && familyOverrides.length>0){\n                        let val = familyOverrides[0].attributeList.val;\n                        if(val!=null){\n                            familyFont = fontFamilys[val];\n                        }\n                    }\n\n                    if(family!=null && family.length>0){\n                        let val = family[0].attributeList.val;\n                        if(val!=null){\n                            cellValue.ff = val;\n                        }\n                    }\n\n\n                    if(bolds!=null && bolds.length>0){\n                        let bold = bolds[0].attributeList.val;\n                        if(bold==\"0\"){\n                            cellValue.bl =  0;\n                        }\n                        else{\n                            cellValue.bl =  1;\n                        }\n                    }\n\n                    if(italics!=null && italics.length>0){\n                        let italic = italics[0].attributeList.val;\n                        if(italic==\"0\"){\n                            cellValue.it =  0;\n                        }\n                        else{\n                            cellValue.it =  1;\n                        }\n                    }\n\n                    if(strikes!=null && strikes.length>0){\n                        let strike = strikes[0].attributeList.val;\n                        if(strike==\"0\"){\n                            cellValue.cl =  0;\n                        }\n                        else{\n                            cellValue.cl =  1;\n                        }\n                    }\n\n                    if(underlines!=null && underlines.length>0){\n                        let underline = underlines[0].attributeList.val;\n                        if(underline==\"single\"){\n                            cellValue.un =  1;\n                        }\n                        else if(underline==\"double\"){\n                            cellValue.un =  2;\n                        }\n                        else if(underline==\"singleAccounting\"){\n                            cellValue.un =  3;\n                        }\n                        else if(underline==\"doubleAccounting\"){\n                            cellValue.un =  4;\n                        }\n                        else{\n                            cellValue.un =  0;\n                        }\n                    }\n                }\n            }\n\n            // vt: number | undefined//Vertical alignment, 0 middle, 1 up, 2 down, alignment\n            // ht: number | undefined//Horizontal alignment,0 center, 1 left, 2 right, alignment\n            // tr: number | undefined //Text rotation,0: 0、1: 45 、2: -45、3 Vertical text、4: 90 、5: -90, alignment\n            // tb: number | undefined //Text wrap,0 truncation, 1 overflow, 2 word wrap, alignment\n\n            if(horizontal!=undefined){//Horizontal alignment\n                if(horizontal==\"center\"){\n                    cellValue.ht = 0;\n                }\n                else if(horizontal==\"centerContinuous\"){\n                    cellValue.ht = 0;//luckysheet unsupport\n                }\n                else if(horizontal==\"left\"){\n                    cellValue.ht = 1;\n                }\n                else if(horizontal==\"right\"){\n                    cellValue.ht = 2;\n                }\n                else if(horizontal==\"distributed\"){\n                    cellValue.ht = 0;//luckysheet unsupport\n                }\n                else if(horizontal==\"fill\"){\n                    cellValue.ht = 1;//luckysheet unsupport\n                }\n                else if(horizontal==\"general\"){\n                    cellValue.ht = 1;//luckysheet unsupport\n                }\n                else if(horizontal==\"justify\"){\n                    cellValue.ht = 0;//luckysheet unsupport\n                }\n                else{\n                    cellValue.ht = 1;\n                }\n            }\n\n            if(vertical!=undefined){//Vertical alignment\n                if(vertical==\"bottom\"){\n                    cellValue.vt = 2;\n                }\n                else if(vertical==\"center\"){\n                    cellValue.vt = 0;\n                }\n                else if(vertical==\"distributed\"){\n                    cellValue.vt = 0;//luckysheet unsupport\n                }\n                else if(vertical==\"justify\"){\n                    cellValue.vt = 0;//luckysheet unsupport\n                }\n                else if(vertical==\"top\"){\n                    cellValue.vt = 1;\n                }\n                else{\n                    cellValue.vt = 1;\n                }\n            }\n            else {\n                //sometimes bottom style is lost after setting it in excel\n                //when vertical is undefined set it to 2.\n                cellValue.vt = 2;\n            }\n\n            if(wrapText!=undefined){\n                if(wrapText==\"1\"){\n                    cellValue.tb = 2;\n                }\n                else{\n                    cellValue.tb = 1;\n                }\n            }\n            else{\n                cellValue.tb = 1;\n            }\n\n            if(textRotation!=undefined){\n                // tr: number | undefined //Text rotation,0: 0、1: 45 、2: -45、3 Vertical text、4: 90 、5: -90, alignment\n                if(textRotation==\"255\"){\n                    cellValue.tr = 3;\n                }\n                // else if(textRotation==\"45\"){\n                //     cellValue.tr = 1;\n                // }\n                // else if(textRotation==\"90\"){\n                //     cellValue.tr = 4;\n                // }\n                // else if(textRotation==\"135\"){\n                //     cellValue.tr = 2;\n                // }\n                // else if(textRotation==\"180\"){\n                //     cellValue.tr = 5;\n                // }\n                else{\n                    cellValue.tr = 0;\n                    cellValue.rt =  parseInt(textRotation);\n                }\n\n\n            }\n\n            if(shrinkToFit!=undefined){//luckysheet unsupport\n\n            }\n\n            if(indent!=undefined){//luckysheet unsupport\n                const result = parseInt(indent)\n                if (!isNaN(result)) {\n                    cellValue.ti = result\n                }\n            }\n\n            if(borderId!=undefined){\n                let borderIdNum = parseInt(borderId);\n                let border = borders[borderIdNum];\n                // this._borderId = borderIdNum;\n\n                let borderObject = new LuckySheetborderInfoCellForImp();\n                borderObject.rangeType = \"cell\";\n                // borderObject.cells = [];\n                let borderCellValue = new LuckySheetborderInfoCellValue();\n\n                borderCellValue.row_index = this.r;\n                borderCellValue.col_index = this.c;\n\n                let lefts = border.getInnerElements(\"left\");\n                let rights = border.getInnerElements(\"right\");\n                let tops = border.getInnerElements(\"top\");\n                let bottoms = border.getInnerElements(\"bottom\");\n                let diagonals = border.getInnerElements(\"diagonal\");\n\n                let starts = border.getInnerElements(\"start\");\n                let ends = border.getInnerElements(\"end\");\n\n                let left = this.getBorderInfo(lefts);\n                let right = this.getBorderInfo(rights);\n                let top = this.getBorderInfo(tops);\n                let bottom = this.getBorderInfo(bottoms);\n                let diagonal = this.getBorderInfo(diagonals);\n\n                let start = this.getBorderInfo(starts);\n                let end = this.getBorderInfo(ends);\n\n                let isAdd = false;\n\n                if(start!=null && start.color!=null){\n                    borderCellValue.l = start;\n                    isAdd = true;\n                }\n\n                if(end!=null && end.color!=null){\n                    borderCellValue.r = end;\n                    isAdd = true;\n                }\n\n                if(left!=null && left.color!=null){\n                    borderCellValue.l = left;\n                    isAdd = true;\n                }\n\n                if(right!=null && right.color!=null){\n                    borderCellValue.r = right;\n                    isAdd = true;\n                }\n\n                if(top!=null && top.color!=null){\n                    borderCellValue.t = top;\n                    isAdd = true;\n                }\n\n                if(bottom!=null && bottom.color!=null){\n                    borderCellValue.b = bottom;\n                    isAdd = true;\n                }\n\n                if(isAdd){\n                    borderObject.value = borderCellValue;\n                    // this.config._borderInfo[borderId] = borderObject;\n                    this._borderObject = borderObject;\n                }\n            }\n\n        }\n        else{\n            cellValue.tb = 1;\n        }\n\n        if(v!=null){\n            let value =v[0].value;\n\n            if(/&#\\d+;/.test(value)){\n                value = this.htmlDecode(value);\n            }\n\n            if(t==ST_CellType[\"SharedString\"]){\n                let siIndex = parseInt(v[0].value);\n                let sharedSI = sharedStrings[siIndex];\n\n                let rFlag = sharedSI.getInnerElements(\"r\");\n                if(rFlag==null){\n                    let tFlag = sharedSI.getInnerElements(\"t\");\n                    if(tFlag!=null){\n                        let text = \"\";\n                        tFlag.forEach((t)=>{\n                            text += t.value;\n                        });\n\n                        text = escapeCharacter(text);\n\n                        //isContainMultiType(text) &&\n                        if(familyFont==\"Roman\" && text.length>0){\n                            let textArray = text.split(\"\");\n                            let preWordType:string = null, wordText=\"\", preWholef:string=null;\n                            let wholef = \"Times New Roman\";\n                            if(cellValue.ff!=null){\n                                wholef = cellValue.ff;\n                            }\n\n                            let cellFormat = cellValue.ct;\n                            if(cellFormat==null){\n                                cellFormat = new LuckySheetCellFormat();\n                            }\n\n                            if(cellFormat.s==null){\n                                cellFormat.s = [];\n                            }\n\n                            for(let i=0;i<textArray.length;i++){\n                                let w = textArray[i];\n                                let type:string = null, ff=wholef;\n\n                                if(isChinese(w)){\n                                    type = \"c\";\n                                    ff=\"宋体\";\n                                }\n                                else if(isJapanese(w)){\n                                    type = \"j\";\n                                    ff=\"Yu Gothic\";\n                                }\n                                else if(isKoera(w)){\n                                    type = \"k\";\n                                    ff=\"Malgun Gothic\";\n                                }\n                                else{\n                                    type = \"e\";\n                                }\n\n                                if((type!=preWordType && preWordType!=null) || i==textArray.length-1){\n                                    let InlineString = new LuckyInlineString();\n\n                                    InlineString.ff = preWholef;\n\n                                    if(cellValue.fc!=null){\n                                        InlineString.fc = cellValue.fc;\n                                    }\n\n                                    if(cellValue.fs!=null){\n                                        InlineString.fs = cellValue.fs;\n                                    }\n\n                                    if(cellValue.cl!=null){\n                                        InlineString.cl = cellValue.cl;\n                                    }\n\n                                    if(cellValue.un!=null){\n                                        InlineString.un = cellValue.un;\n                                    }\n\n                                    if(cellValue.bl!=null){\n                                        InlineString.bl = cellValue.bl;\n                                    }\n\n                                    if(cellValue.it!=null){\n                                        InlineString.it = cellValue.it;\n                                    }\n\n                                    if(i==textArray.length-1){\n                                        if(type==preWordType){\n                                            InlineString.ff = ff;\n                                            InlineString.v = wordText + w;\n                                        }\n                                        else{\n                                            InlineString.ff = preWholef;\n                                            InlineString.v = wordText;\n                                            cellFormat.s.push(InlineString);\n\n                                            let InlineStringLast = new LuckyInlineString();\n                                            InlineStringLast.ff = ff;\n                                            InlineStringLast.v = w;\n                                            if(cellValue.fc!=null){\n                                                InlineStringLast.fc = cellValue.fc;\n                                            }\n\n                                            if(cellValue.fs!=null){\n                                                InlineStringLast.fs = cellValue.fs;\n                                            }\n\n                                            if(cellValue.cl!=null){\n                                                InlineStringLast.cl = cellValue.cl;\n                                            }\n\n                                            if(cellValue.un!=null){\n                                                InlineStringLast.un = cellValue.un;\n                                            }\n\n                                            if(cellValue.bl!=null){\n                                                InlineStringLast.bl = cellValue.bl;\n                                            }\n\n                                            if(cellValue.it!=null){\n                                                InlineStringLast.it = cellValue.it;\n                                            }\n                                            cellFormat.s.push(InlineStringLast);\n\n                                            break;\n                                        }\n                                    }\n                                    else{\n                                        InlineString.v = wordText;\n                                    }\n\n\n                                    cellFormat.s.push(InlineString);\n\n                                    wordText = w;\n                                }\n                                else{\n                                    wordText += w;\n                                }\n\n\n                                preWordType = type;\n                                preWholef = ff;\n                            }\n\n                            cellFormat.t = \"inlineStr\";\n                            // cellFormat.s = [InlineString];\n                            cellValue.ct = cellFormat;\n                            // console.log(cellValue);\n                        }\n                        else{\n\n\n                            text = this.replaceSpecialWrap(text);\n\n                            if(text.indexOf(\"\\r\\n\")>-1 || text.indexOf(\"\\n\")>-1){\n                                let InlineString = new LuckyInlineString();\n                                InlineString.v = text;\n                                let cellFormat = cellValue.ct;\n                                if(cellFormat==null){\n                                    cellFormat = new LuckySheetCellFormat();\n                                }\n\n                                if(cellValue.ff!=null){\n                                    InlineString.ff = cellValue.ff;\n                                }\n\n                                if(cellValue.fc!=null){\n                                    InlineString.fc = cellValue.fc;\n                                }\n\n                                if(cellValue.fs!=null){\n                                    InlineString.fs = cellValue.fs;\n                                }\n\n                                if(cellValue.cl!=null){\n                                    InlineString.cl = cellValue.cl;\n                                }\n\n                                if(cellValue.un!=null){\n                                    InlineString.un = cellValue.un;\n                                }\n\n                                if(cellValue.bl!=null){\n                                    InlineString.bl = cellValue.bl;\n                                }\n\n                                if(cellValue.it!=null){\n                                    InlineString.it = cellValue.it;\n                                }\n\n                                cellFormat.t = \"inlineStr\";\n                                cellFormat.s = [InlineString];\n                                cellValue.ct = cellFormat;\n                            }\n                            else{\n                                cellValue.v = text;\n                                quotePrefix = \"1\";\n                            }\n                        }\n\n                    }\n                }\n                else{\n                    let styles:LuckyInlineString[] = [];\n                    rFlag.forEach((r)=>{\n                        let tFlag = r.getInnerElements(\"t\");\n                        let rPr = r.getInnerElements(\"rPr\");\n\n                        let InlineString = new LuckyInlineString();\n\n                        if(tFlag!=null && tFlag.length>0){\n                            let text = tFlag[0].value;\n                            text = this.replaceSpecialWrap(text);\n                            text = escapeCharacter(text);\n                            InlineString.v = text;\n                        }\n\n                        if(rPr!=null && rPr.length>0){\n                            let frpr = rPr[0];\n                            let sz = getlineStringAttr(frpr,\"sz\"), rFont=getlineStringAttr(frpr,\"rFont\"), family=getlineStringAttr(frpr,\"family\"), charset=getlineStringAttr(frpr,\"charset\"), scheme=getlineStringAttr(frpr,\"scheme\"), b=getlineStringAttr(frpr,\"b\"), i=getlineStringAttr(frpr,\"i\"), u=getlineStringAttr(frpr,\"u\"), strike=getlineStringAttr(frpr,\"strike\"), vertAlign=getlineStringAttr(frpr,\"vertAlign\"), color;\n\n\n                            let cEle = frpr.getInnerElements(\"color\");\n                            if(cEle!=null && cEle.length>0){\n                                color = getColor(cEle[0],this.styles, \"t\");\n                            }\n\n\n                            let ff;\n                            // if(family!=null){\n                            //     ff = fontFamilys[family];\n                            // }\n                            if(rFont!=null){\n                                ff = rFont;\n                            }\n                            if(ff!=null){\n                                InlineString.ff = ff;\n                            }\n                            else if(cellValue.ff!=null){\n                                InlineString.ff = cellValue.ff;\n                            }\n\n                            if(color!=null){\n                                InlineString.fc = color;\n                            }\n                            else if(cellValue.fc!=null){\n                                InlineString.fc = cellValue.fc;\n                            }\n\n                            if(sz!=null){\n                                InlineString.fs = parseInt(sz);\n                            }\n                            else if(cellValue.fs!=null){\n                                InlineString.fs = cellValue.fs;\n                            }\n\n                            if(strike!=null){\n                                InlineString.cl = parseInt(strike);\n                            }\n                            else if(cellValue.cl!=null){\n                                InlineString.cl = cellValue.cl;\n                            }\n\n                            if(u!=null){\n                                InlineString.un = parseInt(u);\n                            }\n                            else if(cellValue.un!=null){\n                                InlineString.un = cellValue.un;\n                            }\n\n                            if(b!=null){\n                                InlineString.bl = parseInt(b);\n                            }\n                            else if(cellValue.bl!=null){\n                                InlineString.bl = cellValue.bl;\n                            }\n\n                            if(i!=null){\n                                InlineString.it = parseInt(i);\n                            }\n                            else if(cellValue.it!=null){\n                                InlineString.it = cellValue.it;\n                            }\n\n                            if(vertAlign!=null){\n                                InlineString.va = parseInt(vertAlign);\n                            }\n\n\n                            // ff:string | undefined //font family\n                            // fc:string | undefined//font color\n                            // fs:number | undefined//font size\n                            // cl:number | undefined//strike\n                            // un:number | undefined//underline\n                            // bl:number | undefined//blod\n                            // it:number | undefined//italic\n                            // v:string | undefined\n                        }\n                        else{\n                            if(InlineString.ff==null && cellValue.ff!=null){\n                                InlineString.ff = cellValue.ff;\n                            }\n\n                            if(InlineString.fc==null && cellValue.fc!=null){\n                                InlineString.fc = cellValue.fc;\n                            }\n\n                            if(InlineString.fs==null && cellValue.fs!=null){\n                                InlineString.fs = cellValue.fs;\n                            }\n\n                            if(InlineString.cl==null && cellValue.cl!=null){\n                                InlineString.cl = cellValue.cl;\n                            }\n\n                            if(InlineString.un==null && cellValue.un!=null){\n                                InlineString.un = cellValue.un;\n                            }\n\n                            if(InlineString.bl==null && cellValue.bl!=null){\n                                InlineString.bl = cellValue.bl;\n                            }\n\n                            if(InlineString.it==null && cellValue.it!=null){\n                                InlineString.it = cellValue.it;\n                            }\n                        }\n\n\n                        styles.push(InlineString);\n                    });\n\n                    let cellFormat = cellValue.ct;\n                    if(cellFormat==null){\n                        cellFormat = new LuckySheetCellFormat();\n                    }\n                    cellFormat.t = \"inlineStr\";\n                    cellFormat.s = styles;\n                    cellValue.ct = cellFormat;\n                }\n            }\n            // to be confirmed\n            else if(t==ST_CellType[\"InlineString\"] && v!=null){\n                cellValue.v = \"'\"+ value;\n            }\n            else {\n                value = escapeCharacter(value);\n                cellValue.v = value;\n            }\n        }\n\n        if(quotePrefix!=null){\n            cellValue.qp = parseInt(quotePrefix);\n        }\n\n        return cellValue;\n\n    }\n\n    private replaceSpecialWrap(text:string):string{\n        text = text.replace(/_x000D_/g, \"\").replace(/&#13;&#10;/g, \"\\r\\n\").replace(/&#13;/g, \"\\r\").replace(/&#10;/g, \"\\n\");\n        return text;\n    }\n\n\n    private getBackgroundByFill(fill:Element, clrScheme:Element[]):string|null{\n        let patternFills = fill.getInnerElements(\"patternFill\");\n        if(patternFills!=null){\n            let patternFill = patternFills[0];\n            let fgColors = patternFill.getInnerElements(\"fgColor\");\n            let bgColors = patternFill.getInnerElements(\"bgColor\");\n            let fg, bg;\n            if(fgColors!=null){\n                let fgColor = fgColors[0];\n                fg = getColor(fgColor, this.styles);\n            }\n\n            if(bgColors!=null){\n                let bgColor = bgColors[0];\n                bg = getColor(bgColor, this.styles);\n            }\n            // console.log(fgColors,bgColors,clrScheme);\n            if(fg!=null){\n                return fg;\n            }\n            else if(bg!=null){\n                return bg;\n            }\n        }\n        else{\n            let gradientfills = fill.getInnerElements(\"gradientFill\");\n            if(gradientfills!=null){\n                //graient color fill handler\n\n                return null;\n            }\n        }\n    }\n\n    private getBorderInfo(borders:Element[]):LuckySheetborderInfoCellValueStyle{\n        if(borders==null){\n            return null;\n        }\n\n        let border = borders[0], attrList = border.attributeList;\n        let clrScheme = this.styles[\"clrScheme\"] as Element[];\n        let style:string = attrList.style;\n        if(style==null || style==\"none\"){\n            return null;\n        }\n\n        let colors = border.getInnerElements(\"color\");\n        let colorRet = \"#000000\";\n        if(colors!=null){\n            let color = colors[0];\n            colorRet = getColor(color, this.styles, \"b\");\n            if(colorRet==null){\n                colorRet = \"#000000\";\n            }\n        }\n\n        let ret = new LuckySheetborderInfoCellValueStyle();\n        ret.style = borderTypes[style];\n        ret.color = colorRet;\n\n        return ret;\n    }\n\n    private htmlDecode (str:string):string {\n        return str.replace(/&#(x)?([^&]{1,5});/g,function($,$1,$2) {\n            return String.fromCharCode(parseInt($2 , $1 ? 16:10));\n        });\n    };\n\n}\n\n","﻿import { IluckyImageBorder,IluckyImageCrop,IluckyImageDefault,IluckyImages,IluckySheetCelldata,IluckySheetCelldataValue,IMapluckySheetborderInfoCellForImp,IluckySheetborderInfoCellValue,IluckySheetborderInfoCellValueStyle,IFormulaSI,IluckySheetRowAndColumnLen,IluckySheetRowAndColumnHidden,IluckySheetSelection,IcellOtherInfo,IformulaList,IformulaListItem, IluckysheetHyperlink, IluckysheetHyperlinkType, IluckysheetDataVerification} from \"./ILuck\";\nimport {LuckySheetCelldata} from \"./LuckyCell\";\nimport { IattributeList } from \"../ICommon\";\nimport {getXmlAttibute, getColumnWidthPixel, fromulaRef,getRowHeightPixel,getcellrange,generateRandomIndex,getPxByEMUs, getMultiSequenceToNum, getTransR1C1ToSequence, getPeelOffX14, getMultiFormulaValue} from \"../common/method\";\nimport {borderTypes, COMMON_TYPE2, DATA_VERIFICATION_MAP, DATA_VERIFICATION_TYPE2_MAP, worksheetFilePath} from \"../common/constant\";\nimport { ReadXml, IStyleCollections, Element,getColor } from \"./ReadXml\";\nimport { LuckyFileBase,LuckySheetBase,LuckyConfig,LuckySheetborderInfoCellForImp,LuckySheetborderInfoCellValue,LuckysheetCalcChain,LuckySheetConfigMerge } from \"./LuckyBase\";\nimport {ImageList} from \"./LuckyImage\";\nimport dayjs from \"dayjs\";\n\nexport class LuckySheet extends LuckySheetBase {\n\n    private readXml:ReadXml\n    private sheetFile:string\n    private isInitialCell:boolean\n    private styles:IStyleCollections\n    private sharedStrings:Element[]\n    private mergeCells:Element[]\n    private calcChainEles:Element[]\n    private sheetList:IattributeList\n\n    private imageList:ImageList\n\n    private formulaRefList:IFormulaSI\n\n    constructor(sheetName:string, sheetId:string, sheetOrder:number,isInitialCell:boolean=false, allFileOption:any){\n        //Private\n        super();\n        this.isInitialCell = isInitialCell;\n\n        this.readXml = allFileOption.readXml;\n        this.sheetFile = allFileOption.sheetFile;\n        this.styles = allFileOption.styles;\n        this.sharedStrings = allFileOption.sharedStrings;\n        this.calcChainEles = allFileOption.calcChain;\n        this.sheetList = allFileOption.sheetList;\n        this.imageList = allFileOption.imageList;\n        this.hide = allFileOption.hide;\n\n        //Output\n        this.name = sheetName;\n        this.index = sheetId;\n        this.order = sheetOrder.toString();\n        this.config = new LuckyConfig();\n        this.celldata = [];\n        this.mergeCells = this.readXml.getElementsByTagName(\"mergeCells/mergeCell\", this.sheetFile);\n        let clrScheme = this.styles[\"clrScheme\"] as Element[];\n        let sheetView = this.readXml.getElementsByTagName(\"sheetViews/sheetView\", this.sheetFile);\n        let showGridLines = \"1\", tabSelected=\"0\", zoomScale = \"100\", activeCell = \"A1\";\n        if(sheetView.length>0){\n            let attrList = sheetView[0].attributeList;\n            showGridLines = getXmlAttibute(attrList, \"showGridLines\", \"1\");\n            tabSelected = getXmlAttibute(attrList, \"tabSelected\", \"0\");\n            zoomScale = getXmlAttibute(attrList, \"zoomScale\", \"100\");\n            // let colorId = getXmlAttibute(attrList, \"colorId\", \"0\");\n            let selections = sheetView[0].getInnerElements(\"selection\");\n            if(selections!=null && selections.length>0){\n                activeCell = getXmlAttibute(selections[0].attributeList, \"activeCell\", \"A1\");\n                let range:IluckySheetSelection = getcellrange(activeCell, this.sheetList, sheetId);\n                this.luckysheet_select_save = [];\n                this.luckysheet_select_save.push(range);\n            }\n        }\n        this.showGridLines = showGridLines;\n        this.status = tabSelected;\n        this.zoomRatio = parseInt(zoomScale)/100;\n\n        let tabColors = this.readXml.getElementsByTagName(\"sheetPr/tabColor\", this.sheetFile);\n        if(tabColors!=null && tabColors.length>0){\n            let tabColor = tabColors[0], attrList = tabColor.attributeList;\n            // if(attrList.rgb!=null){\n                let tc = getColor(tabColor, this.styles, \"b\");\n                this.color = tc;\n            // }\n        }\n\n        let sheetFormatPr = this.readXml.getElementsByTagName(\"sheetFormatPr\", this.sheetFile);\n        let defaultColWidth, defaultRowHeight;\n        if(sheetFormatPr.length>0){\n            let attrList = sheetFormatPr[0].attributeList;\n            defaultColWidth = getXmlAttibute(attrList, \"defaultColWidth\", \"9.21\");\n            defaultRowHeight = getXmlAttibute(attrList, \"defaultRowHeight\", \"19\");\n        }\n\n        this.defaultColWidth = getColumnWidthPixel(parseFloat(defaultColWidth));\n        this.defaultRowHeight = getRowHeightPixel(parseFloat(defaultRowHeight));\n\n\n        this.generateConfigColumnLenAndHidden();\n        let cellOtherInfo:IcellOtherInfo =  this.generateConfigRowLenAndHiddenAddCell();\n        \n        if(this.calcChain==null){\n            this.calcChain = [];\n        }\n\n        let formulaListExist:IformulaList={};\n        for(let c=0;c<this.calcChainEles.length;c++){\n            let calcChainEle = this.calcChainEles[c], attrList = calcChainEle.attributeList;\n            if(attrList.i!=sheetId){\n                continue;\n            }\n\n            let r = attrList.r , i = attrList.i, l = attrList.l, s = attrList.s, a = attrList.a, t = attrList.t;\n\n            let range = getcellrange(r);\n            let chain = new LuckysheetCalcChain();\n            chain.r = range.row[0];\n            chain.c = range.column[0];\n            chain.index = this.index;\n            this.calcChain.push(chain);\n            formulaListExist[\"r\"+r+\"c\"+c] = null;\n        }\n        \n\n        if(this.formulaRefList!=null){\n            for(let key in this.formulaRefList){\n                let funclist = this.formulaRefList[key];\n                let mainFunc = funclist[\"mainRef\"], mainCellValue = mainFunc.cellValue;\n                let formulaTxt = mainFunc.fv;\n                let mainR = mainCellValue.r, mainC = mainCellValue.c;\n                // let refRange = getcellrange(ref);\n                for(let name in funclist){\n                    if(name == \"mainRef\"){\n                        continue;\n                    }\n\n                    let funcValue = funclist[name], cellValue = funcValue.cellValue;\n                    if(cellValue==null){\n                        continue;\n                    }\n                    let r = cellValue.r, c = cellValue.c;\n\n                    let func = formulaTxt;\n                    let offsetRow = r - mainR, offsetCol = c - mainC;\n\n                    \n                    if(offsetRow > 0){\n                        func = \"=\" + fromulaRef.functionCopy(func, \"down\", offsetRow);\n                    }\n                    else if(offsetRow < 0){\n                        func = \"=\" + fromulaRef.functionCopy(func, \"up\", Math.abs(offsetRow));\n                    }\n\n                    if(offsetCol > 0){\n                        func = \"=\" + fromulaRef.functionCopy(func, \"right\", offsetCol);\n                    }\n                    else if(offsetCol < 0){\n                        func = \"=\" + fromulaRef.functionCopy(func, \"left\", Math.abs(offsetCol));\n                    }\n\n                    // console.log(offsetRow, offsetCol, func);\n\n                    (cellValue.v as IluckySheetCelldataValue ).f = func;\n                    \n                    //添加共享公式链\n                    let chain = new LuckysheetCalcChain();\n                    chain.r = cellValue.r;\n                    chain.c = cellValue.c;\n                    chain.index = this.index;\n                    this.calcChain.push(chain);\n                }\n            }\n        }\n\n\n        //There may be formulas that do not appear in calcChain\n        for(let key in cellOtherInfo.formulaList){\n            if(!(key in formulaListExist)){\n                let formulaListItem = cellOtherInfo.formulaList[key];\n                let chain = new LuckysheetCalcChain();\n                chain.r = formulaListItem.r;\n                chain.c = formulaListItem.c;\n                chain.index = this.index;\n                this.calcChain.push(chain);\n            }\n        }\n      \n        // dataVerification config\n        this.dataVerification = this.generateConfigDataValidations();\n\n        // hyperlink config\n        this.hyperlink = this.generateConfigHyperlinks();\n      \n        // sheet hide\n        this.hide = this.hide;\n\n        if(this.mergeCells!=null){\n            for(let i=0;i<this.mergeCells.length;i++){\n                let merge = this.mergeCells[i], attrList = merge.attributeList;\n                let ref = attrList.ref;\n                if(ref==null){\n                    continue;\n                }\n                let range = getcellrange(ref, this.sheetList, sheetId);\n                let mergeValue = new LuckySheetConfigMerge();\n                mergeValue.r = range.row[0];\n                mergeValue.c = range.column[0];\n                mergeValue.rs = range.row[1]-range.row[0]+1;\n                mergeValue.cs = range.column[1]-range.column[0]+1;\n                if(this.config.merge==null){\n                    this.config.merge = {};\n                }\n                this.config.merge[range.row[0] + \"_\" + range.column[0]] = mergeValue;\n            }\n        }\n\n        let drawingFile = allFileOption.drawingFile, drawingRelsFile = allFileOption.drawingRelsFile;\n        if(drawingFile!=null && drawingRelsFile!=null){\n            let twoCellAnchors = this.readXml.getElementsByTagName(\"xdr:twoCellAnchor\", drawingFile);\n\n            if(twoCellAnchors!=null && twoCellAnchors.length>0){\n                for(let i=0;i<twoCellAnchors.length;i++){\n                    let twoCellAnchor = twoCellAnchors[i];\n                    let editAs = getXmlAttibute(twoCellAnchor.attributeList, \"editAs\", \"twoCell\");\n\n                    let xdrFroms = twoCellAnchor.getInnerElements(\"xdr:from\"), xdrTos = twoCellAnchor.getInnerElements(\"xdr:to\");\n\n                    let xdr_blipfills = twoCellAnchor.getInnerElements(\"a:blip\");\n                    if(xdrFroms!=null && xdr_blipfills!=null && xdrFroms.length>0 && xdr_blipfills.length>0){\n                        let xdrFrom = xdrFroms[0], xdrTo = xdrTos[0],xdr_blipfill = xdr_blipfills[0];\n                        \n                        let rembed = getXmlAttibute(xdr_blipfill.attributeList, \"r:embed\", null);\n\n                        let imageObject = this.getBase64ByRid(rembed, drawingRelsFile);\n\n\n\n                        // let aoff = xdr_xfrm.getInnerElements(\"a:off\"), aext = xdr_xfrm.getInnerElements(\"a:ext\");\n\n                        \n\n                        // if(aoff!=null && aext!=null && aoff.length>0 && aext.length>0){\n                        //     let aoffAttribute = aoff[0].attributeList, aextAttribute = aext[0].attributeList;\n                        //     let x = getXmlAttibute(aoffAttribute, \"x\", null);\n                        //     let y = getXmlAttibute(aoffAttribute, \"y\", null);\n\n                        //     let cx = getXmlAttibute(aextAttribute, \"cx\", null);\n                        //     let cy = getXmlAttibute(aextAttribute, \"cy\", null);\n\n                        //     if(x!=null && y!=null && cx!=null && cy!=null && imageObject !=null){\n                        // let x_n = getPxByEMUs(parseInt(x), \"c\"),y_n = getPxByEMUs(parseInt(y));\n                        // let cx_n = getPxByEMUs(parseInt(cx), \"c\"),cy_n = getPxByEMUs(parseInt(cy));\n\n                        let x_n =0,y_n = 0;\n                        let cx_n = 0, cy_n = 0;\n\n                        imageObject.fromCol = this.getXdrValue(xdrFrom.getInnerElements(\"xdr:col\"));\n                        imageObject.fromColOff = getPxByEMUs(this.getXdrValue(xdrFrom.getInnerElements(\"xdr:colOff\")));\n                        imageObject.fromRow= this.getXdrValue(xdrFrom.getInnerElements(\"xdr:row\"));\n                        imageObject.fromRowOff = getPxByEMUs(this.getXdrValue(xdrFrom.getInnerElements(\"xdr:rowOff\")));\n\n                        imageObject.toCol = this.getXdrValue(xdrTo.getInnerElements(\"xdr:col\"));\n                        imageObject.toColOff = getPxByEMUs(this.getXdrValue(xdrTo.getInnerElements(\"xdr:colOff\")));\n                        imageObject.toRow = this.getXdrValue(xdrTo.getInnerElements(\"xdr:row\"));\n                        imageObject.toRowOff = getPxByEMUs(this.getXdrValue(xdrTo.getInnerElements(\"xdr:rowOff\")));\n\n                        imageObject.originWidth = cx_n;\n                        imageObject.originHeight = cy_n;\n                        \n                        if(editAs==\"absolute\"){\n                            imageObject.type = \"3\";\n                        }\n                        else if(editAs==\"oneCell\"){\n                            imageObject.type = \"2\";\n                        }\n                        else{\n                            imageObject.type = \"1\";\n                        }\n\n                        imageObject.isFixedPos = false;\n                        imageObject.fixedLeft = 0;\n                        imageObject.fixedTop = 0;\n\n                        let imageBorder:IluckyImageBorder = {\n                            color: \"#000\",\n                            radius: 0,\n                            style: \"solid\",\n                            width: 0\n                        }\n                        imageObject.border = imageBorder;\n\n                        let imageCrop:IluckyImageCrop = {\n                            height: cy_n,\n                            offsetLeft: 0,\n                            offsetTop: 0,\n                            width: cx_n\n                        }\n                        imageObject.crop = imageCrop;\n\n                        let imageDefault:IluckyImageDefault = {\n                            height: cy_n,\n                            left: x_n,\n                            top: y_n,\n                            width: cx_n\n                        }\n                        imageObject.default = imageDefault;\n\n                        if(this.images==null){\n                            this.images = {};\n                        }\n                        this.images[generateRandomIndex(\"image\")] = imageObject;\n                        //     }\n                        // }\n                    }\n                }\n            }\n            \n        } \n    }\n\n    private getXdrValue(ele:Element[]):number{\n        if(ele==null || ele.length==0){\n            return null;\n        }\n\n        return parseInt(ele[0].value);\n    }\n\n    private getBase64ByRid(rid:string, drawingRelsFile:string){\n        let Relationships = this.readXml.getElementsByTagName(\"Relationships/Relationship\", drawingRelsFile);\n\n        if(Relationships!=null && Relationships.length>0){\n            for(let i=0;i<Relationships.length;i++){\n                let Relationship = Relationships[i];\n                let attrList = Relationship.attributeList;\n                let Id = getXmlAttibute(attrList, \"Id\", null);\n                let src = getXmlAttibute(attrList, \"Target\", null);\n                if(Id == rid){\n                    src = src.replace(/\\.\\.\\//g, \"\");\n                    src = \"xl/\" + src;\n                    let imgage = this.imageList.getImageByName(src);\n                    return imgage;\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /**\n    * @desc This will convert cols/col to luckysheet config of column'width\n    */\n    private generateConfigColumnLenAndHidden(){\n        let cols = this.readXml.getElementsByTagName(\"cols/col\", this.sheetFile);\n        for(let i=0;i<cols.length;i++){\n            let col = cols[i], attrList = col.attributeList;\n            let min = getXmlAttibute(attrList, \"min\", null);\n            let max = getXmlAttibute(attrList, \"max\", null);\n            let width = getXmlAttibute(attrList, \"width\", null);\n            let hidden = getXmlAttibute(attrList, \"hidden\", null);\n            let customWidth = getXmlAttibute(attrList, \"customWidth\", null);\n\n\n            if(min==null || max==null){\n                continue;\n            }\n\n            let minNum = parseInt(min)-1, maxNum=parseInt(max)-1, widthNum=parseFloat(width);\n            \n            for(let m=minNum;m<=maxNum;m++){\n                if(width!=null){\n                    if(this.config.columnlen==null){\n                        this.config.columnlen = {};\n                    }\n                    this.config.columnlen[m] = getColumnWidthPixel(widthNum);\n                }\n\n                if(hidden==\"1\"){\n                    if(this.config.colhidden==null){\n                        this.config.colhidden = {};\n                    }\n                    this.config.colhidden[m] = 0;\n\n                    if(this.config.columnlen){\n                        delete this.config.columnlen[m];\n                    }\n                    \n                }\n\n                if(customWidth!=null){\n                    if(this.config.customWidth==null){\n                        this.config.customWidth = {};\n                    }\n                    this.config.customWidth[m] = 1;\n                }\n            } \n        }\n    }\n\n    /**\n    * @desc This will convert cols/col to luckysheet config of column'width\n    */\n    private generateConfigRowLenAndHiddenAddCell():IcellOtherInfo{\n        let rows = this.readXml.getElementsByTagName(\"sheetData/row\", this.sheetFile);\n        let cellOtherInfo:IcellOtherInfo = {};\n        let formulaList:IformulaList = {};\n        cellOtherInfo.formulaList = formulaList;\n        for(let i=0;i<rows.length;i++){\n            let row = rows[i], attrList = row.attributeList;\n            let rowNo = getXmlAttibute(attrList, \"r\", null);\n            let height = getXmlAttibute(attrList, \"ht\", null);\n            let hidden = getXmlAttibute(attrList, \"hidden\", null);\n            let customHeight = getXmlAttibute(attrList, \"customHeight\", null);\n\n            if(rowNo==null){\n                continue;\n            }\n\n            let rowNoNum = parseInt(rowNo) - 1;\n            if(height!=null){\n                let heightNum = parseFloat(height);\n                if(this.config.rowlen==null){\n                    this.config.rowlen = {};\n                }\n                this.config.rowlen[rowNoNum] = getRowHeightPixel(heightNum);\n            }\n\n            if(hidden==\"1\"){\n                if(this.config.rowhidden==null){\n                    this.config.rowhidden = {};\n                }\n                this.config.rowhidden[rowNoNum] = 0;\n                \n                if(this.config.rowlen){\n                    delete this.config.rowlen[rowNoNum];\n                }\n                \n            }\n\n            if(customHeight!=null){\n                if(this.config.customHeight==null){\n                    this.config.customHeight = {};\n                }\n                this.config.customHeight[rowNoNum] = 1;\n            }\n\n\n            if(this.isInitialCell){\n                let cells = row.getInnerElements(\"c\");\n                for(let key in cells){\n                    let cell = cells[key];\n                    let cellValue = new LuckySheetCelldata(cell, this.styles, this.sharedStrings, this.mergeCells,this.sheetFile, this.readXml);\n                    if(cellValue._borderObject!=null){\n                        if(this.config.borderInfo==null){\n                            this.config.borderInfo = [];\n                        }\n                        this.config.borderInfo.push(cellValue._borderObject);\n                        delete cellValue._borderObject;\n                    }\n                    \n                    // let borderId = cellValue._borderId;\n                    // if(borderId!=null){\n                    //     let borders = this.styles[\"borders\"] as Element[];\n                    //     if(this.config._borderInfo==null){\n                    //         this.config._borderInfo = {};\n                    //     }\n                    //     if( borderId in this.config._borderInfo){\n                    //         this.config._borderInfo[borderId].cells.push(cellValue.r + \"_\" + cellValue.c);\n                    //     }\n                    //     else{\n                    //         let border = borders[borderId];\n                    //         let borderObject = new LuckySheetborderInfoCellForImp();\n                    //         borderObject.rangeType = \"cellGroup\";\n                    //         borderObject.cells = [];\n                    //         let borderCellValue = new LuckySheetborderInfoCellValue();\n                            \n                    //         let lefts = border.getInnerElements(\"left\");\n                    //         let rights = border.getInnerElements(\"right\");\n                    //         let tops = border.getInnerElements(\"top\");\n                    //         let bottoms = border.getInnerElements(\"bottom\");\n                    //         let diagonals = border.getInnerElements(\"diagonal\");\n\n                    //         let left = this.getBorderInfo(lefts);\n                    //         let right = this.getBorderInfo(rights);\n                    //         let top = this.getBorderInfo(tops);\n                    //         let bottom = this.getBorderInfo(bottoms);\n                    //         let diagonal = this.getBorderInfo(diagonals);\n\n                    //         let isAdd = false;\n                    //         if(left!=null && left.color!=null){\n                    //             borderCellValue.l = left;\n                    //             isAdd = true;\n                    //         }\n\n                    //         if(right!=null && right.color!=null){\n                    //             borderCellValue.r = right;\n                    //             isAdd = true;\n                    //         }\n\n                    //         if(top!=null && top.color!=null){\n                    //             borderCellValue.t = top;\n                    //             isAdd = true;\n                    //         }\n\n                    //         if(bottom!=null && bottom.color!=null){\n                    //             borderCellValue.b = bottom;\n                    //             isAdd = true;\n                    //         }\n\n                    //         if(isAdd){\n                    //             borderObject.value = borderCellValue;\n                    //             this.config._borderInfo[borderId] = borderObject;\n                    //         }\n\n                    //     }\n                    // }\n                    if(cellValue._formulaType==\"shared\"){\n                        if(this.formulaRefList==null){\n                            this.formulaRefList = {};\n                        }\n\n                        if(this.formulaRefList[cellValue._formulaSi]==null){\n                            this.formulaRefList[cellValue._formulaSi] = {}\n                        }\n\n                        let fv;\n                        if(cellValue.v!=null){\n                            fv = (cellValue.v as IluckySheetCelldataValue).f;\n                        }\n\n                        let refValue = {\n                            t:cellValue._formulaType,\n                            ref:cellValue._fomulaRef,\n                            si:cellValue._formulaSi,\n                            fv:fv,\n                            cellValue:cellValue\n                        }\n\n                        if(cellValue._fomulaRef!=null){\n                            this.formulaRefList[cellValue._formulaSi][\"mainRef\"] = refValue;\n                        }\n                        else{\n                            this.formulaRefList[cellValue._formulaSi][cellValue.r+\"_\"+cellValue.c] = refValue;\n                        }\n\n                        // console.log(refValue, this.formulaRefList);\n                    }\n\n                    //There may be formulas that do not appear in calcChain\n                    if(cellValue.v!=null && (cellValue.v as IluckySheetCelldataValue).f!=null){\n                        let formulaCell:IformulaListItem = {\n                            r:cellValue.r,\n                            c:cellValue.c\n                        }\n                        cellOtherInfo.formulaList[\"r\"+cellValue.r+\"c\"+cellValue.c] = formulaCell;\n                    }\n\n                    this.celldata.push(cellValue);\n                }\n                \n            }\n        }\n\n        return cellOtherInfo;\n    }\n  \n    /**\n     * luckysheet config of dataValidations\n     * \n     * @returns {IluckysheetDataVerification} - dataValidations config\n     */\n    private generateConfigDataValidations(): IluckysheetDataVerification {\n      \n      let rows = this.readXml.getElementsByTagName(\n        \"dataValidations/dataValidation\",\n        this.sheetFile\n      );\n      let extLst =\n        this.readXml.getElementsByTagName(\n          \"extLst/ext/x14:dataValidations/x14:dataValidation\",\n          this.sheetFile\n        ) || [];\n      \n      rows = rows.concat(extLst);\n  \n      let dataVerification: IluckysheetDataVerification = {};\n  \n      for (let i = 0; i < rows.length; i++) {\n        let row = rows[i];\n        let attrList = row.attributeList;\n        let formulaValue = row.value;\n  \n        let type = getXmlAttibute(attrList, \"type\", null);\n        if(!type) {\n            continue;\n        }\n        let operator = \"\",\n            sqref = \"\",\n            sqrefIndexArr: string[] = [],\n            valueArr: string[] = [];\n        let _prohibitInput =\n          getXmlAttibute(attrList, \"allowBlank\", null) !== \"1\" ? false : true;\n        \n        // x14 processing\n        const formulaReg = new RegExp(/<x14:formula1>|<xm:sqref>/g)\n        if (formulaReg.test(formulaValue) && extLst?.length >= 0) {\n          operator = getXmlAttibute(attrList, \"operator\", null);\n          const peelOffData = getPeelOffX14(formulaValue);\n          sqref = peelOffData?.sqref;\n          sqrefIndexArr = getMultiSequenceToNum(sqref);\n          valueArr = getMultiFormulaValue(peelOffData?.formula);\n        } else {\n          operator = getXmlAttibute(attrList, \"operator\", null);\n          sqref = getXmlAttibute(attrList, \"sqref\", null);\n          sqrefIndexArr = getMultiSequenceToNum(sqref);\n          valueArr = getMultiFormulaValue(formulaValue);\n        }\n\n        let _type = DATA_VERIFICATION_MAP[type];\n        let _type2 = null;\n        let _value1: string | number = valueArr?.length >= 1 ? valueArr[0] : \"\";\n        let _value2: string | number = valueArr?.length === 2 ? valueArr[1] : \"\";\n        let _hint = getXmlAttibute(attrList, \"prompt\", null);\n        let _hintShow = _hint ? true : false\n  \n        const matchType = COMMON_TYPE2.includes(_type) ? \"common\" : _type;\n        _type2 = operator\n          ? DATA_VERIFICATION_TYPE2_MAP[matchType][operator]\n          : \"bw\";\n        \n        // mobile phone number processing\n        if (\n          _type === \"text_content\" &&\n          (_value1?.includes(\"LEN\") || _value1?.includes(\"len\")) &&\n          _value1?.includes(\"=11\")\n        ) {\n          _type = \"validity\";\n          _type2 = \"phone\";\n        }\n\n        // date processing\n        if (_type === \"date\") {\n          const D1900 = new Date(1899, 11, 30, 0, 0, 0);\n          _value1 = dayjs(D1900)\n            .clone()\n            .add(Number(_value1), \"day\")\n            .format(\"YYYY-MM-DD\");\n          _value2 = dayjs(D1900)\n            .clone()\n            .add(Number(_value2), \"day\")\n            .format(\"YYYY-MM-DD\");\n        }\n        \n        // checkbox and dropdown processing\n        if (_type === \"checkbox\" || _type === \"dropdown\") {\n          _type2 = null;\n        }\n        \n        // dynamically add dataVerifications\n        for (const ref of sqrefIndexArr) {\n          dataVerification[ref] = {\n            type: _type,\n            type2: _type2,\n            value1: _value1,\n            value2: _value2,\n            checked: false,\n            remote: false,\n            prohibitInput: _prohibitInput,\n            hintShow: _hintShow,\n            hintText: _hint\n          };\n        }\n      }\n  \n      return dataVerification;\n    }\n  \n    /**\n     * luckysheet config of hyperlink\n     * \n     * @returns {IluckysheetHyperlink} - hyperlink config\n     */\n    private generateConfigHyperlinks(): IluckysheetHyperlink {\n      let rows = this.readXml.getElementsByTagName(\n        \"hyperlinks/hyperlink\",\n        this.sheetFile\n      );\n      let hyperlink: IluckysheetHyperlink = {};\n      for (let i = 0; i < rows.length; i++) {\n        let row = rows[i];\n        let attrList = row.attributeList;\n        let ref = getXmlAttibute(attrList, \"ref\", null),\n            refArr = getMultiSequenceToNum(ref),\n            _display = getXmlAttibute(attrList, \"display\", null),\n            _address = getXmlAttibute(attrList, \"location\", null),\n            _tooltip = getXmlAttibute(attrList, \"tooltip\", null);\n        let _type: IluckysheetHyperlinkType = _address ? \"internal\" : \"external\";\n  \n        // external hyperlink\n        if (!_address) {\n          let rid = attrList[\"r:id\"];\n          let sheetFile = this.sheetFile;\n          let relationshipList = this.readXml.getElementsByTagName(\n            \"Relationships/Relationship\",\n            `xl/worksheets/_rels/${sheetFile.replace(worksheetFilePath, \"\")}.rels`\n          );\n  \n          const findRid = relationshipList?.find(\n            (e) => e.attributeList[\"Id\"] === rid\n          );\n\n          if (findRid) {\n            _address = findRid.attributeList[\"Target\"];\n            _type = findRid.attributeList[\n              \"TargetMode\"\n            ]?.toLocaleLowerCase() as IluckysheetHyperlinkType;\n          }\n        }\n\n        // match R1C1\n        const addressReg = new RegExp(/^.*!R([\\d$])+C([\\d$])*$/g)\n        if (addressReg.test(_address)) {\n          _address = getTransR1C1ToSequence(_address);\n        }\n        \n        // dynamically add hyperlinks\n        for (const ref of refArr) {\n          hyperlink[ref] = {\n            linkAddress: _address,\n            linkTooltip: _tooltip || \"\",\n            linkType: _type,\n            display: _display || \"\",\n          };\n        }\n      }\n      \n      return hyperlink;\n    }\n\n    // private getBorderInfo(borders:Element[]):LuckySheetborderInfoCellValueStyle{\n    //     if(borders==null){\n    //         return null;\n    //     }\n\n    //     let border = borders[0], attrList = border.attributeList;\n    //     let clrScheme = this.styles[\"clrScheme\"] as Element[];\n    //     let style:string = attrList.style;\n    //     if(style==null || style==\"none\"){\n    //         return null;\n    //     }\n\n    //     let colors = border.getInnerElements(\"color\");\n    //     let colorRet = \"#000000\";\n    //     if(colors!=null){\n    //         let color = colors[0];\n    //         colorRet = getColor(color, clrScheme);\n    //     }\n\n    //     let ret = new LuckySheetborderInfoCellValueStyle();\n    //     ret.style = borderTypes[style];\n    //     ret.color = colorRet;\n\n    //     return ret;\n    // }\n}\n","export let UDOC:any = {};\n\t\n\tUDOC.G = {\n\t\tconcat : function(p:any,r:any) {\n\t\t\tfor(var i=0; i<r.cmds.length; i++) p.cmds.push(r.cmds[i]);\n\t\t\tfor(var i=0; i<r.crds.length; i++) p.crds.push(r.crds[i]);\n\t\t},\n\t\tgetBB  : function(ps:any) {\n\t\t\tvar x0=1e99, y0=1e99, x1=-x0, y1=-y0;\n\t\t\tfor(var i=0; i<ps.length; i+=2) {  var x=ps[i],y=ps[i+1];  if(x<x0)x0=x; else if(x>x1)x1=x;  if(y<y0)y0=y;  else if(y>y1)y1=y;  }\n\t\t\treturn [x0,y0,x1,y1];\n\t\t},\n\t\trectToPath: function(r:any) {  return  {cmds:[\"M\",\"L\",\"L\",\"L\",\"Z\"],crds:[r[0],r[1],r[2],r[1], r[2],r[3],r[0],r[3]]};  },\n\t\t// a inside b\n\t\tinsideBox: function(a:any,b:any) {  return b[0]<=a[0] && b[1]<=a[1] && a[2]<=b[2] && a[3]<=b[3];   },\n\t\tisBox : function(p:any, bb:any) {\n\t\t\tvar sameCrd8 = function(pcrd:any, crds:any) {\n\t\t\t\tfor(var o=0; o<8; o+=2) {  var eq = true;  for(var j=0; j<8; j++) if(Math.abs(crds[j]-pcrd[(j+o)&7])>=2) {  eq = false;  break;  }    if(eq) return true;  }\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tif(p.cmds.length>10) return false;\n\t\t\tvar cmds=p.cmds.join(\"\"), crds=p.crds;\n\t\t\tvar sameRect = false;\n\t\t\tif((cmds==\"MLLLZ\"  && crds.length== 8) \n\t\t\t ||(cmds==\"MLLLLZ\" && crds.length==10) ) {\n\t\t\t\tif(crds.length==10) crds=crds.slice(0,8);\n\t\t\t\tvar x0=bb[0],y0=bb[1],x1=bb[2],y1=bb[3];\n\t\t\t\tif(!sameRect) sameRect = sameCrd8(crds, [x0,y0,x1,y0,x1,y1,x0,y1]);\n\t\t\t\tif(!sameRect) sameRect = sameCrd8(crds, [x0,y1,x1,y1,x1,y0,x0,y0]);\n\t\t\t}\n\t\t\treturn sameRect;\n\t\t},\n\t\tboxArea: function(a:any) {  var w=a[2]-a[0], h=a[3]-a[1];  return w*h;  },\n\t\tnewPath: function(gst:any    ) {  gst.pth = {cmds:[], crds:[]};  },\n\t\tmoveTo : function(gst:any,x:any,y:any) {  var p=UDOC.M.multPoint(gst.ctm,[x,y]);  //if(gst.cpos[0]==p[0] && gst.cpos[1]==p[1]) return;\n\t\t\t\t\t\t\t\t\t\tgst.pth.cmds.push(\"M\");  gst.pth.crds.push(p[0],p[1]);  gst.cpos = p;  },\n\t\tlineTo : function(gst:any,x:any,y:any) {  var p=UDOC.M.multPoint(gst.ctm,[x,y]);  if(gst.cpos[0]==p[0] && gst.cpos[1]==p[1]) return;\n\t\t\t\t\t\t\t\t\t\tgst.pth.cmds.push(\"L\");  gst.pth.crds.push(p[0],p[1]);  gst.cpos = p;  },\n\t\tcurveTo: function(gst:any,x1:any,y1:any,x2:any,y2:any,x3:any,y3:any) {   var p;  \n\t\t\tp=UDOC.M.multPoint(gst.ctm,[x1,y1]);  x1=p[0];  y1=p[1];\n\t\t\tp=UDOC.M.multPoint(gst.ctm,[x2,y2]);  x2=p[0];  y2=p[1];\n\t\t\tp=UDOC.M.multPoint(gst.ctm,[x3,y3]);  x3=p[0];  y3=p[1];  gst.cpos = p;\n\t\t\tgst.pth.cmds.push(\"C\");  \n\t\t\tgst.pth.crds.push(x1,y1,x2,y2,x3,y3);  \n\t\t},\n\t\tclosePath: function(gst:any  ) {  gst.pth.cmds.push(\"Z\");  },\n\t\tarc : function(gst:any,x:any,y:any,r:any,a0:any,a1:any, neg:any) {\n\t\t\t\n\t\t\t// circle from a0 counter-clock-wise to a1\n\t\t\tif(neg) while(a1>a0) a1-=2*Math.PI;\n\t\t\telse    while(a1<a0) a1+=2*Math.PI;\n\t\t\tvar th = (a1-a0)/4;\n\t\t\t\n\t\t\tvar x0 = Math.cos(th/2), y0 = -Math.sin(th/2);\n\t\t\tvar x1 = (4-x0)/3, y1 = y0==0 ? y0 : (1-x0)*(3-x0)/(3*y0);\n\t\t\tvar x2 = x1, y2 = -y1;\n\t\t\tvar x3 = x0, y3 = -y0;\n\t\t\t\n\t\t\tvar p0 = [x0,y0], p1 = [x1,y1], p2 = [x2,y2], p3 = [x3,y3];\n\t\t\t\n\t\t\tvar pth = {cmds:[(gst.pth.cmds.length==0)?\"M\":\"L\",\"C\",\"C\",\"C\",\"C\"], crds:[x0,y0,x1,y1,x2,y2,x3,y3]};\n\t\t\t\n\t\t\tvar rot = [1,0,0,1,0,0];  UDOC.M.rotate(rot,-th);\n\t\t\t\n\t\t\tfor(var i=0; i<3; i++) {\n\t\t\t\tp1 = UDOC.M.multPoint(rot,p1);  p2 = UDOC.M.multPoint(rot,p2);  p3 = UDOC.M.multPoint(rot,p3);\n\t\t\t\tpth.crds.push(p1[0],p1[1],p2[0],p2[1],p3[0],p3[1]);\n\t\t\t}\n\t\t\t\n\t\t\tvar sc = [r,0,0,r,x,y];  \n\t\t\tUDOC.M.rotate(rot, -a0+th/2);  UDOC.M.concat(rot, sc);  UDOC.M.multArray(rot, pth.crds);\n\t\t\tUDOC.M.multArray(gst.ctm, pth.crds);\n\t\t\t\n\t\t\tUDOC.G.concat(gst.pth, pth);\n\t\t\tvar y:any=pth.crds.pop();  x=pth.crds.pop();\n\t\t\tgst.cpos = [x,y];\n\t\t},\n\t\ttoPoly : function(p:any) {\n\t\t\tif(p.cmds[0]!=\"M\" || p.cmds[p.cmds.length-1]!=\"Z\") return null;\n\t\t\tfor(var i=1; i<p.cmds.length-1; i++) if(p.cmds[i]!=\"L\") return null;\n\t\t\tvar out = [], cl = p.crds.length;\n\t\t\tif(p.crds[0]==p.crds[cl-2] && p.crds[1]==p.crds[cl-1]) cl-=2;\n\t\t\tfor(var i=0; i<cl; i+=2) out.push([p.crds[i],p.crds[i+1]]);\n\t\t\tif(UDOC.G.polyArea(p.crds)<0) out.reverse();\n\t\t\treturn out;\n\t\t},\n\t\tfromPoly : function(p:any) {\n\t\t\tvar o:any = {cmds:[],crds:[]};\n\t\t\tfor(var i=0; i<p.length; i++) { o.crds.push(p[i][0], p[i][1]);  o.cmds.push(i==0?\"M\":\"L\");  }\n\t\t\to.cmds.push(\"Z\");\n\t\t\treturn o;\n\t\t},\n\t\tpolyArea : function(p:any) {\n\t\t\tif(p.length <6) return 0;\n\t\t\tvar l = p.length - 2;\n\t\t\tvar sum = (p[0]-p[l]) * (p[l+1]+p[1]);\n\t\t\tfor(var i=0; i<l; i+=2)\n\t\t\t\tsum += (p[i+2]-p[i]) * (p[i+1]+p[i+3]);\n\t\t\treturn - sum * 0.5;\n\t\t},\n\t\tpolyClip : function(p0:any, p1:any) {  // p0 clipped by p1\n            var cp1:any, cp2:any, s:any, e:any;\n            var inside = function (p:any) {\n                return (cp2[0]-cp1[0])*(p[1]-cp1[1]) > (cp2[1]-cp1[1])*(p[0]-cp1[0]);\n            };\n            var isc = function () {\n                var dc = [ cp1[0] - cp2[0], cp1[1] - cp2[1] ],\n                    dp = [ s[0] - e[0], s[1] - e[1] ],\n                    n1 = cp1[0] * cp2[1] - cp1[1] * cp2[0],\n                    n2 = s[0] * e[1] - s[1] * e[0], \n                    n3 = 1.0 / (dc[0] * dp[1] - dc[1] * dp[0]);\n                return [(n1*dp[0] - n2*dc[0]) * n3, (n1*dp[1] - n2*dc[1]) * n3];\n            };\n            var out = p0;\n            cp1 = p1[p1.length-1];\n            for (let j in p1) {\n                var cp2 = p1[j];\n                var inp = out;\n                out = [];\n                s = inp[inp.length - 1]; //last on the input list\n                for (let i in inp) {\n                    var e = inp[i];\n                    if (inside(e)) {\n                        if (!inside(s)) {\n                            out.push(isc());\n                        }\n                        out.push(e);\n                    }\n                    else if (inside(s)) {\n                        out.push(isc());\n                    }\n                    s = e;\n                }\n                cp1 = cp2;\n            }\n            return out\n        }\n\t}\n\tUDOC.M = {\n\t\tgetScale : function(m:any) {  return Math.sqrt(Math.abs(m[0]*m[3]-m[1]*m[2]));  },\n\t\ttranslate: function(m:any,x:any,y:any) {  UDOC.M.concat(m, [1,0,0,1,x,y]);  },\n\t\trotate   : function(m:any,a:any  ) {  UDOC.M.concat(m, [Math.cos(a), -Math.sin(a), Math.sin(a), Math.cos(a),0,0]);  },\n\t\tscale    : function(m:any,x:any,y:any) {  UDOC.M.concat(m, [x,0,0,y,0,0]);  },\n\t\tconcat   : function(m:any,w:any  ) {  \n\t\t\tvar a=m[0],b=m[1],c=m[2],d=m[3],tx=m[4],ty=m[5];\n\t\t\tm[0] = (a *w[0])+(b *w[2]);       m[1] = (a *w[1])+(b *w[3]);\n\t\t\tm[2] = (c *w[0])+(d *w[2]);       m[3] = (c *w[1])+(d *w[3]);\n\t\t\tm[4] = (tx*w[0])+(ty*w[2])+w[4];  m[5] = (tx*w[1])+(ty*w[3])+w[5]; \n\t\t},\n\t\tinvert   : function(m:any    ) {  \n\t\t\tvar a=m[0],b=m[1],c=m[2],d=m[3],tx=m[4],ty=m[5], adbc=a*d-b*c;\n\t\t\tm[0] = d/adbc;  m[1] = -b/adbc;  m[2] =-c/adbc;  m[3] =  a/adbc;\n\t\t\tm[4] = (c*ty - d*tx)/adbc;  m[5] = (b*tx - a*ty)/adbc;\n\t\t},\n\t\tmultPoint: function(m:any, p:any ) {  var x=p[0],y=p[1];  return [x*m[0]+y*m[2]+m[4],   x*m[1]+y*m[3]+m[5]];  },\n\t\tmultArray: function(m:any, a:any ) {  for(var i=0; i<a.length; i+=2) {  var x=a[i],y=a[i+1];  a[i]=x*m[0]+y*m[2]+m[4];  a[i+1]=x*m[1]+y*m[3]+m[5];  }  }\n\t}\n\tUDOC.C = {\n\t\tsrgbGamma : function(x:any) {  return x < 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1.0 / 2.4) - 0.055;  },\n\t\tcmykToRgb : function(clr:any) { \n\t\t\tvar c=clr[0], m=clr[1], y=clr[2], k=clr[3];\n\t\t\t// return [1-Math.min(1,c+k), 1-Math.min(1, m+k), 1-Math.min(1,y+k)];\n\t\t\tvar r = 255\n\t\t\t+ c * (-4.387332384609988  * c + 54.48615194189176  * m +  18.82290502165302  * y + 212.25662451639585 * k +  -285.2331026137004) \n\t\t\t+ m * ( 1.7149763477362134 * m - 5.6096736904047315 * y + -17.873870861415444 * k - 5.497006427196366) \n\t\t\t+ y * (-2.5217340131683033 * y - 21.248923337353073 * k +  17.5119270841813) \n\t\t\t+ k * (-21.86122147463605  * k - 189.48180835922747);\n\t\t\tvar g = 255\n\t\t\t+ c * (8.841041422036149   * c + 60.118027045597366 * m +  6.871425592049007  * y + 31.159100130055922 * k +  -79.2970844816548) \n\t\t\t+ m * (-15.310361306967817 * m + 17.575251261109482 * y +  131.35250912493976 * k - 190.9453302588951) \n\t\t\t+ y * (4.444339102852739   * y + 9.8632861493405    * k -  24.86741582555878) \n\t\t\t+ k * (-20.737325471181034 * k - 187.80453709719578);\n\t\t\tvar b = 255\n\t\t\t+ c * (0.8842522430003296  * c + 8.078677503112928  * m +  30.89978309703729  * y - 0.23883238689178934 * k + -14.183576799673286) \n\t\t\t+ m * (10.49593273432072   * m + 63.02378494754052  * y +  50.606957656360734 * k - 112.23884253719248) \n\t\t\t+ y * (0.03296041114873217 * y + 115.60384449646641 * k + -193.58209356861505)\n\t\t\t+ k * (-22.33816807309886  * k - 180.12613974708367);\n\n\t\t\treturn [Math.max(0, Math.min(1, r/255)), Math.max(0, Math.min(1, g/255)), Math.max(0, Math.min(1, b/255))];\n\t\t\t//var iK = 1-c[3];  \n\t\t\t//return [(1-c[0])*iK, (1-c[1])*iK, (1-c[2])*iK];  \n\t\t},\n\t\tlabToRgb  : function(lab:any) {\n\t\t\tvar k = 903.3, e = 0.008856, L = lab[0], a = lab[1], b = lab[2];\n\t\t\tvar fy = (L+16)/116, fy3 = fy*fy*fy;\n\t\t\tvar fz = fy - b/200, fz3 = fz*fz*fz;\n\t\t\tvar fx = a/500 + fy, fx3 = fx*fx*fx;\n\t\t\tvar zr = fz3>e ? fz3 : (116*fz-16)/k;\n\t\t\tvar yr = fy3>e ? fy3 : (116*fy-16)/k;\n\t\t\tvar xr = fx3>e ? fx3 : (116*fx-16)/k;\n\t\t\t\t\n\t\t\tvar X = xr*96.72, Y = yr*100, Z = zr*81.427, xyz = [X/100,Y/100,Z/100];\n\t\t\tvar x2s = [3.1338561, -1.6168667, -0.4906146, -0.9787684,  1.9161415,  0.0334540, 0.0719453, -0.2289914,  1.4052427];\n\t\t\t\n\t\t\tvar rgb = [ x2s[0]*xyz[0] + x2s[1]*xyz[1] + x2s[2]*xyz[2],\n\t\t\t\t\t\tx2s[3]*xyz[0] + x2s[4]*xyz[1] + x2s[5]*xyz[2],\n\t\t\t\t\t\tx2s[6]*xyz[0] + x2s[7]*xyz[1] + x2s[8]*xyz[2]  ];\n\t\t\tfor(var i=0; i<3; i++) rgb[i] = Math.max(0, Math.min(1, UDOC.C.srgbGamma(rgb[i])));\n\t\t\treturn rgb;\n\t\t}\n\t}\n\t\n\tUDOC.getState = function(crds:any):any {\n\t\treturn {\n\t\t\tfont : UDOC.getFont(),\n\t\t\tdd: {flat:1},  // device-dependent\n\t\t\tspace :\"/DeviceGray\",\n\t\t\t// fill\n\t\t\tca: 1,\n\t\t\tcolr  : [0,0,0],\n\t\t\tsspace:\"/DeviceGray\",\n\t\t\t// stroke\n\t\t\tCA: 1,\n\t\t\tCOLR : [0,0,0],\n\t\t\tbmode: \"/Normal\",\n\t\t\tSA:false, OPM:0, AIS:false, OP:false, op:false, SMask:\"/None\",\n\t\t\tlwidth : 1,\n\t\t\tlcap: 0,\n\t\t\tljoin: 0,\n\t\t\tmlimit: 10,\n\t\t\tSM : 0.1,\n\t\t\tdoff: 0,\n\t\t\tdash: [],\n\t\t\tctm : [1,0,0,1,0,0],\n\t\t\tcpos: [0,0],\n\t\t\tpth : {cmds:[],crds:[]}, \n\t\t\tcpth: crds ? UDOC.G.rectToPath(crds) : null  // clipping path\n\t\t};\n\t}\n\t\n\tUDOC.getFont = function() {\n\t\treturn {\n\t\t\tTc: 0, // character spacing\n\t\t\tTw: 0, // word spacing\n\t\t\tTh:100, // horizontal scale\n\t\t\tTl: 0, // leading\n\t\t\tTf:\"Helvetica-Bold\", \n\t\t\tTfs:1, // font size\n\t\t\tTmode:0, // rendering mode\n\t\t\tTrise:0, // rise\n\t\t\tTk: 0,  // knockout\n\t\t\tTal:0,  // align, 0: left, 1: right, 2: center\n\t\t\tTun:0,  // 0: no, 1: underline\n\t\t\t\n\t\t\tTm :[1,0,0,1,0,0],\n\t\t\tTlm:[1,0,0,1,0,0],\n\t\t\tTrm:[1,0,0,1,0,0]\n\t\t};\n\t}\n\n\nexport let FromEMF:any = function()\n{\n}\n\nFromEMF.Parse = function(buff:any, genv:any)\n{\n    buff = new Uint8Array(buff);  var off=0;\n    //console.log(buff.slice(0,32));\n    var prms:any = {fill:false, strk:false, bb:[0,0,1,1], wbb:[0,0,1,1], fnt:{nam:\"Arial\",hgh:25,und:false,orn:0}, tclr:[0,0,0], talg:0}, gst, tab = [], sts=[];\n    \n    var rI = FromEMF.B.readShort, rU = FromEMF.B.readUshort, rI32 = FromEMF.B.readInt, rU32 = FromEMF.B.readUint, rF32 = FromEMF.B.readFloat;\t\n    \n    var opn=0;\n    while(true) {\n        var fnc = rU32(buff, off);  off+=4;\n        var fnm = FromEMF.K[fnc]; \n        var siz = rU32(buff, off);  off+=4;\n        \n        //if(gst && isNaN(gst.ctm[0])) throw \"e\";\n        //console.log(fnc,fnm,siz);\n        \n        var loff = off;\n        \n        //if(opn++==253) break;\n        var obj:any = null, oid = 0;\n        //console.log(fnm, siz);\n        \n        if(false) {}\n        else if(fnm==\"EOF\") {  break;  }\n        else if(fnm==\"HEADER\") {\n            prms.bb = FromEMF._readBox(buff,loff);   loff+=16;  //console.log(fnm, prms.bb);\n            genv.StartPage(prms.bb[0],prms.bb[1],prms.bb[2],prms.bb[3]);\n            gst = UDOC.getState(prms.bb);\t\n        }\n        else if(fnm==\"SAVEDC\") sts.push(JSON.stringify(gst), JSON.stringify(prms));\n        else if(fnm==\"RESTOREDC\") {\n            var dif = rI32(buff, loff);  loff+=4;\n            while(dif<-1) {  sts.pop();  sts.pop();  }\n            prms = JSON.parse(sts.pop());  gst = JSON.parse(sts.pop());\n        }\n        else if(fnm==\"SELECTCLIPPATH\") {  gst.cpth = JSON.parse(JSON.stringify(gst.pth));  }\n        else if([\"SETMAPMODE\",\"SETPOLYFILLMODE\",\"SETBKMODE\"/*,\"SETVIEWPORTEXTEX\"*/,\"SETICMMODE\",\"SETROP2\",\"EXTSELECTCLIPRGN\"].indexOf(fnm)!=-1) {}\n        //else if(fnm==\"INTERSECTCLIPRECT\") {  var r=prms.crct=FromEMF._readBox(buff, loff);  /*var y0=r[1],y1=r[3]; if(y0>y1){r[1]=y1; r[3]=y0;}*/ console.log(prms.crct);  }\n        else if(fnm==\"SETMITERLIMIT\") gst.mlimit = rU32(buff, loff);\n        else if(fnm==\"SETTEXTCOLOR\") prms.tclr = [buff[loff]/255, buff[loff+1]/255, buff[loff+2]/255]; \n        else if(fnm==\"SETTEXTALIGN\") prms.talg = rU32(buff, loff);\n        else if(fnm==\"SETVIEWPORTEXTEX\" || fnm==\"SETVIEWPORTORGEX\") {\n            if(prms.vbb==null) prms.vbb=[];\n            var coff = fnm==\"SETVIEWPORTORGEX\" ? 0 : 2;\n            prms.vbb[coff  ] = rI32(buff, loff);  loff+=4;\n            prms.vbb[coff+1] = rI32(buff, loff);  loff+=4;\n            //console.log(prms.vbb);\n            if(fnm==\"SETVIEWPORTEXTEX\") FromEMF._updateCtm(prms, gst);\n        }\n        else if(fnm==\"SETWINDOWEXTEX\" || fnm==\"SETWINDOWORGEX\") {\n            var coff = fnm==\"SETWINDOWORGEX\" ? 0 : 2;\n            prms.wbb[coff  ] = rI32(buff, loff);  loff+=4;\n            prms.wbb[coff+1] = rI32(buff, loff);  loff+=4;\n            if(fnm==\"SETWINDOWEXTEX\") FromEMF._updateCtm(prms, gst);\n        }\n        //else if(fnm==\"SETMETARGN\") {}\n        else if(fnm==\"COMMENT\") {  var ds = rU32(buff, loff);  loff+=4;  }\n        \n        else if(fnm==\"SELECTOBJECT\") {\n            var ind = rU32(buff, loff);  loff+=4;\n            //console.log(ind.toString(16), tab, tab[ind]);\n            if     (ind==0x80000000) {  prms.fill=true ;  gst.colr=[1,1,1];  } // white brush\n            else if(ind==0x80000005) {  prms.fill=false;  } // null brush\n            else if(ind==0x80000007) {  prms.strk=true ;  prms.lwidth=1;  gst.COLR=[0,0,0];  } // black pen\n            else if(ind==0x80000008) {  prms.strk=false;  } // null  pen\n            else if(ind==0x8000000d) {} // system font\n            else if(ind==0x8000000e) {}  // device default font\n            else {\n                var co:any = tab[ind];  //console.log(ind, co);\n                if(co.t==\"b\") {\n                    prms.fill=co.stl!=1;\n                    if     (co.stl==0) {}\n                    else if(co.stl==1) {}\n                    else throw co.stl+\" e\";\n                    gst.colr=co.clr;\n                }\n                else if(co.t==\"p\") {\n                    prms.strk=co.stl!=5;\n                    gst.lwidth = co.wid;\n                    gst.COLR=co.clr;\n                }\n                else if(co.t==\"f\") {\n                    prms.fnt = co;\n                    gst.font.Tf = co.nam;\n                    gst.font.Tfs = Math.abs(co.hgh);\n                    gst.font.Tun = co.und;\n                }\n                else throw \"e\";\n            }\n        }\n        else if(fnm==\"DELETEOBJECT\") {\n            var ind = rU32(buff, loff);  loff+=4;\n            if(tab[ind]!=null) tab[ind]=null;\n            else throw \"e\";\n        }\n        else if(fnm==\"CREATEBRUSHINDIRECT\") {\n            oid = rU32(buff, loff);  loff+=4;\n            obj = {t:\"b\"};\n            obj.stl = rU32(buff, loff);  loff+=4;\n            obj.clr = [buff[loff]/255, buff[loff+1]/255, buff[loff+2]/255];  loff+=4;\n            obj.htc = rU32(buff, loff);  loff+=4;\n            //console.log(oid, obj);\n        }\n        else if(fnm==\"CREATEPEN\" || fnm==\"EXTCREATEPEN\") {\n            oid = rU32(buff, loff);  loff+=4;\n            obj = {t:\"p\"};\n            if(fnm==\"EXTCREATEPEN\") {\n                loff+=16;\n                obj.stl = rU32(buff, loff);  loff+=4;\n                obj.wid = rU32(buff, loff);  loff+=4;\n                //obj.stl = rU32(buff, loff);  \n                loff+=4;\n            } else {\n                obj.stl = rU32(buff, loff);  loff+=4;\n                obj.wid = rU32(buff, loff);  loff+=4;  loff+=4;\n            }\n            obj.clr = [buff[loff]/255, buff[loff+1]/255, buff[loff+2]/255];  loff+=4;\n        }\n        else if(fnm==\"EXTCREATEFONTINDIRECTW\") {\n            oid = rU32(buff, loff);  loff+=4;\n            obj = {t:\"f\", nam:\"\"};\n            obj.hgh = rI32(buff, loff);  loff += 4;\n            loff += 4*2;\n            obj.orn = rI32(buff, loff)/10;  loff+=4;\n            var wgh = rU32(buff, loff);  loff+=4;  //console.log(fnm, obj.orn, wgh);\n            //console.log(rU32(buff,loff), rU32(buff,loff+4), buff.slice(loff,loff+8));\n            obj.und = buff[loff+1];  obj.stk = buff[loff+2];  loff += 4*2;\n            while(rU(buff,loff)!=0) {  obj.nam+=String.fromCharCode(rU(buff,loff));  loff+=2;  }\n            if(wgh>500) obj.nam+=\"-Bold\";\n            //console.log(wgh, obj.nam);\n        }\n        else if(fnm==\"EXTTEXTOUTW\") {\n            //console.log(buff.slice(loff-8, loff-8+siz));\n            loff+=16;\n            var mod = rU32(buff, loff);  loff+=4;  //console.log(mod);\n            var scx = rF32(buff, loff);  loff+=4;\n            var scy = rF32(buff, loff);  loff+=4;\n            var rfx = rI32(buff, loff);  loff+=4;\n            var rfy = rI32(buff, loff);  loff+=4;\n            //console.log(mod, scx, scy,rfx,rfy);\n            \n            gst.font.Tm = [1,0,0,-1,0,0];\n            UDOC.M.rotate(gst.font.Tm, prms.fnt.orn*Math.PI/180);\n            UDOC.M.translate(gst.font.Tm, rfx, rfy);\n            \n            var alg = prms.talg;  //console.log(alg.toString(2));\n            if     ((alg&6)==6) gst.font.Tal = 2;\n            else if((alg&7)==0) gst.font.Tal = 0;\n            else throw alg+\" e\";\n            if((alg&24)==24) {}  // baseline\n            else if((alg&24)==0) UDOC.M.translate(gst.font.Tm, 0, gst.font.Tfs);\n            else throw \"e\";\n            \n            \n            var crs = rU32(buff, loff);  loff+=4;\n            var ofs = rU32(buff, loff);  loff+=4;\n            var ops = rU32(buff, loff);  loff+=4;  //if(ops!=0) throw \"e\";\n            //console.log(ofs,ops,crs);\n            loff+=16;\n            var ofD = rU32(buff, loff);  loff+=4;  //console.log(ops, ofD, loff, ofs+off-8);\n            ofs += off-8;  //console.log(crs, ops);\n            var str = \"\";\n            for(var i=0; i<crs; i++) {  var cc=rU(buff,ofs+i*2);  str+=String.fromCharCode(cc);  };\n            var oclr = gst.colr;  gst.colr = prms.tclr;\n            //console.log(str, gst.colr, gst.font.Tm);\n            //var otfs = gst.font.Tfs;  gst.font.Tfs *= 1/gst.ctm[0];\n            genv.PutText(gst, str, str.length*gst.font.Tfs*0.5);  gst.colr=oclr;\n            //gst.font.Tfs = otfs;\n            //console.log(rfx, rfy, scx, ops, rcX, rcY, rcW, rcH, offDx, str);\n        }\n        else if(fnm==\"BEGINPATH\") {  UDOC.G.newPath(gst);  }\n        else if(fnm==\"ENDPATH\"  ) {    }\n        else if(fnm==\"CLOSEFIGURE\") UDOC.G.closePath(gst);\n        else if(fnm==\"MOVETOEX\" ) {  UDOC.G.moveTo(gst, rI32(buff,loff), rI32(buff,loff+4));  }\n        else if(fnm==\"LINETO\"   ) {  \n            if(gst.pth.cmds.length==0) {  var im=gst.ctm.slice(0);  UDOC.M.invert(im);  var p = UDOC.M.multPoint(im, gst.cpos);  UDOC.G.moveTo(gst, p[0], p[1]);  }  \n            UDOC.G.lineTo(gst, rI32(buff,loff), rI32(buff,loff+4));  }\n        else if(fnm==\"POLYGON\" || fnm==\"POLYGON16\" || fnm==\"POLYLINE\" || fnm==\"POLYLINE16\" || fnm==\"POLYLINETO\" || fnm==\"POLYLINETO16\") {\n            loff+=16;\n            var ndf = fnm.startsWith(\"POLYGON\"), isTo = fnm.indexOf(\"TO\")!=-1;\n            var cnt = rU32(buff, loff);  loff+=4;\n            if(!isTo) UDOC.G.newPath(gst);\n            loff = FromEMF._drawPoly(buff,loff,cnt,gst, fnm.endsWith(\"16\")?2:4,  ndf, isTo);\n            if(!isTo) FromEMF._draw(genv,gst,prms, ndf);\n            //console.log(prms, gst.lwidth);\n            //console.log(JSON.parse(JSON.stringify(gst.pth)));\n        }\n        else if(fnm==\"POLYPOLYGON16\") {\n            loff+=16;\n            var ndf = fnm.startsWith(\"POLYPOLYGON\"), isTo = fnm.indexOf(\"TO\")!=-1;\n            var nop = rU32(buff, loff);  loff+=4;  loff+=4;\n            var pi = loff;  loff+= nop*4;\n            \n            if(!isTo) UDOC.G.newPath(gst);\n            for(var i=0; i<nop; i++) {\n                var ppp = rU(buff, pi+i*4);\n                loff = FromEMF._drawPoly(buff,loff,ppp,gst, fnm.endsWith(\"16\")?2:4, ndf, isTo);\n            }\n            if(!isTo) FromEMF._draw(genv,gst,prms, ndf);\n        }\n        else if(fnm==\"POLYBEZIER\" || fnm==\"POLYBEZIER16\" || fnm==\"POLYBEZIERTO\" || fnm==\"POLYBEZIERTO16\") {\n            loff+=16;\n            var is16 = fnm.endsWith(\"16\"), rC = is16?rI:rI32, nl = is16?2:4;\n            var cnt = rU32(buff, loff);  loff+=4;\n            if(fnm.indexOf(\"TO\")==-1) {\n                UDOC.G.moveTo(gst, rC(buff,loff), rC(buff,loff+nl));  loff+=2*nl;  cnt--;\n            }\n            while(cnt>0) {\n                UDOC.G.curveTo(gst, rC(buff,loff), rC(buff,loff+nl), rC(buff,loff+2*nl), rC(buff,loff+3*nl), rC(buff,loff+4*nl), rC(buff,loff+5*nl) );\n                loff+=6*nl;\n                cnt-=3;\n            }\n            //console.log(JSON.parse(JSON.stringify(gst.pth)));\n        }\n        else if(fnm==\"RECTANGLE\" || fnm==\"ELLIPSE\") {\n            UDOC.G.newPath(gst);\n            var bx = FromEMF._readBox(buff, loff);\n            if(fnm==\"RECTANGLE\") {\n                UDOC.G.moveTo(gst, bx[0],bx[1]);\n                UDOC.G.lineTo(gst, bx[2],bx[1]);\n                UDOC.G.lineTo(gst, bx[2],bx[3]);\n                UDOC.G.lineTo(gst, bx[0],bx[3]);\n            }\n            else {\n                var x = (bx[0]+bx[2])/2, y = (bx[1]+bx[3])/2;\n                UDOC.G.arc(gst,x,y,(bx[2]-bx[0])/2,0,2*Math.PI, false);\n            }\n            UDOC.G.closePath(gst);\n            FromEMF._draw(genv,gst,prms, true);\n            //console.log(prms, gst.lwidth);\n        }\n        else if(fnm==\"FILLPATH\"  ) genv.Fill(gst, false);\n        else if(fnm==\"STROKEPATH\") genv.Stroke(gst);\n        else if(fnm==\"STROKEANDFILLPATH\") {  genv.Fill(gst, false);  genv.Stroke(gst);  }\n        else if(fnm==\"SETWORLDTRANSFORM\" || fnm==\"MODIFYWORLDTRANSFORM\") {\n            var mat = [];\n            for(var i=0; i<6; i++) mat.push(rF32(buff,loff+i*4));  loff+=24;\n            //console.log(fnm, gst.ctm.slice(0), mat);\n            if(fnm==\"SETWORLDTRANSFORM\") gst.ctm=mat;\n            else {\n                var mod = rU32(buff,loff);  loff+=4;\n                if(mod==2) {  var om=gst.ctm;  gst.ctm=mat;  UDOC.M.concat(gst.ctm, om);  }\n                else throw \"e\";\n            }\n        }\n        else if(fnm==\"SETSTRETCHBLTMODE\") {  var sm = rU32(buff, loff);  loff+=4;  }\n        else if(fnm==\"STRETCHDIBITS\") {\n            var bx = FromEMF._readBox(buff, loff);  loff+=16;\n            var xD = rI32(buff, loff);  loff+=4;\n            var yD = rI32(buff, loff);  loff+=4;\n            var xS = rI32(buff, loff);  loff+=4;\n            var yS = rI32(buff, loff);  loff+=4;\n            var wS = rI32(buff, loff);  loff+=4;\n            var hS = rI32(buff, loff);  loff+=4;\n            var ofH = rU32(buff, loff)+off-8;  loff+=4;\n            var szH = rU32(buff, loff);  loff+=4;\n            var ofB = rU32(buff, loff)+off-8;  loff+=4;\n            var szB = rU32(buff, loff);  loff+=4;\n            var usg = rU32(buff, loff);  loff+=4;  if(usg!=0) throw \"e\";\n            var bop = rU32(buff, loff);  loff+=4;\n            var wD = rI32(buff, loff);  loff+=4;\n            var hD = rI32(buff, loff);  loff+=4;  //console.log(bop, wD, hD);\n            \n            //console.log(ofH, szH, ofB, szB, ofH+40);\n            //console.log(bx, xD,yD,wD,hD);\n            //console.log(xS,yS,wS,hS);\n            //console.log(ofH,szH,ofB,szB,usg,bop);\n            \n            var hl = rU32(buff, ofH);  ofH+=4;\n            var w  = rU32(buff, ofH);  ofH+=4;\n            var h  = rU32(buff, ofH);  ofH+=4;  if(w!=wS || h!=hS) throw \"e\";\n            var ps = rU  (buff, ofH);  ofH+=2;\n            var bc = rU  (buff, ofH);  ofH+=2;  if(bc!=8 && bc!=24 && bc!=32) throw bc+\" e\";\n            var cpr= rU32(buff, ofH);  ofH+=4;  if(cpr!=0) throw cpr+\" e\";\n            var sz = rU32(buff, ofH);  ofH+=4;\n            var xpm= rU32(buff, ofH);  ofH+=4;\n            var ypm= rU32(buff, ofH);  ofH+=4;\n            var cu = rU32(buff, ofH);  ofH+=4;\n            var ci = rU32(buff, ofH);  ofH+=4;  //console.log(hl, w, h, ps, bc, cpr, sz, xpm, ypm, cu, ci);\n            \n            //console.log(hl,w,h,\",\",xS,yS,wS,hS,\",\",xD,yD,wD,hD,\",\",xpm,ypm);\n            \n            var rl = Math.floor(((w * ps * bc + 31) & ~31) / 8);\n            var img = new Uint8Array(w*h*4);\n            if(bc==8) {\n                for(var y=0; y<h; y++) \n                    for(var x=0; x<w; x++) {\n                        var qi = (y*w+x)<<2, ind:any = buff[ofB+(h-1-y)*rl+x]<<2;\n                        img[qi  ] = buff[ofH+ind+2];\n                        img[qi+1] = buff[ofH+ind+1];\n                        img[qi+2] = buff[ofH+ind+0];\n                        img[qi+3] = 255;\n                    }\n            }\n            if(bc==24) {\n                for(var y=0; y<h; y++) \n                    for(var x=0; x<w; x++) {\n                        var qi = (y*w+x)<<2, ti=ofB+(h-1-y)*rl+x*3;\n                        img[qi  ] = buff[ti+2];\n                        img[qi+1] = buff[ti+1];\n                        img[qi+2] = buff[ti+0];\n                        img[qi+3] = 255;\n                    }\n            }\n            if(bc==32) {\n                for(var y=0; y<h; y++) \n                    for(var x=0; x<w; x++) {\n                        var qi = (y*w+x)<<2, ti=ofB+(h-1-y)*rl+x*4;\n                        img[qi  ] = buff[ti+2];\n                        img[qi+1] = buff[ti+1];\n                        img[qi+2] = buff[ti+0];\n                        img[qi+3] = buff[ti+3];\n                    }\n            }\n            \n            var ctm = gst.ctm.slice(0);\n            gst.ctm = [1,0,0,1,0,0];\n            UDOC.M.scale(gst.ctm, wD, -hD);\n            UDOC.M.translate(gst.ctm, xD, yD+hD);\n            UDOC.M.concat(gst.ctm, ctm);\n            genv.PutImage(gst, img, w, h);\n            gst.ctm = ctm;\n        }\n        else {\n            console.log(fnm, siz);\n        }\n        \n        if(obj!=null) tab[oid]=obj;\n        \n        off+=siz-8;\n    }\n    //genv.Stroke(gst);\n    genv.ShowPage();  genv.Done();\n}\nFromEMF._readBox = function(buff:any, off:any) {  var b=[];  for(var i=0; i<4; i++) b[i] = FromEMF.B.readInt(buff,off+i*4);  return b;  }\t\n\nFromEMF._updateCtm = function(prms:any, gst:any) {\n    var mat = [1,0,0,1,0,0];\n    var wbb = prms.wbb, bb = prms.bb, vbb=(prms.vbb && prms.vbb.length==4) ? prms.vbb:prms.bb;\n    \n    //var y0 = bb[1], y1 = bb[3];  bb[1]=Math.min(y0,y1);  bb[3]=Math.max(y0,y1);\n    \n    UDOC.M.translate(mat, -wbb[0],-wbb[1]);\n    UDOC.M.scale(mat, 1/wbb[2], 1/wbb[3]);\n    \n    UDOC.M.scale(mat, vbb[2], vbb[3]);\n    //UDOC.M.scale(mat, vbb[2]/(bb[2]-bb[0]), vbb[3]/(bb[3]-bb[1]));\n    \n    //UDOC.M.scale(mat, bb[2]-bb[0],bb[3]-bb[1]);\n    \n    gst.ctm = mat;\n}\nFromEMF._draw = function(genv:any, gst:any, prms:any, needFill:any) {\n    if(prms.fill && needFill     ) genv.Fill  (gst, false);\n    if(prms.strk && gst.lwidth!=0) genv.Stroke(gst);\n}\nFromEMF._drawPoly = function(buff:any, off:any, ppp:any, gst:any, nl:any, clos:any, justLine:any) {\n    var rS = nl==2 ? FromEMF.B.readShort : FromEMF.B.readInt;\n    for(var j=0; j<ppp; j++) {\n        var px = rS(buff, off);  off+=nl;  \n        var py = rS(buff, off);  off+=nl;\n        if(j==0 && !justLine) UDOC.G.moveTo(gst,px,py);  else UDOC.G.lineTo(gst,px,py);\n    }\n    if(clos) UDOC.G.closePath(gst);\n    return off;\n}\n\nFromEMF.B = {\n    uint8 : new Uint8Array(4),\n    readShort  : function(buff:any,p:any):any  {  var u8=FromEMF.B.uint8;  u8[0]=buff[p];  u8[1]=buff[p+1];  return FromEMF.B.int16 [0];  },\n    readUshort : function(buff:any,p:any):any  {  var u8=FromEMF.B.uint8;  u8[0]=buff[p];  u8[1]=buff[p+1];  return FromEMF.B.uint16[0];  },\n    readInt    : function(buff:any,p:any):any  {  var u8=FromEMF.B.uint8;  u8[0]=buff[p];  u8[1]=buff[p+1];  u8[2]=buff[p+2];  u8[3]=buff[p+3];  return FromEMF.B.int32 [0];  },\n    readUint   : function(buff:any,p:any):any  {  var u8=FromEMF.B.uint8;  u8[0]=buff[p];  u8[1]=buff[p+1];  u8[2]=buff[p+2];  u8[3]=buff[p+3];  return FromEMF.B.uint32[0];  },\n    readFloat  : function(buff:any,p:any):any  {  var u8=FromEMF.B.uint8;  u8[0]=buff[p];  u8[1]=buff[p+1];  u8[2]=buff[p+2];  u8[3]=buff[p+3];  return FromEMF.B.flot32[0];  },\n    readASCII  : function(buff:any,p:any,l:any):any {  var s = \"\";  for(var i=0; i<l; i++) s += String.fromCharCode(buff[p+i]);  return s;    }\n}\nFromEMF.B.int16  = new Int16Array (FromEMF.B.uint8.buffer);\nFromEMF.B.uint16 = new Uint16Array(FromEMF.B.uint8.buffer);\nFromEMF.B.int32  = new Int32Array (FromEMF.B.uint8.buffer);\nFromEMF.B.uint32 = new Uint32Array(FromEMF.B.uint8.buffer);\nFromEMF.B.flot32 = new Float32Array(FromEMF.B.uint8.buffer);\n\n\nFromEMF.C = {\n    EMR_HEADER : 0x00000001,\n    EMR_POLYBEZIER : 0x00000002,\n    EMR_POLYGON : 0x00000003,\n    EMR_POLYLINE : 0x00000004,\n    EMR_POLYBEZIERTO : 0x00000005,\n    EMR_POLYLINETO : 0x00000006,\n    EMR_POLYPOLYLINE : 0x00000007,\n    EMR_POLYPOLYGON : 0x00000008,\n    EMR_SETWINDOWEXTEX : 0x00000009,\n    EMR_SETWINDOWORGEX : 0x0000000A,\n    EMR_SETVIEWPORTEXTEX : 0x0000000B,\n    EMR_SETVIEWPORTORGEX : 0x0000000C,\n    EMR_SETBRUSHORGEX : 0x0000000D,\n    EMR_EOF : 0x0000000E,\n    EMR_SETPIXELV : 0x0000000F,\n    EMR_SETMAPPERFLAGS : 0x00000010,\n    EMR_SETMAPMODE : 0x00000011,\n    EMR_SETBKMODE : 0x00000012,\n    EMR_SETPOLYFILLMODE : 0x00000013,\n    EMR_SETROP2 : 0x00000014,\n    EMR_SETSTRETCHBLTMODE : 0x00000015,\n    EMR_SETTEXTALIGN : 0x00000016,\n    EMR_SETCOLORADJUSTMENT : 0x00000017,\n    EMR_SETTEXTCOLOR : 0x00000018,\n    EMR_SETBKCOLOR : 0x00000019,\n    EMR_OFFSETCLIPRGN : 0x0000001A,\n    EMR_MOVETOEX : 0x0000001B,\n    EMR_SETMETARGN : 0x0000001C,\n    EMR_EXCLUDECLIPRECT : 0x0000001D,\n    EMR_INTERSECTCLIPRECT : 0x0000001E,\n    EMR_SCALEVIEWPORTEXTEX : 0x0000001F,\n    EMR_SCALEWINDOWEXTEX : 0x00000020,\n    EMR_SAVEDC : 0x00000021,\n    EMR_RESTOREDC : 0x00000022,\n    EMR_SETWORLDTRANSFORM : 0x00000023,\n    EMR_MODIFYWORLDTRANSFORM : 0x00000024,\n    EMR_SELECTOBJECT : 0x00000025,\n    EMR_CREATEPEN : 0x00000026,\n    EMR_CREATEBRUSHINDIRECT : 0x00000027,\n    EMR_DELETEOBJECT : 0x00000028,\n    EMR_ANGLEARC : 0x00000029,\n    EMR_ELLIPSE : 0x0000002A,\n    EMR_RECTANGLE : 0x0000002B,\n    EMR_ROUNDRECT : 0x0000002C,\n    EMR_ARC : 0x0000002D,\n    EMR_CHORD : 0x0000002E,\n    EMR_PIE : 0x0000002F,\n    EMR_SELECTPALETTE : 0x00000030,\n    EMR_CREATEPALETTE : 0x00000031,\n    EMR_SETPALETTEENTRIES : 0x00000032,\n    EMR_RESIZEPALETTE : 0x00000033,\n    EMR_REALIZEPALETTE : 0x00000034,\n    EMR_EXTFLOODFILL : 0x00000035,\n    EMR_LINETO : 0x00000036,\n    EMR_ARCTO : 0x00000037,\n    EMR_POLYDRAW : 0x00000038,\n    EMR_SETARCDIRECTION : 0x00000039,\n    EMR_SETMITERLIMIT : 0x0000003A,\n    EMR_BEGINPATH : 0x0000003B,\n    EMR_ENDPATH : 0x0000003C,\n    EMR_CLOSEFIGURE : 0x0000003D,\n    EMR_FILLPATH : 0x0000003E,\n    EMR_STROKEANDFILLPATH : 0x0000003F,\n    EMR_STROKEPATH : 0x00000040,\n    EMR_FLATTENPATH : 0x00000041,\n    EMR_WIDENPATH : 0x00000042,\n    EMR_SELECTCLIPPATH : 0x00000043,\n    EMR_ABORTPATH : 0x00000044,\n    EMR_COMMENT : 0x00000046,\n    EMR_FILLRGN : 0x00000047,\n    EMR_FRAMERGN : 0x00000048,\n    EMR_INVERTRGN : 0x00000049,\n    EMR_PAINTRGN : 0x0000004A,\n    EMR_EXTSELECTCLIPRGN : 0x0000004B,\n    EMR_BITBLT : 0x0000004C,\n    EMR_STRETCHBLT : 0x0000004D,\n    EMR_MASKBLT : 0x0000004E,\n    EMR_PLGBLT : 0x0000004F,\n    EMR_SETDIBITSTODEVICE : 0x00000050,\n    EMR_STRETCHDIBITS : 0x00000051,\n    EMR_EXTCREATEFONTINDIRECTW : 0x00000052,\n    EMR_EXTTEXTOUTA : 0x00000053,\n    EMR_EXTTEXTOUTW : 0x00000054,\n    EMR_POLYBEZIER16 : 0x00000055,\n    EMR_POLYGON16 : 0x00000056,\n    EMR_POLYLINE16 : 0x00000057,\n    EMR_POLYBEZIERTO16 : 0x00000058,\n    EMR_POLYLINETO16 : 0x00000059,\n    EMR_POLYPOLYLINE16 : 0x0000005A,\n    EMR_POLYPOLYGON16 : 0x0000005B,\n    EMR_POLYDRAW16 : 0x0000005C,\n    EMR_CREATEMONOBRUSH : 0x0000005D,\n    EMR_CREATEDIBPATTERNBRUSHPT : 0x0000005E,\n    EMR_EXTCREATEPEN : 0x0000005F,\n    EMR_POLYTEXTOUTA : 0x00000060,\n    EMR_POLYTEXTOUTW : 0x00000061,\n    EMR_SETICMMODE : 0x00000062,\n    EMR_CREATECOLORSPACE : 0x00000063,\n    EMR_SETCOLORSPACE : 0x00000064,\n    EMR_DELETECOLORSPACE : 0x00000065,\n    EMR_GLSRECORD : 0x00000066,\n    EMR_GLSBOUNDEDRECORD : 0x00000067,\n    EMR_PIXELFORMAT : 0x00000068,\n    EMR_DRAWESCAPE : 0x00000069,\n    EMR_EXTESCAPE : 0x0000006A,\n    EMR_SMALLTEXTOUT : 0x0000006C,\n    EMR_FORCEUFIMAPPING : 0x0000006D,\n    EMR_NAMEDESCAPE : 0x0000006E,\n    EMR_COLORCORRECTPALETTE : 0x0000006F,\n    EMR_SETICMPROFILEA : 0x00000070,\n    EMR_SETICMPROFILEW : 0x00000071,\n    EMR_ALPHABLEND : 0x00000072,\n    EMR_SETLAYOUT : 0x00000073,\n    EMR_TRANSPARENTBLT : 0x00000074,\n    EMR_GRADIENTFILL : 0x00000076,\n    EMR_SETLINKEDUFIS : 0x00000077,\n    EMR_SETTEXTJUSTIFICATION : 0x00000078,\n    EMR_COLORMATCHTOTARGETW : 0x00000079,\n    EMR_CREATECOLORSPACEW : 0x0000007A\n};\nFromEMF.K = [];\n\n// (function() {\n//     var inp, out, stt;\n//     inp = FromEMF.C;   out = FromEMF.K;   stt=4;\n//     for(var p in inp) out[inp[p]] = p.slice(stt);\n// }  )();\n\n\n\nexport let ToContext2D:any = function (needPage:any, scale:any)\n{\n    this.canvas = document.createElement(\"canvas\");\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.bb = null;\n    this.currPage = 0;\n    this.needPage = needPage;\n    this.scale = scale;\n}\nToContext2D.prototype.StartPage = function(x:any,y:any,w:any,h:any) {\n    if(this.currPage!=this.needPage) return;\n    this.bb = [x,y,w,h];\n    var scl = this.scale, dpr = window.devicePixelRatio;\n    var cnv = this.canvas, ctx = this.ctx;\n    cnv.width = Math.round(w*scl);  cnv.height = Math.round(h*scl);\n    ctx.translate(0,h*scl);  ctx.scale(scl,-scl);\n    cnv.setAttribute(\"style\", \"border:1px solid; width:\"+(cnv.width/dpr)+\"px; height:\"+(cnv.height/dpr)+\"px\");\n}\nToContext2D.prototype.Fill = function(gst:any, evenOdd:any) {\n    if(this.currPage!=this.needPage) return;\n    var ctx = this.ctx;\n    ctx.beginPath();\n    this._setStyle(gst, ctx);\n    this._draw(gst.pth, ctx);\n    ctx.fill();\n}\nToContext2D.prototype.Stroke = function(gst:any) {\n    if(this.currPage!=this.needPage) return;\n    var ctx = this.ctx;\n    ctx.beginPath();\n    this._setStyle(gst, ctx);\n    this._draw(gst.pth, ctx);\n    ctx.stroke();\n}\nToContext2D.prototype.PutText = function(gst:any, str:any, stw:any) {\n    if(this.currPage!=this.needPage) return;\n    var scl = this._scale(gst.ctm);\n    var ctx = this.ctx;\n    this._setStyle(gst, ctx);\n    ctx.save();\n    var m = [1,0,0,-1,0,0];  this._concat(m, gst.font.Tm);  this._concat(m, gst.ctm);\n    //console.log(str, m, gst);  throw \"e\";\n    ctx.transform(m[0],m[1],m[2],m[3],m[4],m[5]);\n    ctx.fillText(str,0,0);\n    ctx.restore();\n}\nToContext2D.prototype.PutImage = function(gst:any, buff:any, w:any, h:any, msk:any) {\n    if(this.currPage!=this.needPage) return;\n    var ctx = this.ctx;\n    \n    if(buff.length==w*h*4) {\n        buff = buff.slice(0);\n        if(msk && msk.length==w*h*4) for(var i=0; i<buff.length; i+=4) buff[i+3] = msk[i+1];\n        \n        var cnv = document.createElement(\"canvas\"), cctx = cnv.getContext(\"2d\");\n        cnv.width = w;  cnv.height = h;\n        var imgd = cctx.createImageData(w,h);\n        for(var i=0; i<buff.length; i++) imgd.data[i]=buff[i];\n        cctx.putImageData(imgd,0,0);\n        \n        ctx.save();\n        var m = [1,0,0,1,0,0];  this._concat(m, [1/w,0,0,-1/h,0,1]);  this._concat(m, gst.ctm);\n        ctx.transform(m[0],m[1],m[2],m[3],m[4],m[5]);\n        ctx.drawImage(cnv,0,0);\n        ctx.restore();\n    }\n}\nToContext2D.prototype.ShowPage = function() {  this.currPage++;  }\nToContext2D.prototype.Done = function() {}\n\n\nfunction _flt(n:any)  {  return \"\"+parseFloat(n.toFixed(2));  }\n\nToContext2D.prototype._setStyle = function(gst:any, ctx:any) {\n    var scl = this._scale(gst.ctm);\n    ctx.fillStyle = this._getFill(gst.colr, gst.ca, ctx);\n    ctx.strokeStyle=this._getFill(gst.COLR, gst.CA, ctx);\n    \n    ctx.lineCap = [\"butt\",\"round\",\"square\"][gst.lcap];\n    ctx.lineJoin= [\"miter\",\"round\",\"bevel\"][gst.ljoin];\n    ctx.lineWidth=gst.lwidth*scl;\n    var dsh = gst.dash.slice(0);  for(var i=0; i<dsh.length; i++) dsh[i] = _flt(dsh[i]*scl);\n    ctx.setLineDash(dsh); \n    ctx.miterLimit = gst.mlimit*scl;\n    \n    var fn = gst.font.Tf, ln = fn.toLowerCase();\n    var p0 = ln.indexOf(\"bold\")!=-1 ? \"bold \" : \"\";\n    var p1 = (ln.indexOf(\"italic\")!=-1 || ln.indexOf(\"oblique\")!=-1) ? \"italic \" : \"\";\n    ctx.font = p0+p1 + gst.font.Tfs+\"px \\\"\"+fn+\"\\\"\";\n}\nToContext2D.prototype._getFill = function(colr:any, ca:any, ctx:any)\n{\n    if(colr.typ==null) return this._colr(colr,ca);\n    else {\n        var grd = colr, crd = grd.crds, mat = grd.mat, scl=this._scale(mat), gf;\n        if     (grd.typ==\"lin\") {\n            var p0 = this._multPoint(mat,crd.slice(0,2)), p1 = this._multPoint(mat,crd.slice(2));\n            gf=ctx.createLinearGradient(p0[0],p0[1],p1[0],p1[1]);\n        }\n        else if(grd.typ==\"rad\") {\n            var p0 = this._multPoint(mat,crd.slice(0,2)), p1 = this._multPoint(mat,crd.slice(3));\n            gf=ctx.createRadialGradient(p0[0],p0[1],crd[2]*scl,p1[0],p1[1],crd[5]*scl);\n        }\n        for(var i=0; i<grd.grad.length; i++)  gf.addColorStop(grd.grad[i][0],this._colr(grd.grad[i][1], ca));\n        return gf;\n    }\n}\nToContext2D.prototype._colr  = function(c:any,a:any) {  return \"rgba(\"+Math.round(c[0]*255)+\",\"+Math.round(c[1]*255)+\",\"+Math.round(c[2]*255)+\",\"+a+\")\";  };\nToContext2D.prototype._scale = function(m:any)  {  return Math.sqrt(Math.abs(m[0]*m[3]-m[1]*m[2]));  };\nToContext2D.prototype._concat= function(m:any,w:any  ) {  \n        var a=m[0],b=m[1],c=m[2],d=m[3],tx=m[4],ty=m[5];\n        m[0] = (a *w[0])+(b *w[2]);       m[1] = (a *w[1])+(b *w[3]);\n        m[2] = (c *w[0])+(d *w[2]);       m[3] = (c *w[1])+(d *w[3]);\n        m[4] = (tx*w[0])+(ty*w[2])+w[4];  m[5] = (tx*w[1])+(ty*w[3])+w[5]; \n}\nToContext2D.prototype._multPoint= function(m:any, p:any) {  var x=p[0],y=p[1];  return [x*m[0]+y*m[2]+m[4],   x*m[1]+y*m[3]+m[5]];  },\nToContext2D.prototype._draw  = function(path:any, ctx:any)\n{\n    var c = 0, crds = path.crds;\n    for(var j=0; j<path.cmds.length; j++) {\n        var cmd = path.cmds[j];\n        if     (cmd==\"M\") {  ctx.moveTo(crds[c], crds[c+1]);  c+=2;  }\n        else if(cmd==\"L\") {  ctx.lineTo(crds[c], crds[c+1]);  c+=2;  }\n        else if(cmd==\"C\") {  ctx.bezierCurveTo(crds[c], crds[c+1], crds[c+2], crds[c+3], crds[c+4], crds[c+5]);  c+=6;  }\n        else if(cmd==\"Q\") {  ctx.quadraticCurveTo(crds[c], crds[c+1], crds[c+2], crds[c+3]);  c+=4;  }\n        else if(cmd==\"Z\") {  ctx.closePath();  }\n    }\n}\n","import { IluckyImage } from \"./ILuck\";\nimport {LuckySheetCelldata} from \"./LuckyCell\";\nimport { IuploadfileList, IattributeList } from \"../ICommon\";\nimport {getXmlAttibute, getColumnWidthPixel, fromulaRef,getRowHeightPixel,getcellrange} from \"../common/method\";\nimport {borderTypes} from \"../common/constant\";\nimport { ReadXml, IStyleCollections, Element,getColor } from \"./ReadXml\";\nimport { LuckyImageBase } from \"./LuckyBase\";\nimport { UDOC,FromEMF,ToContext2D  } from \"../common/emf\";\n\n\nexport class ImageList {\n    private images:IattributeList\n    constructor(files:IuploadfileList) {\n        if(files==null){\n            return;\n        }\n        this.images = {};\n        for(let fileKey in files){\n            // let reg = new RegExp(\"xl/media/image1.png\", \"g\");\n            if(fileKey.indexOf(\"xl/media/\")>-1){\n                let fileNameArr = fileKey.split(\".\");\n                let suffix = fileNameArr[fileNameArr.length-1].toLowerCase();\n                if(suffix in {\"png\":1, \"jpeg\":1, \"jpg\":1, \"gif\":1,\"bmp\":1,\"tif\":1,\"webp\":1,\"emf\":1}){\n                    if(suffix==\"emf\"){\n                        var pNum  = 0;  // number of the page, that you want to render\n                        var scale = 1;  // the scale of the document\n                        var wrt = new ToContext2D(pNum, scale);\n                        var inp, out, stt;\n                        FromEMF.K = [];\n                        inp = FromEMF.C;   out = FromEMF.K;   stt=4;\n                        for(var p in inp) out[inp[p]] = p.slice(stt);\n                        FromEMF.Parse(files[fileKey], wrt);\n                        this.images[fileKey] = wrt.canvas.toDataURL(\"image/png\");\n                    }\n                    else{\n                        this.images[fileKey] = files[fileKey];\n                    }\n                    \n                }\n            }\n        }\n    }\n\n    getImageByName(pathName:string):Image{\n        if(pathName in this.images){\n            let base64 = this.images[pathName];\n            return new Image(pathName, base64);\n        }\n        return null;\n    }\n}\n\n\nclass Image extends LuckyImageBase {\n\n    fromCol:number\n    fromColOff:number\n    fromRow:number\n    fromRowOff:number\n\n    toCol:number\n    toColOff:number\n    toRow:number\n    toRowOff:number\n\n    constructor(pathName:string, base64:string) {\n        super();\n        this.src = base64;\n    }\n\n    setDefault(){\n\n    }\n}","﻿import { ILuckyFile,IluckySheetRowAndColumnHidden,IluckySheetRowAndColumnLen} from \"./ILuck\";\nimport { LuckySheet} from \"./LuckySheet\";\nimport {IuploadfileList, IattributeList} from \"../ICommon\";\nimport {workBookFile, coreFile, appFile, stylesFile, sharedStringsFile,numFmtDefault,theme1File,calcChainFile,workbookRels, numFmtDefaultMap} from \"../common/constant\";\nimport { ReadXml,IStyleCollections,Element } from \"./ReadXml\";\nimport {getXmlAttibute} from \"../common/method\";\nimport { LuckyFileBase,LuckyFileInfo,LuckySheetBase,LuckySheetCelldataBase,LuckySheetCelldataValue,LuckySheetCellFormat } from \"./LuckyBase\";\nimport {ImageList} from \"./LuckyImage\";\n\nexport class LuckyFile extends LuckyFileBase {\n\n    private files:IuploadfileList\n    private sheetNameList:IattributeList\n    private readXml:ReadXml\n    private fileName:string\n    private styles:IStyleCollections\n    private sharedStrings:Element[]\n    private calcChain:Element[]\n    private imageList:ImageList\n\n    constructor(files:IuploadfileList, fileName:string) {\n        super();\n        this.files = files;\n        this.fileName = fileName;\n        this.readXml = new ReadXml(files);\n        this.getSheetNameList();\n\n        this.sharedStrings = this.readXml.getElementsByTagName(\"sst/si\", sharedStringsFile);\n        this.calcChain = this.readXml.getElementsByTagName(\"calcChain/c\", calcChainFile);\n        this.styles = {};\n        this.styles[\"cellXfs\"] =  this.readXml.getElementsByTagName(\"cellXfs/xf\", stylesFile);\n        this.styles[\"cellStyleXfs\"] =  this.readXml.getElementsByTagName(\"cellStyleXfs/xf\", stylesFile);\n        this.styles[\"cellStyles\"] =  this.readXml.getElementsByTagName(\"cellStyles/cellStyle\", stylesFile);\n        this.styles[\"fonts\"] =  this.readXml.getElementsByTagName(\"fonts/font\", stylesFile);\n        this.styles[\"fills\"] =  this.readXml.getElementsByTagName(\"fills/fill\", stylesFile);\n        this.styles[\"borders\"] =  this.readXml.getElementsByTagName(\"borders/border\", stylesFile);\n        this.styles[\"clrScheme\"] =  this.readXml.getElementsByTagName(\"a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink\", theme1File);\n        this.styles[\"indexedColors\"] =  this.readXml.getElementsByTagName(\"colors/indexedColors/rgbColor\", stylesFile);\n        this.styles[\"mruColors\"] =  this.readXml.getElementsByTagName(\"colors/mruColors/color\", stylesFile);\n\n        this.imageList = new ImageList(files);\n\n        let numfmts =  this.readXml.getElementsByTagName(\"numFmt/numFmt\", stylesFile);\n        let numFmtDefaultC = JSON.parse(JSON.stringify(numFmtDefault));\n        for(let i=0;i<numfmts.length;i++){\n            let attrList = numfmts[i].attributeList;\n            let numfmtid = getXmlAttibute(attrList, \"numFmtId\", \"49\");\n            let formatcode = getXmlAttibute(attrList, \"formatCode\", \"@\");\n            // console.log(numfmtid, formatcode);\n            if(!(numfmtid in numFmtDefault)){\n                numFmtDefaultC[numfmtid] = numFmtDefaultMap[formatcode] || formatcode;\n            }\n        }\n\n        // console.log(JSON.stringify(numFmtDefaultC), numfmts);\n        this.styles[\"numfmts\"] =  numFmtDefaultC;\n    }\n\n    /**\n    * @return All sheet name of workbook\n    */\n    private getSheetNameList(){\n        let workbookRelList = this.readXml.getElementsByTagName(\"Relationships/Relationship\", workbookRels);\n        if(workbookRelList==null){\n            return;\n        }\n\n        let regex = new RegExp(\"worksheets/[^/]*?.xml\");\n        let sheetNames:IattributeList = {};\n        for(let i=0;i<workbookRelList.length;i++){\n            let rel = workbookRelList[i], attrList = rel.attributeList;\n            let id = attrList[\"Id\"], target = attrList[\"Target\"];\n            if(regex.test(target)){\n                if(target.indexOf('/xl') === 0){\n                    sheetNames[id] =   target.substr(1);\n                }else{\n                    sheetNames[id] =   \"xl/\" + target;\n                }\n            }\n\n        }\n\n        this.sheetNameList = sheetNames;\n    }\n\n    /**\n    * @param sheetName WorkSheet'name\n    * @return sheet file name and path in zip\n    */\n   private getSheetFileBysheetId(sheetId:string){\n        // for(let i=0;i<this.sheetNameList.length;i++){\n        //     let sheetFileName = this.sheetNameList[i];\n        //     if(sheetFileName.indexOf(\"sheet\"+sheetId)>-1){\n        //         return sheetFileName;\n        //     }\n        // }\n        return this.sheetNameList[sheetId];\n    }\n\n    /**\n    * @return workBook information\n    */\n    getWorkBookInfo(){\n        let Company = this.readXml.getElementsByTagName(\"Company\", appFile);\n        let AppVersion = this.readXml.getElementsByTagName(\"AppVersion\", appFile);\n        let creator = this.readXml.getElementsByTagName(\"dc:creator\", coreFile);\n        let lastModifiedBy = this.readXml.getElementsByTagName(\"cp:lastModifiedBy\", coreFile);\n        let created = this.readXml.getElementsByTagName(\"dcterms:created\", coreFile);\n        let modified = this.readXml.getElementsByTagName(\"dcterms:modified\", coreFile);\n        this.info = new LuckyFileInfo();\n        this.info.name = this.fileName;\n        this.info.creator = creator.length>0?creator[0].value:\"\";\n        this.info.lastmodifiedby = lastModifiedBy.length>0?lastModifiedBy[0].value:\"\";\n        this.info.createdTime = created.length>0?created[0].value:\"\";\n        this.info.modifiedTime = modified.length>0?modified[0].value:\"\";\n        this.info.company = Company.length>0?Company[0].value:\"\";\n        this.info.appversion = AppVersion.length>0?AppVersion[0].value:\"\";\n    }\n\n    /**\n    * @return All sheet , include whole information\n    */\n    getSheetsFull(isInitialCell:boolean=true){\n        let sheets = this.readXml.getElementsByTagName(\"sheets/sheet\", workBookFile);\n        let sheetList:IattributeList = {};\n        for(let key in sheets){\n            let sheet = sheets[key];\n            sheetList[sheet.attributeList.name] = sheet.attributeList[\"sheetId\"];\n        }\n        this.sheets = [];\n        let order = 0;\n        for(let key in sheets){\n            let sheet = sheets[key];\n            let sheetName = sheet.attributeList.name;\n            let sheetId = sheet.attributeList[\"sheetId\"];\n            let rid = sheet.attributeList[\"r:id\"];\n            let sheetFile = this.getSheetFileBysheetId(rid);\n            let hide = sheet.attributeList.state === \"hidden\" ? 1 : 0;\n\n            let drawing = this.readXml.getElementsByTagName(\"worksheet/drawing\", sheetFile), drawingFile, drawingRelsFile;\n            if(drawing!=null && drawing.length>0){\n                let attrList = drawing[0].attributeList;\n                let rid = getXmlAttibute(attrList, \"r:id\", null);\n                if(rid!=null){\n                    drawingFile = this.getDrawingFile(rid, sheetFile);\n                    drawingRelsFile = this.getDrawingRelsFile(drawingFile);\n                }\n            }\n\n            if(sheetFile!=null){\n                let sheet = new LuckySheet(sheetName, sheetId, order, isInitialCell,\n                    {\n                        sheetFile:sheetFile,\n                        readXml:this.readXml,\n                        sheetList:sheetList,\n                        styles:this.styles,\n                        sharedStrings:this.sharedStrings,\n                        calcChain:this.calcChain,\n                        imageList:this.imageList,\n                        drawingFile:drawingFile,\n                        drawingRelsFile: drawingRelsFile,\n                        hide: hide,\n                    }\n                )\n                this.columnWidthSet = [];\n                this.rowHeightSet = [];\n\n                this.imagePositionCaculation(sheet);\n\n                this.sheets.push(sheet);\n                order++;\n            }\n        }\n    }\n\n    private columnWidthSet:number[] = [];\n    private rowHeightSet:number[] = [];\n\n    private extendArray(index:number, sets:number[],def:number, hidden:IluckySheetRowAndColumnHidden, lens:IluckySheetRowAndColumnLen){\n        if(index<sets.length){\n            return;\n        }\n\n        let startIndex = sets.length, endIndex = index;\n        let allGap = 0;\n        if(startIndex>0){\n            allGap = sets[startIndex-1];\n        }\n        // else{\n        //     sets.push(0);\n        // }\n        for(let i=startIndex;i<=endIndex;i++){\n            let gap = def, istring  = i.toString();\n            if(istring in hidden){\n                gap = 0;\n            }\n            else if(istring in lens){\n                gap = lens[istring];\n            }\n\n            allGap += Math.round(gap + 1);\n\n            sets.push(allGap);\n        }\n    }\n\n    private imagePositionCaculation(sheet:LuckySheet){\n        let images = sheet.images, defaultColWidth = sheet.defaultColWidth, defaultRowHeight = sheet.defaultRowHeight;\n        let colhidden = {};\n        if(sheet.config.colhidden){\n            colhidden = sheet.config.colhidden;\n        }\n\n        let columnlen = {};\n        if(sheet.config.columnlen){\n            columnlen = sheet.config.columnlen;\n        }\n\n        let rowhidden = {};\n        if(sheet.config.rowhidden){\n            rowhidden = sheet.config.rowhidden;\n        }\n\n        let rowlen = {};\n        if(sheet.config.rowlen){\n            rowlen = sheet.config.rowlen;\n        }\n\n        for(let key in images){\n            let imageObject:any = images[key];//Image, luckyImage\n            let fromCol = imageObject.fromCol;\n            let fromColOff = imageObject.fromColOff;\n            let fromRow = imageObject.fromRow;\n            let fromRowOff = imageObject.fromRowOff;\n\n            let toCol = imageObject.toCol;\n            let toColOff = imageObject.toColOff;\n            let toRow = imageObject.toRow;\n            let toRowOff = imageObject.toRowOff;\n\n            let x_n =0,y_n = 0;\n            let cx_n = 0, cy_n = 0;\n\n            if(fromCol>=this.columnWidthSet.length){\n                this.extendArray(fromCol, this.columnWidthSet, defaultColWidth, colhidden, columnlen);\n            }\n            if(fromCol==0){\n                x_n = 0;\n            }\n            else{\n                x_n = this.columnWidthSet[fromCol-1];\n            }\n            x_n = x_n + fromColOff;\n\n            if(fromRow>=this.rowHeightSet.length){\n                this.extendArray(fromRow, this.rowHeightSet, defaultRowHeight, rowhidden, rowlen);\n            }\n            if(fromRow==0){\n                y_n = 0;\n            }\n            else{\n                y_n = this.rowHeightSet[fromRow-1];\n            }\n            y_n = y_n + fromRowOff;\n\n\n            if(toCol>=this.columnWidthSet.length){\n                this.extendArray(toCol, this.columnWidthSet, defaultColWidth, colhidden, columnlen);\n            }\n            if(toCol==0){\n                cx_n = 0;\n            }\n            else{\n                cx_n = this.columnWidthSet[toCol-1];\n            }\n            cx_n = cx_n + toColOff- x_n;\n\n            if(toRow>=this.rowHeightSet.length){\n                this.extendArray(toRow, this.rowHeightSet, defaultRowHeight, rowhidden, rowlen);\n            }\n            if(toRow==0){\n                cy_n = 0;\n            }\n            else{\n                cy_n = this.rowHeightSet[toRow-1];\n            }\n\n            cy_n = cy_n + toRowOff - y_n;\n\n            console.log(defaultColWidth, colhidden , columnlen);\n            console.log(fromCol, this.columnWidthSet[fromCol] , fromColOff);\n            console.log(toCol, this.columnWidthSet[toCol] , toColOff, JSON.stringify(this.columnWidthSet));\n\n            imageObject.originWidth = cx_n;\n            imageObject.originHeight = cy_n;\n\n            imageObject.crop.height = cy_n;\n            imageObject.crop.width = cx_n;\n\n            imageObject.default.height = cy_n;\n            imageObject.default.left = x_n;\n            imageObject.default.top = y_n;\n            imageObject.default.width = cx_n;\n        }\n\n        //console.log(this.columnWidthSet, this.rowHeightSet);\n    }\n\n    /**\n    * @return drawing file string\n    */\n   private getDrawingFile(rid:string, sheetFile:string):string{\n        let sheetRelsPath = \"xl/worksheets/_rels/\";\n        let sheetFileArr = sheetFile.split(\"/\");\n        let sheetRelsName = sheetFileArr[sheetFileArr.length-1];\n\n        let sheetRelsFile = sheetRelsPath + sheetRelsName + \".rels\";\n\n        let drawing = this.readXml.getElementsByTagName(\"Relationships/Relationship\", sheetRelsFile);\n        if(drawing.length>0){\n            for(let i=0;i<drawing.length;i++){\n                let relationship = drawing[i];\n                let attrList = relationship.attributeList;\n                let relationshipId = getXmlAttibute(attrList, \"Id\", null);\n                if(relationshipId==rid){\n                    let target = getXmlAttibute(attrList, \"Target\", null);\n                    if(target!=null){\n                        return target.replace(/\\.\\.\\//g, \"\");\n                    }\n                }\n            }\n        }\n\n        return null;\n    }\n    private getDrawingRelsFile(drawingFile:string):string{\n        let drawingRelsPath = \"xl/drawings/_rels/\";\n        let drawingFileArr = drawingFile.split(\"/\");\n        let drawingRelsName = drawingFileArr[drawingFileArr.length-1];\n\n        let drawingRelsFile = drawingRelsPath + drawingRelsName + \".rels\";\n\n        return drawingRelsFile;\n    }\n\n    /**\n    * @return All sheet base information widthout cell and config\n    */\n    getSheetsWithoutCell(){\n        this.getSheetsFull(false);\n    }\n\n    /**\n    * @return LuckySheet file json\n    */\n    Parse():string{\n        // let xml = this.readXml;\n        // for(let key in this.sheetNameList){\n        //     let sheetName=this.sheetNameList[key];\n        //     let sheetColumns = xml.getElementsByTagName(\"row/c/f\", sheetName);\n        //     console.log(sheetColumns);\n        // }\n        // return \"\";\n\n        this.getWorkBookInfo();\n        this.getSheetsFull();\n\n        // for(let i=0;i<this.sheets.length;i++){\n        //     let sheet = this.sheets[i];\n        //     let _borderInfo = sheet.config._borderInfo;\n        //     if(_borderInfo==null){\n        //         continue;\n        //     }\n        //     let _borderInfoKeys = Object.keys(_borderInfo);\n        //     _borderInfoKeys.sort();\n        //     for(let a=0;a<_borderInfoKeys.length;a++){\n        //         let key = parseInt(_borderInfoKeys[a]);\n        //         let b = _borderInfo[key];\n        //         if(b.cells.length==0){\n        //             continue;\n        //         }\n        //         if(sheet.config.borderInfo==null){\n        //             sheet.config.borderInfo = [];\n        //         }\n        //         sheet.config.borderInfo.push(b);\n        //     }\n        // }\n\n        return this.toJsonString(this);\n    }\n\n    private toJsonString(file:ILuckyFile):string{\n        let LuckyOutPutFile = new LuckyFileBase();\n        LuckyOutPutFile.info = file.info;\n        LuckyOutPutFile.sheets = [];\n\n        file.sheets.forEach((sheet)=>{\n            let sheetout = new LuckySheetBase();\n            //let attrName = [\"name\",\"color\",\"config\",\"index\",\"status\",\"order\",\"row\",\"column\",\"luckysheet_select_save\",\"scrollLeft\",\"scrollTop\",\"zoomRatio\",\"showGridLines\",\"defaultColWidth\",\"defaultRowHeight\",\"celldata\",\"chart\",\"isPivotTable\",\"pivotTable\",\"luckysheet_conditionformat_save\",\"freezen\",\"calcChain\"];\n\n            if(sheet.name!=null){\n                sheetout.name = sheet.name;\n            }\n\n            if(sheet.color!=null){\n                sheetout.color = sheet.color;\n            }\n\n            if(sheet.config!=null){\n                sheetout.config = sheet.config;\n                // if(sheetout.config._borderInfo!=null){\n                //     delete sheetout.config._borderInfo;\n                // }\n            }\n\n            if(sheet.index!=null){\n                sheetout.index = sheet.index;\n            }\n\n            if(sheet.status!=null){\n                sheetout.status = sheet.status;\n            }\n\n            if(sheet.order!=null){\n                sheetout.order = sheet.order;\n            }\n\n            if(sheet.row!=null){\n                sheetout.row = sheet.row;\n            }\n\n            if(sheet.column!=null){\n                sheetout.column = sheet.column;\n            }\n\n            if(sheet.luckysheet_select_save!=null){\n                sheetout.luckysheet_select_save = sheet.luckysheet_select_save;\n            }\n\n            if(sheet.scrollLeft!=null){\n                sheetout.scrollLeft = sheet.scrollLeft;\n            }\n\n            if(sheet.scrollTop!=null){\n                sheetout.scrollTop = sheet.scrollTop;\n            }\n\n            if(sheet.zoomRatio!=null){\n                sheetout.zoomRatio = sheet.zoomRatio;\n            }\n\n            if(sheet.showGridLines!=null){\n                sheetout.showGridLines = sheet.showGridLines;\n            }\n\n            if(sheet.defaultColWidth!=null){\n                sheetout.defaultColWidth = sheet.defaultColWidth;\n            }\n\n            if(sheet.defaultRowHeight!=null){\n                sheetout.defaultRowHeight = sheet.defaultRowHeight;\n            }\n\n            if(sheet.celldata!=null){\n                // sheetout.celldata = sheet.celldata;\n                sheetout.celldata = [];\n                sheet.celldata.forEach((cell)=>{\n                    let cellout = new LuckySheetCelldataBase();\n                    cellout.r = cell.r;\n                    cellout.c = cell.c;\n                    cellout.v = cell.v;\n                    sheetout.celldata.push(cellout);\n                });\n            }\n\n            if(sheet.chart!=null){\n                sheetout.chart = sheet.chart;\n            }\n\n            if(sheet.isPivotTable!=null){\n                sheetout.isPivotTable = sheet.isPivotTable;\n            }\n\n            if(sheet.pivotTable!=null){\n                sheetout.pivotTable = sheet.pivotTable;\n            }\n\n            if(sheet.luckysheet_conditionformat_save!=null){\n                sheetout.luckysheet_conditionformat_save = sheet.luckysheet_conditionformat_save;\n            }\n\n            if(sheet.freezen!=null){\n                sheetout.freezen = sheet.freezen;\n            }\n\n            if(sheet.calcChain!=null){\n                sheetout.calcChain = sheet.calcChain;\n            }\n\n            if(sheet.images!=null){\n                sheetout.images = sheet.images;\n            }\n          \n            if (sheet.dataVerification != null){\n              sheetout.dataVerification = sheet.dataVerification;\n            }\n          \n            if (sheet.hyperlink != null){\n                sheetout.hyperlink = sheet.hyperlink;\n            }\n          \n            if (sheet.hide != null) {\n              sheetout.hide = sheet.hide;\n            }\n            \n            LuckyOutPutFile.sheets.push(sheetout);\n        });\n\n        return JSON.stringify(LuckyOutPutFile);\n    }\n\n\n}\n","import XLSX from 'xlsx-js-style';\nimport {verticalMap, horizontalMap, wrapTextMap, textRotationMap, ErrorValueMap} from '../common/constant'\nimport {rgbToHex} from '../common/method'\n\nexport class WorkCellBase {\n  key: string\n  data: any\n}\n\nexport class WorkCell extends WorkCellBase {\n  constructor(data: any) {\n    super()\n    const {r, c} = data\n    const {ct, v, m, f, vt, ht, tb, tr, bg, fc, bl, it, cl, un, fs, ff} = data.v || {}\n\n    this.key = XLSX.utils.encode_cell({ c, r })\n    this.data = {v: '', t: 's', s: {}}\n\n    if (ct) {\n      if (v) {\n        // 错误时 值有特定mapping\n        if (ErrorValueMap[v] !== undefined) {\n          this.data.v = ErrorValueMap[v]\n        } else {\n          this.data.v = v\n        }\n        \n        this.data.t = ct.t\n      } else if (Array.isArray(ct?.s)) {\n        // inline string格式的简易处理\n        this.data.t = 's'\n        this.data.v = ct?.s?.reduce((prev: any, cur: { v: any; }) => prev + cur.v, '');\n      }\n\n      // 数字 & 错误\n      if (ct?.t === 'n' && ct?.t === 'e') {\n        this.data.t = ct.t\n        this.data.z = ct.fa\n        f && (this.data.f = f)\n      }\n\n      // 日期\n      if (ct?.t === 'd') {\n        // 如果类型规定为d 解析日期不对\n        this.data.t = 'n'\n        this.data.z = 'm/d/yy'\n        this.data.s = {numFmt: 'm/d/yy'}\n      }\n\n      // 字符串\n      if (ct?.t === 'g') {\n        this.data.t = 's'\n        this.data.w = ct.fa\n      }\n\n    }\n\n    // 对齐方式 换行 文字方向\n    if ([vt, ht, tb, tr].some((item) => item !== undefined)) {\n      this.data.s.alignment = {}\n      vt !== undefined && (this.data.s.alignment.vertical = verticalMap[vt])\n      ht !== undefined && (this.data.s.alignment.horizontal = horizontalMap[ht])\n      tb !== undefined && (this.data.s.alignment.wrapText = wrapTextMap[tb])\n      tr !== undefined && (this.data.s.alignment.textRotation = textRotationMap[tr])\n    }\n\n    // 背景色\n    if (bg) {\n      this.data.s.fill = {\n        fgColor: {rgb: rgbToHex(bg)?.replace('#', '') || 'ffffff'}\n      }\n    }\n\n    // 文本样式\n    if ([fc, bl, it, cl, un, fs].some((item) => item !== undefined)) {\n      this.data.s.font = {}\n      fc !== undefined && (this.data.s.font.color = {rgb: rgbToHex(fc)?.replace('#', '') || '000000'})\n      bl !== undefined && (this.data.s.font.bold = !!bl)\n      bl !== undefined && (this.data.s.font.italic = !!it)\n      cl !== undefined && (this.data.s.font.strike = !!cl)\n      un !== undefined && (this.data.s.font.underline = !!un)\n      fs !== undefined && (this.data.s.font.sz = fs)\n      // 字体种类可能缺失造成不匹配 暂时去掉\n      // ff !== undefined && (this.data.s.font.name = ff)\n    }\n  }\n\n  toData() {\n    const data = this.data\n    // const borderInfo = this.border.get(this.key)\n    // if (borderInfo && Object.keys(borderInfo).length !== 0) {\n    //   data.s = {border: {...borderInfo}}\n    // }\n    return data\n  }\n}","import XLSX from 'xlsx-js-style';\nimport {excelBorderPositions, excelBorderStyles} from '../common/constant'\nimport {rgbToHex} from '../common/method'\n\nexport class BorderInfoBase {\n  data: Record<string, any>\n}\n\nexport class BorderInfo extends BorderInfoBase {\n  constructor(data: any){\n    super()\n    this.data = {}\n    data?.forEach((item: any) => {\n      const {rangeType} = item;\n      // 旧版excel导入时生成的borderinfo\n      if (rangeType === 'cell') {\n        const {value} = item;\n        const cellKey = XLSX.utils.encode_cell({ c: value.col_index, r: value.row_index });\n        this.data[cellKey] = {};\n        ['t', 'b', 'l', 'r'].forEach((p) => {\n          const borderStyle = value[p]\n          if (borderStyle && excelBorderPositions[p]) {\n            this.data[cellKey][excelBorderPositions[p]] = {\n              style: excelBorderStyles[borderStyle.style] || 'thin',\n              color: {rgb: rgbToHex(borderStyle.color)?.replace('#', '') || '000000'}\n            }\n          }\n        })\n      }\n      // 新版luckysheet操作生成的borderinfo\n      if (rangeType === 'range') {\n        const {color, style, range = [], borderType} = item\n        const borderStyle = {\n          style: excelBorderStyles[style] || 'thin',\n          color: {rgb: rgbToHex(color)?.replace('#', '') || '000000'}\n        }\n\n        for(let rangeItem of range){\n          const [rangeStartRow, rangeEndRow] = rangeItem.row\n          const [rangeStartCol, rangeEndCol] = rangeItem.column\n  \n          for(let row = rangeStartRow; row <= rangeEndRow; row++){\n              for(let col = rangeStartCol; col <= rangeEndCol; col++){\n                const cellKey = XLSX.utils.encode_cell({ c: col, r: row });\n                this.data[cellKey] = {}\n                // 检查上下左右边的情况，按需添加边框\n                if (borderType === 'border-none') {\n                  this.data[cellKey] = null\n                } else if (borderType === 'border-all') {\n                  this.data[cellKey].top = borderStyle;\n                  this.data[cellKey].bottom = borderStyle;\n                  this.data[cellKey].left = borderStyle;\n                  this.data[cellKey].right = borderStyle;\n                } else {\n                  const isOnTop = isOnTopBorder({row: row, column: col}, rangeItem.row, rangeItem.column)\n                  const isOnBottom = isOnBottomBorder({row: row, column: col}, rangeItem.row, rangeItem.column)\n                  const isOnRight = isOnRightBorder({row: row, column: col}, rangeItem.row, rangeItem.column)\n                  const isOnLeft = isOnLeftBorder({row: row, column: col}, rangeItem.row, rangeItem.column)\n                  \n                  if (['border-top', 'border-outside'].includes(borderType) && isOnTop) {\n                    this.data[cellKey].top = borderStyle;\n                  }\n                  if (['border-bottom', 'border-outside'].includes(borderType) && isOnBottom) {\n                    this.data[cellKey].bottom = borderStyle;\n                  }\n                  if (['border-right', 'border-outside'].includes(borderType) && isOnRight) {\n                    this.data[cellKey].right = borderStyle;\n                  }\n                  if (['border-left', 'border-outside'].includes(borderType) && isOnLeft) {\n                    this.data[cellKey].left = borderStyle;\n                  }\n                  if (borderType === 'border-inside') {\n                    !isOnTop && (this.data[cellKey].top = borderStyle)\n                    !isOnBottom && (this.data[cellKey].bottom = borderStyle)\n                    !isOnRight && (this.data[cellKey].right = borderStyle)\n                    !isOnLeft && (this.data[cellKey].left = borderStyle)\n                  }\n                  if (borderType === 'border-horizontal') {\n                    !isOnTop && (this.data[cellKey].top = borderStyle)\n                    !isOnBottom && (this.data[cellKey].bottom = borderStyle)\n                  }\n                  if (borderType === 'border-vertical') {\n                    !isOnRight && (this.data[cellKey].right = borderStyle)\n                    !isOnLeft && (this.data[cellKey].left = borderStyle)\n                  }\n                }\n              }\n          }\n      }\n      }\n    })\n  }\n\n  get(key: string){\n    return this.data[key]\n  }\n}\n\ntype Cell = {\n  row: number;\n  column: number;\n}\n\ntype Range = [number, number]\n\nfunction isOnTopBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const {row: cellRow, column: cellCol} = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellRow === rangeStartRow\n}\n\nfunction isOnBottomBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const {row: cellRow, column: cellCol} = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellRow === rangeEndRow\n}\n\nfunction isOnRightBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const {row: cellRow, column: cellCol} = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellCol === rangeEndCol\n}\n\nfunction isOnLeftBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const {row: cellRow, column: cellCol} = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellCol === rangeStartCol\n}","import XLSX from 'xlsx-js-style';\nimport {WorkCell} from './Workcell'\nimport {BorderInfo} from './BorderInfo'\nimport {IluckySheetCelldata} from '../ToLuckySheet/ILuck'\ninterface IMergeCell {\n  e: { c: number; r: number },\n  s: { c: number; r: number }\n}\nexport class WorkSheetBase {\n  data: Record<string, any>;\n  border: Record<string, any>;\n  ref: string;\n  cols: any[];\n  rows: any[];\n  name: string;\n  merges: IMergeCell[];\n}\nexport class WorkSheet extends WorkSheetBase {\n  constructor(sheetData: any) {\n    super()\n    const { config, column, row, celldata, name, data } = sheetData\n    const { columnlen, rowlen, merge, borderInfo } = config || {}\n    this.data = {}\n    this.border = {}\n    this.name = name\n\n    // 解析borderInfo\n    const border = new BorderInfo(borderInfo)\n    for (const [key, borderValue] of Object.entries(border.data)) {\n      this.data[key] = {}\n      this.border[key] = borderValue\n    }\n\n    // 解析单元格内容\n    // const rowLen = data.length\n    // const columnLen = data?.[0]?.length || 0\n    // for(let row = 0; row <= rowLen; row++){\n    //   for(let col = 0; col <= columnLen; col++){\n    //     const cellValue = data[row][col] || {r: row, c: col}\n    //     const cell = new WorkCell(cellValue, border)\n    //     this.data[cell.key] = cell.toData()\n    //   }\n    // }\n    celldata?.forEach((data: IluckySheetCelldata) => {\n      const cell = new WorkCell(data)\n      if (this.border[cell.key]) {\n        this.data[cell.key] = {\n          ...(cell.toData() || {}),\n          s: {\n            ...(cell.toData()?.s || {}),\n            border: this.border[cell.key] || {}\n          }\n        }\n      } else {\n        this.data[cell.key] = cell.toData()\n      }\n    })\n\n    // 规定数据范围\n    const endCellRange = XLSX.utils.encode_cell({ c: column - 1, r: row - 1 })\n    this.ref = `A1:${endCellRange}`\n\n    // 规定行列宽高\n    this.cols = [];\n    if (columnlen) {\n      Object.keys(columnlen).forEach((index) => {\n        this.cols[Number(index)] = { wpx: Math.round(parseFloat(columnlen[index]) * 0.75) }\n      })\n    }\n    this.rows = [];\n    if (rowlen) {\n      Object.keys(rowlen).forEach((index) => {\n        this.rows[Number(index)] = { hpx: Math.round(parseFloat(rowlen[index]) * 0.75) }\n      })\n    }\n\n    // 合并单元格范围\n    this.merges = []\n    if (merge) {\n      Object.keys(merge).forEach((key) => {\n        // rs cs 为所占行数\n        const {r, c, rs, cs} = merge[key]\n        // s为合并单元格开始行列  e为结束\n        const mergeValue = {\n          s: { r, c },\n          e: { r: r + ( rs - 1), c: c + ( cs - 1) }\n        }\n        this.merges.push(mergeValue)\n      })\n    }\n  }\n\n  toData() {\n    const result = Object.assign({}, this.data)\n    result['!ref'] = this.ref\n    result['!cols'] = this.cols\n    result['!rows'] = this.rows\n    result['!merges'] = this.merges\n    return result\n  }\n}","import XLSX from 'xlsx-js-style';\nimport { WorkSheet } from './Worksheet';\n\nexport class ExcelFileBase {\n  fileName: string\n  sheets: any[]\n}\nexport class ExcelFile extends ExcelFileBase {\n  /**\n   * @param luckysheetJson luckysheet.toJson() 返回数据\n   * @param fileName \n   */\n  constructor(luckysheetJson: any, fileName?: string) {\n    super();\n    const {title, data} = luckysheetJson\n    this.fileName = fileName || luckysheetJson.title\n    this.sheets = data?.map((item: any) => new WorkSheet(item))\n  }\n  \n  export() {\n    const wb = XLSX.utils.book_new()\n    this.sheets?.forEach((sheet: WorkSheet) => {\n      XLSX.utils.book_append_sheet(wb, sheet.toData(), sheet.name)\n    })\n    XLSX.writeFile(wb, `${this.fileName}.xlsx`)\n  }\n}","import JSZip from \"jszip\";\nimport {IuploadfileList} from \"./ICommon\";\nimport {getBinaryContent} from \"./common/method\"\n\n\nexport class HandleZip{\n    uploadFile:File; \n    workBook:JSZip; \n    \n    constructor(file?:File){\n        // Support nodejs fs to read files\n        // if(file instanceof File){\n            this.uploadFile = file;\n        // }\n    }\n\n    unzipFile(successFunc:(file:IuploadfileList)=>void, errorFunc:(err:Error)=>void):void { \n        // var new_zip:JSZip = new JSZip();\n        JSZip.loadAsync(this.uploadFile)                                   // 1) read the Blob\n        .then(function(zip:any) {\n            let fileList:IuploadfileList = <IuploadfileList>{}, lastIndex:number = Object.keys(zip.files).length, index:number=0;\n            zip.forEach(function (relativePath:any, zipEntry:any) {  // 2) print entries\n                let fileName = zipEntry.name;\n                let fileNameArr = fileName.split(\".\");\n                let suffix = fileNameArr[fileNameArr.length-1].toLowerCase();\n                let fileType = \"string\";\n                if(suffix in {\"png\":1, \"jpeg\":1, \"jpg\":1, \"gif\":1,\"bmp\":1,\"tif\":1,\"webp\":1,}){\n                    fileType = \"base64\";\n                }\n                else if(suffix==\"emf\"){\n                    fileType = \"arraybuffer\";\n                }\n                zipEntry.async(fileType).then(function (data:string) {\n                    if(fileType==\"base64\"){\n                        data = \"data:image/\"+ suffix +\";base64,\" + data;\n                    }\n                    fileList[zipEntry.name] = data;\n                    // console.log(lastIndex, index);\n                    if(lastIndex==index+1){\n                        successFunc(fileList);\n                    }\n                    index++;\n                });\n            });\n            \n        }, function (e:Error) {\n            errorFunc(e);\n        });\n    }\n\n    unzipFileByUrl(url:string,successFunc:(file:IuploadfileList)=>void, errorFunc:(err:Error)=>void):void { \n        var new_zip:JSZip = new JSZip();\n        getBinaryContent(url, function(err:any, data:any) {\n            if(err) {\n                throw err; // or handle err\n            }\n        \n            JSZip.loadAsync(data).then(function(zip:any) {\n                let fileList:IuploadfileList = <IuploadfileList>{}, lastIndex:number = Object.keys(zip.files).length, index:number=0;\n                zip.forEach(function (relativePath:any, zipEntry:any) {  // 2) print entries\n                    let fileName = zipEntry.name;\n                    let fileNameArr = fileName.split(\".\");\n                    let suffix = fileNameArr[fileNameArr.length-1].toLowerCase();\n                    let fileType = \"string\";\n                    if(suffix in {\"png\":1, \"jpeg\":1, \"jpg\":1, \"gif\":1,\"bmp\":1,\"tif\":1,\"webp\":1,}){\n                        fileType = \"base64\";\n                    }\n                    else if(suffix==\"emf\"){\n                        fileType = \"arraybuffer\";\n                    }\n                    zipEntry.async(fileType).then(function (data:any) {\n                        if(fileType==\"base64\"){\n                            data = \"data:image/\"+ suffix +\";base64,\" + data;\n                        }\n                        fileList[zipEntry.name] = data;\n                        // console.log(lastIndex, index);\n                        if(lastIndex==index+1){\n                            successFunc(fileList);\n                        }\n                        index++;\n                    });\n                });\n                \n            }, function (e:Error) {\n                errorFunc(e);\n            });\n        });\n        \n    }\n\n    newZipFile():void { \n        var zip = new JSZip();\n        this.workBook =  zip;\n    }\n\n    //title:\"nested/hello.txt\", content:\"Hello Worldasdfasfasdfasfasfasfasfasdfas\"\n    addToZipFile(title:string,content:string):void { \n        if(this.workBook==null){\n            var zip = new JSZip();\n            this.workBook =  zip;\n        }\n        this.workBook.file(title, content);\n    }\n}","import Excel from 'exceljs'\nimport { stringToNum, IattributeList, stringToBoolean } from \"../ICommon\";\n\nexport const CellTypeMap: IattributeList = {\n  \"Boolean\": \"b\",\n  \"Date\": \"d\",\n  \"Error\": \"e\",\n  \"InlineString\": \"inlineStr\",\n  \"Number\": \"n\",\n  \"SharedString\": \"s\",\n  \"String\": \"str\",\n}\n\nexport const FontFamilyMap: Record<string, string> = {\n  '0': '微软雅黑',\n  '1': '宋体（Song）',\n  '2': '黑体（ST Heiti）',\n  '3': '楷体（ST Kaiti）',\n  '4': '仿宋（ST FangSong）',\n  '5': '新宋体（ST Song）',\n  '6': '华文新魏',\n  '7': '华文行楷',\n  '8': '华文隶书',\n  '9': 'Arial',\n  '10': 'Times New Roman ',\n  '11': 'Tahoma ',\n  '12': 'Verdana',\n}\n\nexport const ErrorValueMap: Record<string, Excel.CellErrorValue['error']> = {\n  '#N/A': Excel.ErrorValue.NotApplicable,\n  '#REF!': Excel.ErrorValue.Ref,\n  '#NAME?': Excel.ErrorValue.Name,\n  '#DIV/0!': Excel.ErrorValue.DivZero,\n  '#NULL!': Excel.ErrorValue.Null,\n  '#VALUE!': Excel.ErrorValue.Value,\n  '#NUM!': Excel.ErrorValue.Num,\n}\n\nexport const excelBorderPositions: IattributeList = {\n  t: \"top\",\n  b: \"bottom\",\n  l: \"left\",\n  r: \"right\",\n}\n\nexport const verticalMap: Record<string, Excel.Alignment['vertical']> = {\n  '0': 'middle',\n  '1': 'top',\n  '2': 'bottom',\n}\n\nexport const horizontalMap: Record<string, Excel.Alignment['horizontal']> = {\n  '0': 'center',\n  '1': 'left',\n  '2': 'right',\n}\n\nexport const wrapTextMap: Record<string, Excel.Alignment['wrapText']> = {\n  '0': false,\n  '1': false,\n  '2': true,\n}\n\nexport const textRotationMap: Record<string, Excel.Alignment['textRotation']> = {\n  '0': 0,\n  '1': 45,\n  '2': -45,\n  '3': 'vertical',\n  '4': 90,\n  '5': -90,\n}\n\nexport const excelBorderStyles: IattributeList = {\n  '1': 'thin',\n  '2': 'hair',\n  '3': 'dotted',\n  '4': 'dashDot', // dashed exceljs不支持\n  '5': 'dashDot',\n  '6': 'dashDotDot',\n  '7': 'double',\n  '8': 'medium',\n  '9': 'mediumDashed',\n  '10': 'mediumDashDot',\n  '11': 'mediumDashDotDot',\n  '12': 'slantDashDot',\n  '13': 'thick',\n}","import Excel from 'exceljs'\nimport { WorkSheet } from './Worksheet'\nimport { rgbToHex, chatatABC, encodeCell } from '../common/method'\nimport { IluckySheetCelldata, IluckySheetCelldataValue } from '../ToLuckySheet/ILuck'\nimport { FontFamilyMap, ErrorValueMap, verticalMap, horizontalMap, wrapTextMap, textRotationMap } from './constant'\n\nexport class WorkCellBase {\n  key: string\n  worksheet: WorkSheet\n  cell: Excel.Cell;\n}\n\nexport class WorkCell extends WorkCellBase {\n  constructor(worksheet: WorkSheet, data: IluckySheetCelldata) {\n    super()\n    const { r, c } = data\n\n    this.key = encodeCell({ c, r })\n    this.worksheet = worksheet\n    this.cell = worksheet.worksheet.getCell(this.key)\n\n    this._parseValue(data)\n    this.cell.font = this._parseFont(data?.v)\n    this._parseStyle(data?.v)\n  }\n\n  _parseValue(data: IluckySheetCelldata) {\n    const { r, c } = data\n    if (data?.v === undefined) {\n      return;\n    }\n    if (typeof data?.v === 'string' || data?.v === null) {\n      this.cell.value = data.v as string | null;\n      return\n    }\n    const { ct, v, f } = data.v as IluckySheetCelldataValue\n    if (ct) {\n      // 自动格式、数字、字符串、布尔值 直接赋值\n      if (['g', 'n', 's', 'b'].includes(ct?.t)) {\n        this.cell.value = v\n        this.cell.numFmt = ct.fa\n      }\n      // 日期格式\n      if (ct?.t === 'd') {\n        const date0 = new Date(0);\n        const utcOffset = date0.getTimezoneOffset();\n        const cellValue = new Date(0, 0, parseInt(v) - 1, 0, -utcOffset, 0);\n        this.cell.value = cellValue\n        this.cell.numFmt = ct.fa\n      }\n\n      // 公式\n      if (f) {\n        this.cell.value = {\n          formula: f,\n          result: v\n        }\n      }\n\n      // 富文本\n      if (ct?.t === 'inlineStr' && ct?.s?.length > 0) {\n        this.cell.value = {\n          richText: ct?.s?.map((item: IluckySheetCelldataValue) => {\n            return {\n              text: item.v,\n              font: this._parseFont(item)\n            }\n          })\n        };\n      }\n\n      // // 错误值\n      if (ct?.t === 'e' && !f) {\n        this.cell.value = { error: ErrorValueMap[v] || Excel.ErrorValue.Value };\n      }\n    }\n\n    // 超链接\n    if (this.worksheet.hyperlink?.[`${r}_${c}`]) {\n      const hyperlink = this.worksheet.hyperlink?.[`${r}_${c}`]\n      let linkAddress = hyperlink.linkAddress\n      if (hyperlink.linkType === 'internal') {\n        const [sheet, cell] = hyperlink.linkAddress?.split('!')\n        linkAddress = `#'${sheet}'!${cell}`\n      }\n      this.cell.value = {\n        text: v,\n        hyperlink: linkAddress,\n        tooltip: hyperlink.linkTooltip\n      };\n    }\n  }\n\n  // 格式化字体样式\n  _parseFont(data: IluckySheetCelldataValue | string) {\n    if (typeof data === 'string' || data === undefined) {\n      return {};\n    }\n    const { fc, bl, it, cl, un, fs, ff } = data || {}\n    return {\n      name: FontFamilyMap[ff] || ff,\n      size: fs ?? 10,\n      family: 1,\n      color: { argb: rgbToHex(fc)?.replace('#', '') || '000000' },\n      bold: !!bl,\n      italic: !!it,\n      underline: !!un,\n      strike: !!cl,\n    }\n  }\n\n  _parseStyle(data: IluckySheetCelldataValue | string) {\n    if (typeof data === 'string' || data === undefined) {\n      return {};\n    }\n    const { vt, ht, tb, tr, ti, bg } = data || {}\n    // 对齐\n    const alignment: Partial<Excel.Alignment> = {}\n    alignment.vertical = verticalMap[vt] || 'middle'\n    alignment.horizontal = horizontalMap[ht] || 'left'\n    tb !== undefined && (alignment.wrapText = wrapTextMap[tb])\n    ti !== undefined && (alignment.indent = ti ?? 0)\n    tr !== undefined && (alignment.textRotation = textRotationMap[tr] ?? 0)\n    this.cell.alignment = alignment\n\n    // 背景色\n    if (bg) {\n      this.cell.fill = {\n        type: 'pattern',\n\t      pattern: 'solid',\n        fgColor:{argb:rgbToHex(bg)?.replace('#', '') || 'ffffff'}\n      }\n    }\n\n  }\n\n  toData() {\n    const data = this\n    return data\n  }\n}","import XLSX from 'xlsx-js-style';\nimport { excelBorderPositions } from '../common/constant'\nimport { rgbToHex } from '../common/method'\nimport { excelBorderStyles } from './constant'\n\nexport class BorderInfoBase {\n  data: Record<string, any>\n}\n\nexport class BorderInfo extends BorderInfoBase {\n  constructor(data: any) {\n    super()\n    this.data = {}\n    data?.forEach((item: any) => {\n      const { rangeType } = item;\n      // 旧版excel导入时生成的borderinfo\n      if (rangeType === 'cell') {\n        const { value } = item;\n        const cellKey = XLSX.utils.encode_cell({ c: value.col_index, r: value.row_index });\n        this.data[cellKey] = {};\n        ['t', 'b', 'l', 'r'].forEach((p) => {\n          const borderStyle = value[p]\n          if (borderStyle && excelBorderPositions[p]) {\n            this.data[cellKey][excelBorderPositions[p]] = {\n              style: excelBorderStyles[borderStyle.style] || 'thin',\n              color: { argb: rgbToHex(borderStyle.color)?.replace('#', '') || '000000' }\n            }\n          }\n        })\n      }\n      // 新版luckysheet操作生成的borderinfo\n      if (rangeType === 'range') {\n        const { color, style, range = [], borderType } = item\n        const borderStyle = {\n          style: excelBorderStyles[style] || 'thin',\n          color: { argb: rgbToHex(color)?.replace('#', '') || '000000' }\n        }\n\n        for (let rangeItem of range) {\n          const [rangeStartRow, rangeEndRow] = rangeItem.row\n          const [rangeStartCol, rangeEndCol] = rangeItem.column\n\n          for (let row = rangeStartRow; row <= rangeEndRow; row++) {\n            for (let col = rangeStartCol; col <= rangeEndCol; col++) {\n              const cellKey = XLSX.utils.encode_cell({ c: col, r: row });\n              this.data[cellKey] = {}\n              // 检查上下左右边的情况，按需添加边框\n              if (borderType === 'border-none') {\n                this.data[cellKey] = null\n              } else if (borderType === 'border-all') {\n                this.data[cellKey].top = borderStyle;\n                this.data[cellKey].bottom = borderStyle;\n                this.data[cellKey].left = borderStyle;\n                this.data[cellKey].right = borderStyle;\n              } else {\n                const isOnTop = isOnTopBorder({ row: row, column: col }, rangeItem.row, rangeItem.column)\n                const isOnBottom = isOnBottomBorder({ row: row, column: col }, rangeItem.row, rangeItem.column)\n                const isOnRight = isOnRightBorder({ row: row, column: col }, rangeItem.row, rangeItem.column)\n                const isOnLeft = isOnLeftBorder({ row: row, column: col }, rangeItem.row, rangeItem.column)\n\n                if (['border-top', 'border-outside'].includes(borderType) && isOnTop) {\n                  this.data[cellKey].top = borderStyle;\n                }\n                if (['border-bottom', 'border-outside'].includes(borderType) && isOnBottom) {\n                  this.data[cellKey].bottom = borderStyle;\n                }\n                if (['border-right', 'border-outside'].includes(borderType) && isOnRight) {\n                  this.data[cellKey].right = borderStyle;\n                }\n                if (['border-left', 'border-outside'].includes(borderType) && isOnLeft) {\n                  this.data[cellKey].left = borderStyle;\n                }\n                if (borderType === 'border-inside') {\n                  !isOnTop && (this.data[cellKey].top = borderStyle)\n                  !isOnBottom && (this.data[cellKey].bottom = borderStyle)\n                  !isOnRight && (this.data[cellKey].right = borderStyle)\n                  !isOnLeft && (this.data[cellKey].left = borderStyle)\n                }\n                if (borderType === 'border-horizontal') {\n                  !isOnTop && (this.data[cellKey].top = borderStyle)\n                  !isOnBottom && (this.data[cellKey].bottom = borderStyle)\n                }\n                if (borderType === 'border-vertical') {\n                  !isOnRight && (this.data[cellKey].right = borderStyle)\n                  !isOnLeft && (this.data[cellKey].left = borderStyle)\n                }\n              }\n            }\n          }\n        }\n      }\n    })\n  }\n\n  get(key: string) {\n    return this.data[key]\n  }\n}\n\ntype Cell = {\n  row: number;\n  column: number;\n}\n\ntype Range = [number, number]\n\nfunction isOnTopBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const { row: cellRow, column: cellCol } = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellRow === rangeStartRow\n}\n\nfunction isOnBottomBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const { row: cellRow, column: cellCol } = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellRow === rangeEndRow\n}\n\nfunction isOnRightBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const { row: cellRow, column: cellCol } = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellCol === rangeEndCol\n}\n\nfunction isOnLeftBorder(cell: Cell, rowRange: Range, columnRange: Range) {\n  const { row: cellRow, column: cellCol } = cell;\n  const [rangeStartRow, rangeEndRow] = rowRange\n  const [rangeStartCol, rangeEndCol] = columnRange\n  return cellCol === rangeStartCol\n}","import { WorkCell } from './Workcell'\nimport {BorderInfo} from './BorderInfo'\nimport Excel from 'exceljs'\nimport {chatatABC, encodeRange} from '../common/method'\nimport { IluckySheetCelldata } from '../ToLuckySheet/ILuck'\ninterface IMergeCell {\n  e: { c: number; r: number },\n  s: { c: number; r: number }\n}\nexport class WorkSheetBase {\n  worksheet: Excel.Worksheet;\n  data: Record<string, any>;\n  border: Record<string, any>;\n  hyperlink: Record<string, any>;\n  ref: string;\n  cols: any[];\n  rows: any[];\n  name: string;\n  merges: IMergeCell[];\n}\nexport class WorkSheet extends WorkSheetBase {\n  constructor(workbook: Excel.Workbook, sheetData: any) {\n    super()\n    const { config, column: maxCol, row: maxRow, hyperlink, celldata, name, data, hide, defaultColWidth, defaultRowHeight, color } = sheetData\n    const { columnlen, rowlen, merge, borderInfo } = config || {}\n    this.data = {}\n    this.border = {}\n    this.hyperlink = hyperlink\n    this.name = name\n\n    this.worksheet = workbook.addWorksheet(name, {\n      state: hide === 1 ? 'hidden' : 'visible',\n      properties: {\n        tabColor: color === '' ? undefined : { argb: color },\n      }\n    })\n\n    // 解析数据\n    celldata?.forEach((data: IluckySheetCelldata) => {\n      const cell = new WorkCell(this, data)\n      this.data[cell.key] = cell.cell\n    })\n\n    // 规定行列宽高\n    if (columnlen) {\n      Object.keys(columnlen).forEach((_col) => {\n        if (parseInt(_col) > maxCol) {\n          return;\n        }\n        const colKey = chatatABC(parseInt(_col))\n        const col = this.worksheet.getColumn(colKey);\n        col.width =  Math.round(parseFloat(columnlen?.[_col] ?? 70) * 0.17)\n      })\n    }\n    if (rowlen) {\n      Object.keys(rowlen).forEach((_row) => {\n        if (parseInt(_row) > maxRow) {\n          return;\n        }\n        const row = this.worksheet.getRow(parseInt(_row) + 1);\n        row.height = Math.round(parseFloat(rowlen?.[_row] ?? 20) * 0.5)\n      })\n    }\n\n    // 合并单元格\n    if (merge) {\n      Object.keys(merge).forEach((key) => {\n        // rs cs 为所占行数\n        const {r, c, rs, cs} = merge[key]\n        // s为扩展的offset\n        const range = encodeRange({r, c}, {r: r + rs - 1, c: c + cs - 1})\n        this.worksheet.mergeCells(range);\n      })\n    }\n\n    // 解析borderInfo\n    const border = new BorderInfo(borderInfo)\n    for (const [key, borderValue] of Object.entries(border.data)) {\n      this.border[key] = borderValue\n      this.worksheet.getCell(key).border = borderValue\n    }\n\n  }\n\n  toData() {\n    const result = Object.assign({}, this.data)\n    return result\n  }\n}","import Excel from 'exceljs'\nimport { WorkSheet } from './Worksheet';\n\nexport class ExcelFileBase {\n  fileName: string\n  sheets: any[]\n  workbook: Excel.Workbook\n}\n\nexport class ExcelFile extends ExcelFileBase {\n  /**\n   * @param luckysheetJson luckysheet.toJson() 返回数据\n   * @param fileName \n   */\n  constructor(luckysheetJson: any, fileName?: string) {\n    super();\n    const { title, data } = luckysheetJson\n    this.fileName = fileName || luckysheetJson.title\n    this.workbook = new Excel.Workbook()\n    this.sheets = data?.map((item: any) => new WorkSheet(this.workbook, item))\n  }\n\n  async export() {\n    const buffer = await this.workbook.xlsx.writeBuffer()\n    const blob = new Blob([buffer], { type: 'application/octet-stream' });\n    const url = URL.createObjectURL(blob);\n\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = this.fileName.indexOf('.xlsx') !== -1 ? this.fileName : `${this.fileName}.xlsx`;\n    link.click();\n    URL.revokeObjectURL(url);\n\n    return this.workbook\n  }\n}","import { LuckyFile } from \"./ToLuckySheet/LuckyFile\";\nimport { ExcelFile } from './toExcel/ExcelFile'\n// import {SecurityDoor,Car} from './content';\n\nimport { HandleZip } from './HandleZip';\nimport {ExcelFile as ExceljsFile} from './toExceljs/ExcelFile'\n\nimport { IuploadfileList } from \"./ICommon\";\nimport XLSX from 'xlsx-js-style';\nimport { fstat } from \"fs\";\nimport { Buffer } from \"exceljs\";\n\n// //demo\n// function demoHandler(){\n//     let upload = document.getElementById(\"Luckyexcel-demo-file\");\n//     let selectADemo = document.getElementById(\"Luckyexcel-select-demo\");\n//     let downlodDemo = document.getElementById(\"Luckyexcel-downlod-file\");\n//     let mask = document.getElementById(\"lucky-mask-demo\");\n//     if(upload){\n\n//         window.onload = () => {\n\n//             upload.addEventListener(\"change\", function(evt){\n//                 var files:FileList = (evt.target as any).files;\n//                 if(files==null || files.length==0){\n//                     alert(\"No files wait for import\");\n//                     return;\n//                 }\n\n//                 let name = files[0].name;\n//                 let suffixArr = name.split(\".\"), suffix = suffixArr[suffixArr.length-1];\n//                 if(suffix!=\"xlsx\"){\n//                     alert(\"Currently only supports the import of xlsx files\");\n//                     return;\n//                 }\n//                 LuckyExcel.transformExcelToLucky(files[0], function(exportJson:any, luckysheetfile:string){\n\n//                     if(exportJson.sheets==null || exportJson.sheets.length==0){\n//                         alert(\"Failed to read the content of the excel file, currently does not support xls files!\");\n//                         return;\n//                     }\n//                     console.log(exportJson, luckysheetfile);\n//                     window.luckysheet.destroy();\n\n//                     window.luckysheet.create({\n//                         container: 'luckysheet', //luckysheet is the container id\n//                         showinfobar:false,\n//                         data:exportJson.sheets,\n//                         title:exportJson.info.name,\n//                         userInfo:exportJson.info.name.creator\n//                     });\n//                 });\n//             });\n\n//             selectADemo.addEventListener(\"change\", function(evt){\n//                 var obj:any = selectADemo;\n//                 var index = obj.selectedIndex;\n//                 var value = obj.options[index].value;\n//                 var name = obj.options[index].innerHTML;\n//                 if(value==\"\"){\n//                     return;\n//                 }\n//                 mask.style.display = \"flex\";\n//                 LuckyExcel.transformExcelToLuckyByUrl(value, name, function(exportJson:any, luckysheetfile:string){\n\n//                     if(exportJson.sheets==null || exportJson.sheets.length==0){\n//                         alert(\"Failed to read the content of the excel file, currently does not support xls files!\");\n//                         return;\n//                     }\n//                     console.log(exportJson, luckysheetfile);\n//                     mask.style.display = \"none\";\n//                     window.luckysheet.destroy();\n\n//                     window.luckysheet.create({\n//                         container: 'luckysheet', //luckysheet is the container id\n//                         showinfobar:false,\n//                         data:exportJson.sheets,\n//                         title:exportJson.info.name,\n//                         userInfo:exportJson.info.name.creator\n//                     });\n//                 });\n//             });\n\n//             downlodDemo.addEventListener(\"click\", function(evt){\n//                 var obj:any = selectADemo;\n//                 var index = obj.selectedIndex;\n//                 var value = obj.options[index].value;\n\n//                 if(value.length==0){\n//                     alert(\"Please select a demo file\");\n//                     return;\n//                 }\n\n//                 var elemIF:any = document.getElementById(\"Lucky-download-frame\");\n//                 if(elemIF==null){\n//                     elemIF = document.createElement(\"iframe\");\n//                     elemIF.style.display = \"none\";\n//                     elemIF.id = \"Lucky-download-frame\";\n//                     document.body.appendChild(elemIF);\n//                 }\n//                 elemIF.src = value;\n\n//                 // elemIF.parentNode.removeChild(elemIF);\n//             });\n//         }\n//     }\n// }\n// demoHandler();\n\n// api\nexport class LuckyExcel {\n    static transformExcelToLucky(excelFile: File,\n        callback?: (files: IuploadfileList, fs?: string) => void,\n        errorHandler?: (err: Error) => void) {\n        let handleZip: HandleZip = new HandleZip(excelFile);\n\n        handleZip.unzipFile(function (files: IuploadfileList) {\n            let luckyFile = new LuckyFile(files, excelFile.name);\n            let luckysheetfile = luckyFile.Parse();\n            let exportJson = JSON.parse(luckysheetfile);\n            if (callback != undefined) {\n                callback(exportJson, luckysheetfile);\n            }\n        },\n            function (err: Error) {\n                if (errorHandler) {\n                    errorHandler(err);\n                } else {\n                    console.error(err);\n                }\n            });\n    }\n\n    static transformExcelToLuckyByUrl(\n        url: string,\n        name: string,\n        callBack?: (files: IuploadfileList, fs?: string) => void,\n        errorHandler?: (err: Error) => void) {\n        let handleZip: HandleZip = new HandleZip();\n        handleZip.unzipFileByUrl(url, function (files: IuploadfileList) {\n            let luckyFile = new LuckyFile(files, name);\n            let luckysheetfile = luckyFile.Parse();\n            let exportJson = JSON.parse(luckysheetfile);\n            if (callBack != undefined) {\n                callBack(exportJson, luckysheetfile);\n            }\n        },\n            function (err: Error) {\n                if (errorHandler) {\n                    errorHandler(err);\n                } else {\n                    console.error(err);\n                }\n            });\n    }\n\n    static readExcel(\n        data: any,\n        callBack?: (files: string) => void,\n        errorHandler?: (err: Error) => void) {\n        const workbook = XLSX.read(data, { bookDeps: true, cellStyles: true, raw: true, cellNF: true });\n    }\n\n    static transformLuckyToExcel(\n        luckysheetJson: any,\n        callBack?: (files: any) => void,\n        errorHandler?: (err: Error) => void) {\n        try {\n            const excelFile = new ExcelFile(luckysheetJson)\n            excelFile.export();\n            callBack?.(excelFile)\n        } catch(e) {\n            errorHandler?.(e)\n        }\n    }\n\n    static transformLuckyToExceljs(\n        luckysheetJson: any,\n        callBack?: (files?: any) => void,\n        errorHandler?: (err: Error) => void) {\n            const excelFile = new ExceljsFile(luckysheetJson)\n            excelFile.export().then((data) => {\n                callBack?.(data)\n            }).catch(err => {\n                errorHandler?.(err)\n            });\n    }\n}"],"names":["ErrorValueMap","verticalMap","horizontalMap","wrapTextMap","textRotationMap","excelBorderStyles","WorkCellBase","isOnTopBorder","isOnBottomBorder","isOnRightBorder","isOnLeftBorder","BorderInfoBase","WorkCell","BorderInfo","WorkSheetBase","WorkSheet","ExcelFileBase","ExceljsFile"],"mappings":"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,GAAG,EAAC,UAAU;IACd,GAAG,EAAC,UAAU;IACd,GAAG,EAAC,UAAU;IACd,GAAG,EAAC,UAAU;IACd,GAAG,EAAC,UAAU;IACd,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,IAAI;IACT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,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC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"}